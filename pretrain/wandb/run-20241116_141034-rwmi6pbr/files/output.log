directory "../checkpoints/" existing for save checkpoint!
#########################################
Be patient..., checking checkpoint now...
Start training from 0 epoch
#########################################
training start!
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:91: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
  0%|                                                     | 0/51 [00:00<?, ?it/s]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 27.93708038330078, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.936698913574219, uma_loss is 14.000381469726562
100%|████████████████████████████████████████████| 13/13 [00:05<00:00,  2.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.61s/it]
loss is 27.93780517578125, acc1 is 0.048828125, acc5 is 0.29296875, cma_loss is 14.201251983642578, uma_loss is 13.736553192138672
loss is 28.36972427368164, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 14.856582641601562, uma_loss is 13.513141632080078
loss is 27.661001205444336, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 14.2918701171875, uma_loss is 13.369131088256836
loss is 26.183055877685547, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.88827133178711, uma_loss is 12.294784545898438
loss is 25.125713348388672, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.944133758544922, uma_loss is 11.18157958984375
loss is 24.383569717407227, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.914295196533203, uma_loss is 10.469274520874023
loss is 23.72397804260254, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.894866943359375, uma_loss is 9.829111099243164
loss is 23.281890869140625, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.87997055053711, uma_loss is 9.401920318603516
loss is 23.07142448425293, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.870048522949219, uma_loss is 9.201375961303711
loss is 22.747241973876953, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.868297576904297, uma_loss is 8.878944396972656
loss is 22.418582916259766, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.868782043457031, uma_loss is 8.549800872802734
loss is 22.090065002441406, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.870235443115234, uma_loss is 8.219829559326172
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 99.48it/s]
0 epoch loss is 3.094582221621559,                                    acc1 is 0.08638822115384616, acc5 is 0.47701322115384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.57it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 165.33it/s]
-----------------------------------
The average AUROC is 70.7700
The AUROC of I313 is 46.79
The AUROC of I314 is 94.75
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 55.2256
The Specificity of I313 is 29.04
The Specificity of I314 is 81.41
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.44it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
  2%|▉                                            | 1/51 [00:20<17:29, 20.99s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.1216
The AUROC of I27 is 48.06
The AUROC of I34 is 46.92
The AUROC of I35 is 42.98
The AUROC of I36 is 70.53
-----------------------------------
The average Sensitivity is 90.0197
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 94.69
The Sensitivity of I35 is 96.61
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 23.5742
The Specificity of I27 is 36.51
The Specificity of I34 is 10.26
The Specificity of I35 is 7.22
The Specificity of I36 is 40.31
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 21.746431350708008, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.867603302001953, uma_loss is 7.878828048706055
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.47s/it]
loss is 21.6062068939209, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.865829467773438, uma_loss is 7.740377426147461
loss is 21.48858070373535, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.86569595336914, uma_loss is 7.622884750366211
loss is 21.488832473754883, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.864761352539062, uma_loss is 7.62407112121582
loss is 21.49009132385254, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.864070892333984, uma_loss is 7.626020431518555
loss is 21.418445587158203, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.863700866699219, uma_loss is 7.554743766784668
loss is 21.242351531982422, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.86258316040039, uma_loss is 7.379768371582031
loss is 21.21590805053711, acc1 is 0.09765625, acc5 is 0.341796875, cma_loss is 13.863758087158203, uma_loss is 7.35214900970459
loss is 21.14318084716797, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.865001678466797, uma_loss is 7.2781782150268555
loss is 20.935216903686523, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.863639831542969, uma_loss is 7.071577072143555
loss is 20.895362854003906, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.864452362060547, uma_loss is 7.030911445617676
loss is 20.80445098876953, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.862720489501953, uma_loss is 6.9417314529418945
loss is 20.684131622314453, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.863788604736328, uma_loss is 6.820342063903809
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 67.86it/s]
1 epoch loss is 2.6300875345865884,                                    acc1 is 0.09765625, acc5 is 0.5070612980769231
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.16it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 139.59it/s]
-----------------------------------
The average AUROC is 51.7858
The AUROC of I313 is 20.34
The AUROC of I314 is 83.23
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 38.0138
The Specificity of I313 is 5.81
The Specificity of I314 is 70.22
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.96it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
  4%|█▊                                           | 2/51 [00:36<14:38, 17.92s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.6386
The AUROC of I27 is 55.97
The AUROC of I34 is 48.10
The AUROC of I35 is 55.55
The AUROC of I36 is 46.93
-----------------------------------
The average Sensitivity is 63.6528
The Sensitivity of I27 is 47.06
The Sensitivity of I34 is 88.50
The Sensitivity of I35 is 53.67
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 50.4626
The Specificity of I27 is 79.60
The Specificity of I34 is 16.50
The Specificity of I35 is 58.42
The Specificity of I36 is 47.33
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 20.325302124023438, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.862754821777344, uma_loss is 6.462546348571777
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 19.98723602294922, acc1 is 0.09765625, acc5 is 0.390625, cma_loss is 13.86301040649414, uma_loss is 6.124225616455078
loss is 19.672130584716797, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.863048553466797, uma_loss is 5.80908203125
loss is 19.604089736938477, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.861652374267578, uma_loss is 5.742437362670898
loss is 19.253612518310547, acc1 is 0.244140625, acc5 is 0.390625, cma_loss is 13.863059997558594, uma_loss is 5.3905534744262695
loss is 19.079814910888672, acc1 is 0.09765625, acc5 is 0.390625, cma_loss is 13.869510650634766, uma_loss is 5.21030330657959
loss is 18.982650756835938, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.863765716552734, uma_loss is 5.118885040283203
loss is 19.097797393798828, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.86562728881836, uma_loss is 5.232169151306152
loss is 19.013193130493164, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.86465072631836, uma_loss is 5.148542404174805
loss is 18.86655044555664, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.862728118896484, uma_loss is 5.003823280334473
loss is 18.749591827392578, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.860755920410156, uma_loss is 4.8888349533081055
loss is 18.744552612304688, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.863842010498047, uma_loss is 4.880711555480957
loss is 18.72089385986328, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.86385726928711, uma_loss is 4.857036590576172
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 114.05it/s]
2 epoch loss is 2.381880151657831,                                    acc1 is 0.11268028846153846, acc5 is 0.49954927884615385
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.07it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 147.45it/s]
-----------------------------------
The average AUROC is 43.5885
The AUROC of I313 is 25.00
The AUROC of I314 is 62.18
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 24.3551
The Specificity of I313 is 4.67
The Specificity of I314 is 44.04
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.95it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
  6%|██▋                                          | 3/51 [00:52<13:37, 17.03s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.1540
The AUROC of I27 is 54.17
The AUROC of I34 is 50.00
The AUROC of I35 is 56.76
The AUROC of I36 is 47.68
-----------------------------------
The average Sensitivity is 75.3480
The Sensitivity of I27 is 64.71
The Sensitivity of I34 is 89.38
The Sensitivity of I35 is 81.92
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 35.8169
The Specificity of I27 is 54.50
The Specificity of I34 is 16.21
The Specificity of I35 is 32.18
The Specificity of I36 is 40.38
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 18.78729248046875, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.8623046875, uma_loss is 4.92498779296875
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.21it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 18.731914520263672, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.86178970336914, uma_loss is 4.870124816894531
loss is 18.588979721069336, acc1 is 0.048828125, acc5 is 0.341796875, cma_loss is 13.863330841064453, uma_loss is 4.725648880004883
loss is 18.541706085205078, acc1 is 0.1953125, acc5 is 0.537109375, cma_loss is 13.860763549804688, uma_loss is 4.680943489074707
loss is 18.47744369506836, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.86227798461914, uma_loss is 4.615165710449219
loss is 18.500110626220703, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.860301971435547, uma_loss is 4.63980770111084
loss is 18.271989822387695, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.861114501953125, uma_loss is 4.4108757972717285
loss is 18.11390495300293, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.861312866210938, uma_loss is 4.252591609954834
loss is 17.911624908447266, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.86081314086914, uma_loss is 4.050810813903809
loss is 17.904769897460938, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.860836029052734, uma_loss is 4.043933391571045
loss is 17.92696189880371, acc1 is 0.146484375, acc5 is 0.390625, cma_loss is 13.861515045166016, uma_loss is 4.065446853637695
loss is 17.816041946411133, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.860157012939453, uma_loss is 3.9558844566345215
loss is 17.887447357177734, acc1 is 0.0, acc5 is 0.537109375, cma_loss is 13.86069107055664, uma_loss is 4.0267558097839355
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 92.01it/s]
3 epoch loss is 2.261525599161784,                                    acc1 is 0.10892427884615384, acc5 is 0.5108173076923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.93it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 141.31it/s]
-----------------------------------
The average AUROC is 64.2293
The AUROC of I313 is 39.70
The AUROC of I314 is 88.76
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 87.1642
The Specificity of I313 is 88.99
The Specificity of I314 is 85.34
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.00it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/zeroshot_val.py:273: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
-----------------------------------
The average AUROC is 50.3411
The AUROC of I27 is 39.75
The AUROC of I34 is 52.40
The AUROC of I35 is 53.57
The AUROC of I36 is 55.65
-----------------------------------
The average Sensitivity is 92.6481
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 95.58
The Sensitivity of I35 is 84.75
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 17.4199
The Specificity of I27 is 13.09
The Specificity of I34 is 11.76
The Specificity of I35 is 24.44
The Specificity of I36 is 20.39
-----------------------------------
  8%|███▌                                         | 4/51 [01:08<12:56, 16.53s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 17.812908172607422, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.860000610351562, uma_loss is 3.952906608581543
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 17.73872184753418, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.859134674072266, uma_loss is 3.879586696624756
loss is 17.740585327148438, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.862049102783203, uma_loss is 3.878535747528076
loss is 17.703346252441406, acc1 is 0.146484375, acc5 is 0.830078125, cma_loss is 13.858013153076172, uma_loss is 3.8453335762023926
loss is 17.683761596679688, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.858341217041016, uma_loss is 3.8254194259643555
loss is 17.76261329650879, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.856735229492188, uma_loss is 3.9058780670166016
loss is 17.69895362854004, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.857791900634766, uma_loss is 3.8411622047424316
loss is 17.674959182739258, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.858016967773438, uma_loss is 3.816941738128662
loss is 17.63080596923828, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.858024597167969, uma_loss is 3.772780418395996
loss is 17.636920928955078, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.854888916015625, uma_loss is 3.7820329666137695
loss is 17.661163330078125, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.86007308959961, uma_loss is 3.801089286804199
loss is 17.59299659729004, acc1 is 0.09765625, acc5 is 0.341796875, cma_loss is 13.859500885009766, uma_loss is 3.7334952354431152
loss is 17.653867721557617, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.856170654296875, uma_loss is 3.7976975440979004
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 97.40it/s]
4 epoch loss is 2.190396227155413,                                    acc1 is 0.11643629807692307, acc5 is 0.5746694711538461
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.20it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 123.99it/s]
-----------------------------------
The average AUROC is 12.7729
The AUROC of I313 is 18.48
The AUROC of I314 is 7.06
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 4.1009
The Specificity of I313 is 3.67
The Specificity of I314 is 4.53
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.96it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 10%|████▍                                        | 5/51 [01:24<12:29, 16.29s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.5154
The AUROC of I27 is 50.60
The AUROC of I34 is 47.23
The AUROC of I35 is 63.57
The AUROC of I36 is 44.67
-----------------------------------
The average Sensitivity is 86.7574
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 97.35
The Sensitivity of I35 is 79.10
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 26.1005
The Specificity of I27 is 47.38
The Specificity of I34 is 7.75
The Specificity of I35 is 39.55
The Specificity of I36 is 9.72
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 17.60852813720703, acc1 is 0.0, acc5 is 0.48828125, cma_loss is 13.853225708007812, uma_loss is 3.755303382873535
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.23it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 17.597911834716797, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.851444244384766, uma_loss is 3.7464685440063477
loss is 17.539939880371094, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.856006622314453, uma_loss is 3.683934211730957
loss is 17.559045791625977, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.85342025756836, uma_loss is 3.705625057220459
loss is 17.567752838134766, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.85477066040039, uma_loss is 3.712982654571533
loss is 17.595605850219727, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.85263442993164, uma_loss is 3.742971420288086
loss is 17.55681610107422, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.855216979980469, uma_loss is 3.701599597930908
loss is 17.57013702392578, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.85599136352539, uma_loss is 3.7141451835632324
loss is 17.506330490112305, acc1 is 0.1953125, acc5 is 0.48828125, cma_loss is 13.846809387207031, uma_loss is 3.6595206260681152
loss is 17.517873764038086, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.842945098876953, uma_loss is 3.674928665161133
loss is 17.58745574951172, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.856277465820312, uma_loss is 3.73117733001709
loss is 17.50586700439453, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.849685668945312, uma_loss is 3.6561803817749023
loss is 17.5704402923584, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.848762512207031, uma_loss is 3.721677780151367
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 93.62it/s]
5 epoch loss is 2.1741305215018136,                                    acc1 is 0.10516826923076923, acc5 is 0.5896935096153846
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.03it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 130.04it/s]
-----------------------------------
The average AUROC is 21.7471
The AUROC of I313 is 19.03
The AUROC of I314 is 24.46
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 8.2312
The Specificity of I313 is 3.34
The Specificity of I314 is 13.12
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.85it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 12%|█████▎                                       | 6/51 [01:40<12:05, 16.13s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.6597
The AUROC of I27 is 46.56
The AUROC of I34 is 46.96
The AUROC of I35 is 61.97
The AUROC of I36 is 47.16
-----------------------------------
The average Sensitivity is 89.0823
The Sensitivity of I27 is 82.35
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 88.14
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 23.1332
The Specificity of I27 is 33.83
The Specificity of I34 is 19.87
The Specificity of I35 is 29.25
The Specificity of I36 is 9.59
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 17.522829055786133, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.840511322021484, uma_loss is 3.6823182106018066
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.17it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 17.480846405029297, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.828422546386719, uma_loss is 3.652423858642578
loss is 17.506671905517578, acc1 is 0.0, acc5 is 0.390625, cma_loss is 13.852958679199219, uma_loss is 3.653712272644043
loss is 17.489971160888672, acc1 is 0.244140625, acc5 is 0.732421875, cma_loss is 13.840591430664062, uma_loss is 3.649380683898926
loss is 17.54460334777832, acc1 is 0.0, acc5 is 0.537109375, cma_loss is 13.836841583251953, uma_loss is 3.7077622413635254
loss is 17.532800674438477, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.829132080078125, uma_loss is 3.7036685943603516
loss is 17.472604751586914, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.845542907714844, uma_loss is 3.627061367034912
loss is 17.499425888061523, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.841819763183594, uma_loss is 3.6576056480407715
loss is 17.43070411682129, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.824066162109375, uma_loss is 3.6066384315490723
loss is 17.465038299560547, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.82888412475586, uma_loss is 3.636153221130371
loss is 17.535524368286133, acc1 is 0.0, acc5 is 0.68359375, cma_loss is 13.842464447021484, uma_loss is 3.6930599212646484
loss is 17.47294807434082, acc1 is 0.146484375, acc5 is 0.439453125, cma_loss is 13.82778549194336, uma_loss is 3.6451621055603027
loss is 17.501039505004883, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.821964263916016, uma_loss is 3.6790757179260254
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 75.52it/s]
6 epoch loss is 2.1662381671723865,                                    acc1 is 0.10516826923076923, acc5 is 0.5934495192307693
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.92it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 139.86it/s]
-----------------------------------
The average AUROC is 58.3596
The AUROC of I313 is 21.62
The AUROC of I314 is 95.10
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 47.9386
The Specificity of I313 is 3.87
The Specificity of I314 is 92.01
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.97it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 14%|██████▏                                      | 7/51 [01:55<11:44, 16.01s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.6669
The AUROC of I27 is 49.70
The AUROC of I34 is 48.14
The AUROC of I35 is 61.43
The AUROC of I36 is 51.41
-----------------------------------
The average Sensitivity is 70.7865
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 92.92
The Sensitivity of I35 is 40.68
The Sensitivity of I36 is 73.08
-----------------------------------
The average Specificity is 43.8867
The Specificity of I27 is 40.74
The Specificity of I34 is 16.86
The Specificity of I35 is 78.05
The Specificity of I36 is 39.91
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 17.428800582885742, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.799087524414062, uma_loss is 3.6297125816345215
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 17.445587158203125, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.793411254882812, uma_loss is 3.6521763801574707
loss is 17.445796966552734, acc1 is 0.048828125, acc5 is 0.634765625, cma_loss is 13.840591430664062, uma_loss is 3.6052064895629883
loss is 17.360715866088867, acc1 is 0.048828125, acc5 is 0.732421875, cma_loss is 13.796207427978516, uma_loss is 3.5645079612731934
loss is 17.416149139404297, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.802650451660156, uma_loss is 3.613499164581299
loss is 17.397659301757812, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.808921813964844, uma_loss is 3.588737964630127
loss is 17.35093116760254, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.8138427734375, uma_loss is 3.537088394165039
loss is 17.421722412109375, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.823371887207031, uma_loss is 3.5983495712280273
loss is 17.27670669555664, acc1 is 0.146484375, acc5 is 0.439453125, cma_loss is 13.798664093017578, uma_loss is 3.4780421257019043
loss is 17.248188018798828, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.7913818359375, uma_loss is 3.4568066596984863
loss is 17.297760009765625, acc1 is 0.244140625, acc5 is 0.87890625, cma_loss is 13.821258544921875, uma_loss is 3.4765024185180664
loss is 17.153804779052734, acc1 is 0.244140625, acc5 is 0.634765625, cma_loss is 13.777198791503906, uma_loss is 3.37660551071167
loss is 17.04058074951172, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.787303924560547, uma_loss is 3.2532758712768555
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 76.39it/s]
7 epoch loss is 2.1455657414027622,                                    acc1 is 0.15399639423076922, acc5 is 0.7136418269230769
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.92it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 134.66it/s]
-----------------------------------
The average AUROC is 46.1792
The AUROC of I313 is 15.51
The AUROC of I314 is 76.85
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 36.1108
The Specificity of I313 is 1.54
The Specificity of I314 is 70.69
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.89it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 16%|███████                                      | 8/51 [02:12<11:33, 16.13s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.6397
The AUROC of I27 is 59.89
The AUROC of I34 is 56.00
The AUROC of I35 is 61.39
The AUROC of I36 is 53.28
-----------------------------------
The average Sensitivity is 70.4218
The Sensitivity of I27 is 64.71
The Sensitivity of I34 is 82.30
The Sensitivity of I35 is 42.37
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 52.3494
The Specificity of I27 is 70.00
The Specificity of I34 is 33.72
The Specificity of I35 is 76.92
The Specificity of I36 is 28.76
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 16.958984375, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.7659912109375, uma_loss is 3.192992687225342
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 16.90360450744629, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.750007629394531, uma_loss is 3.1535966396331787
loss is 16.812131881713867, acc1 is 0.048828125, acc5 is 0.78125, cma_loss is 13.813835144042969, uma_loss is 2.9982962608337402
loss is 16.761600494384766, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.755382537841797, uma_loss is 3.006218433380127
loss is 16.835247039794922, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.76202392578125, uma_loss is 3.0732228755950928
loss is 16.811254501342773, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.782554626464844, uma_loss is 3.028700351715088
loss is 16.647863388061523, acc1 is 0.244140625, acc5 is 0.927734375, cma_loss is 13.782760620117188, uma_loss is 2.865102767944336
loss is 16.60907745361328, acc1 is 0.29296875, acc5 is 0.927734375, cma_loss is 13.781364440917969, uma_loss is 2.827712059020996
loss is 16.44568634033203, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.794986724853516, uma_loss is 2.650700092315674
loss is 16.447093963623047, acc1 is 0.244140625, acc5 is 1.171875, cma_loss is 13.765281677246094, uma_loss is 2.6818125247955322
loss is 16.4351863861084, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.775230407714844, uma_loss is 2.6599555015563965
loss is 16.458574295043945, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.766128540039062, uma_loss is 2.692445755004883
loss is 16.381732940673828, acc1 is 0.0, acc5 is 0.537109375, cma_loss is 13.795310974121094, uma_loss is 2.5864224433898926
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 38.81it/s]
8 epoch loss is 2.0619813101632256,                                    acc1 is 0.16526442307692307, acc5 is 0.87890625
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.09it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 129.79it/s]
-----------------------------------
The average AUROC is 29.2588
The AUROC of I313 is 31.99
The AUROC of I314 is 26.53
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 5.1363
The Specificity of I313 is 6.41
The Specificity of I314 is 3.86
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.02it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 18%|███████▉                                     | 9/51 [02:28<11:20, 16.20s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.6328
The AUROC of I27 is 42.25
The AUROC of I34 is 52.96
The AUROC of I35 is 48.94
The AUROC of I36 is 50.38
-----------------------------------
The average Sensitivity is 83.2901
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 80.53
The Sensitivity of I35 is 75.71
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 26.1286
The Specificity of I27 is 6.31
The Specificity of I34 is 32.07
The Specificity of I35 is 30.15
The Specificity of I36 is 35.99
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 16.323291778564453, acc1 is 0.146484375, acc5 is 1.025390625, cma_loss is 13.73101806640625, uma_loss is 2.592273235321045
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 16.344497680664062, acc1 is 0.244140625, acc5 is 1.07421875, cma_loss is 13.734039306640625, uma_loss is 2.6104583740234375
loss is 16.311782836914062, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.769783020019531, uma_loss is 2.5420007705688477
loss is 16.341238021850586, acc1 is 0.09765625, acc5 is 1.123046875, cma_loss is 13.720096588134766, uma_loss is 2.6211421489715576
loss is 16.278301239013672, acc1 is 0.29296875, acc5 is 0.927734375, cma_loss is 13.741893768310547, uma_loss is 2.5364081859588623
loss is 16.28783416748047, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.756954193115234, uma_loss is 2.5308804512023926
loss is 16.22393035888672, acc1 is 0.1953125, acc5 is 1.3671875, cma_loss is 13.75339126586914, uma_loss is 2.470538854598999
loss is 16.231233596801758, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.77218246459961, uma_loss is 2.4590506553649902
loss is 16.187530517578125, acc1 is 0.29296875, acc5 is 1.123046875, cma_loss is 13.739208221435547, uma_loss is 2.448322057723999
loss is 16.240184783935547, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.716594696044922, uma_loss is 2.5235910415649414
loss is 16.229415893554688, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.735580444335938, uma_loss is 2.4938364028930664
loss is 16.15882110595703, acc1 is 0.29296875, acc5 is 0.732421875, cma_loss is 13.743812561035156, uma_loss is 2.415008068084717
loss is 16.102460861206055, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.730548858642578, uma_loss is 2.3719122409820557
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 71.57it/s]
9 epoch loss is 2.0120049794514974,                                    acc1 is 0.18780048076923078, acc5 is 0.8826622596153846
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.80it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 130.88it/s]
-----------------------------------
The average AUROC is 36.7616
The AUROC of I313 is 65.74
The AUROC of I314 is 7.78
-----------------------------------
The average Sensitivity is 27.7778
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 0.00
-----------------------------------
The average Specificity is 89.9199
The Specificity of I313 is 79.84
The Specificity of I314 is 100.00
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.87it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 20%|████████▋                                   | 10/51 [02:45<11:10, 16.35s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.7482
The AUROC of I27 is 42.92
The AUROC of I34 is 49.69
The AUROC of I35 is 48.43
The AUROC of I36 is 49.95
-----------------------------------
The average Sensitivity is 71.0938
The Sensitivity of I27 is 35.29
The Sensitivity of I34 is 55.75
The Sensitivity of I35 is 97.18
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 35.7870
The Specificity of I27 is 71.95
The Specificity of I34 is 47.92
The Specificity of I35 is 7.82
The Specificity of I36 is 15.46
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 16.101613998413086, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.715133666992188, uma_loss is 2.386479616165161
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.42s/it]
loss is 16.083044052124023, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.70016860961914, uma_loss is 2.3828752040863037
loss is 16.078041076660156, acc1 is 0.048828125, acc5 is 0.78125, cma_loss is 13.726676940917969, uma_loss is 2.3513636589050293
loss is 15.990394592285156, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.662464141845703, uma_loss is 2.327929973602295
loss is 16.058122634887695, acc1 is 0.244140625, acc5 is 1.07421875, cma_loss is 13.722549438476562, uma_loss is 2.33557391166687
loss is 16.064762115478516, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.719772338867188, uma_loss is 2.34498929977417
loss is 15.985060691833496, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.720542907714844, uma_loss is 2.2645175457000732
loss is 16.040117263793945, acc1 is 0.341796875, acc5 is 0.87890625, cma_loss is 13.736930847167969, uma_loss is 2.3031859397888184
loss is 15.924032211303711, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.717636108398438, uma_loss is 2.2063958644866943
loss is 15.965530395507812, acc1 is 0.1953125, acc5 is 1.3671875, cma_loss is 13.68764877319336, uma_loss is 2.277881383895874
loss is 15.959359169006348, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.706680297851562, uma_loss is 2.2526791095733643
loss is 15.871440887451172, acc1 is 0.341796875, acc5 is 0.9765625, cma_loss is 13.67673110961914, uma_loss is 2.1947100162506104
loss is 15.838115692138672, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.703487396240234, uma_loss is 2.1346282958984375
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 89.48it/s]
10 epoch loss is 1.9805679502941314,                                    acc1 is 0.20282451923076922, acc5 is 0.9127103365384616
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.00it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 128.86it/s]
-----------------------------------
The average AUROC is 47.0419
The AUROC of I313 is 82.48
The AUROC of I314 is 11.60
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 29.5391
The Specificity of I313 is 58.74
The Specificity of I314 is 0.33
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.95it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 22%|█████████▍                                  | 11/51 [03:01<10:51, 16.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.1960
The AUROC of I27 is 37.45
The AUROC of I34 is 50.84
The AUROC of I35 is 52.00
The AUROC of I36 is 40.50
-----------------------------------
The average Sensitivity is 64.6250
The Sensitivity of I27 is 17.65
The Sensitivity of I34 is 70.80
The Sensitivity of I35 is 70.06
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 41.9362
The Specificity of I27 is 89.93
The Specificity of I34 is 38.24
The Specificity of I35 is 38.50
The Specificity of I36 is 1.08
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 15.761215209960938, acc1 is 0.341796875, acc5 is 1.025390625, cma_loss is 13.684333801269531, uma_loss is 2.0768818855285645
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 15.703160285949707, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.651527404785156, uma_loss is 2.051632881164551
loss is 15.801965713500977, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.710186004638672, uma_loss is 2.0917794704437256
loss is 15.662184715270996, acc1 is 0.1953125, acc5 is 0.68359375, cma_loss is 13.618656158447266, uma_loss is 2.0435287952423096
loss is 15.759024620056152, acc1 is 0.29296875, acc5 is 1.07421875, cma_loss is 13.686038970947266, uma_loss is 2.0729856491088867
loss is 15.758903503417969, acc1 is 0.244140625, acc5 is 0.732421875, cma_loss is 13.691543579101562, uma_loss is 2.067359685897827
loss is 15.677515983581543, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.702388763427734, uma_loss is 1.9751269817352295
loss is 15.782514572143555, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.757858276367188, uma_loss is 2.024655818939209
loss is 15.656265258789062, acc1 is 0.09765625, acc5 is 1.07421875, cma_loss is 13.698383331298828, uma_loss is 1.9578821659088135
loss is 15.73153018951416, acc1 is 0.390625, acc5 is 1.3671875, cma_loss is 13.70583724975586, uma_loss is 2.02569317817688
loss is 15.663324356079102, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.693286895751953, uma_loss is 1.9700379371643066
loss is 15.674165725708008, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.722366333007812, uma_loss is 1.9517996311187744
loss is 15.617823600769043, acc1 is 0.146484375, acc5 is 1.123046875, cma_loss is 13.69906234741211, uma_loss is 1.918761134147644
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 44.90it/s]
11 epoch loss is 1.9452342260451543,                                    acc1 is 0.23662860576923078, acc5 is 1.0103665865384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.37it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 128.71it/s]
-----------------------------------
The average AUROC is 50.8709
The AUROC of I313 is 78.91
The AUROC of I314 is 22.83
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 71.5754
The Specificity of I313 is 56.48
The Specificity of I314 is 86.68
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.86it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 24%|██████████▎                                 | 12/51 [03:17<10:32, 16.22s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.9075
The AUROC of I27 is 45.10
The AUROC of I34 is 44.78
The AUROC of I35 is 49.36
The AUROC of I36 is 56.38
-----------------------------------
The average Sensitivity is 67.5763
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 67.80
The Sensitivity of I36 is 26.92
-----------------------------------
The average Specificity is 43.7396
The Specificity of I27 is 36.11
The Specificity of I34 is 5.02
The Specificity of I35 is 38.42
The Specificity of I36 is 95.41
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 15.620790481567383, acc1 is 0.09765625, acc5 is 1.07421875, cma_loss is 13.690467834472656, uma_loss is 1.9303224086761475
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.15it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 15.51866626739502, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.629875183105469, uma_loss is 1.8887908458709717
loss is 15.608341217041016, acc1 is 0.048828125, acc5 is 0.634765625, cma_loss is 13.728778839111328, uma_loss is 1.8795621395111084
loss is 15.471567153930664, acc1 is 0.244140625, acc5 is 1.26953125, cma_loss is 13.57461166381836, uma_loss is 1.896955966949463
loss is 15.492300033569336, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.645408630371094, uma_loss is 1.8468912839889526
loss is 15.46108341217041, acc1 is 0.244140625, acc5 is 1.07421875, cma_loss is 13.653060913085938, uma_loss is 1.8080224990844727
loss is 15.481987953186035, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.708602905273438, uma_loss is 1.773384690284729
loss is 15.426897048950195, acc1 is 0.29296875, acc5 is 0.78125, cma_loss is 13.732879638671875, uma_loss is 1.6940170526504517
loss is 15.385899543762207, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.679691314697266, uma_loss is 1.7062079906463623
loss is 15.4187593460083, acc1 is 0.244140625, acc5 is 0.78125, cma_loss is 13.692596435546875, uma_loss is 1.7261626720428467
loss is 15.436134338378906, acc1 is 0.0, acc5 is 0.78125, cma_loss is 13.721996307373047, uma_loss is 1.7141377925872803
loss is 15.38876724243164, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.695751190185547, uma_loss is 1.6930158138275146
loss is 15.343019485473633, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.70062255859375, uma_loss is 1.6423968076705933
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 82.04it/s]
12 epoch loss is 1.9148020335606166,                                    acc1 is 0.17277644230769232, acc5 is 0.9164663461538461
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.97it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 144.35it/s]
-----------------------------------
The average AUROC is 38.7704
The AUROC of I313 is 66.64
The AUROC of I314 is 10.90
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 35.5125
The Specificity of I313 is 69.49
The Specificity of I314 is 1.53
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.98it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 25%|███████████▏                                | 13/51 [03:34<10:20, 16.33s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.3037
The AUROC of I27 is 70.19
The AUROC of I34 is 52.47
The AUROC of I35 is 48.00
The AUROC of I36 is 50.55
-----------------------------------
The average Sensitivity is 70.9218
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 41.59
The Sensitivity of I35 is 88.70
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 49.3533
The Specificity of I27 is 68.93
The Specificity of I34 is 66.36
The Specificity of I35 is 15.34
The Specificity of I36 is 46.79
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 15.24302864074707, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.647205352783203, uma_loss is 1.595823049545288
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.15it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 15.267524719238281, acc1 is 0.1953125, acc5 is 1.220703125, cma_loss is 13.60128402709961, uma_loss is 1.6662408113479614
loss is 15.323654174804688, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.64425277709961, uma_loss is 1.6794017553329468
loss is 15.295854568481445, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.586662292480469, uma_loss is 1.7091923952102661
loss is 15.299938201904297, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.642486572265625, uma_loss is 1.6574517488479614
loss is 15.355422019958496, acc1 is 0.146484375, acc5 is 1.220703125, cma_loss is 13.725395202636719, uma_loss is 1.630027174949646
loss is 15.264045715332031, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.643291473388672, uma_loss is 1.620754361152649
loss is 15.262787818908691, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.660369873046875, uma_loss is 1.6024178266525269
loss is 15.299479484558105, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.66244125366211, uma_loss is 1.637038230895996
loss is 15.197731018066406, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.637931823730469, uma_loss is 1.559799313545227
loss is 15.199085235595703, acc1 is 0.1953125, acc5 is 1.171875, cma_loss is 13.640361785888672, uma_loss is 1.5587234497070312
loss is 15.231691360473633, acc1 is 0.048828125, acc5 is 0.78125, cma_loss is 13.661651611328125, uma_loss is 1.5700401067733765
loss is 15.142136573791504, acc1 is 0.244140625, acc5 is 1.26953125, cma_loss is 13.648563385009766, uma_loss is 1.493573546409607
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 67.54it/s]
13 epoch loss is 1.8893559955415271,                                    acc1 is 0.18780048076923078, acc5 is 1.0854867788461537
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.09it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 148.21it/s]
-----------------------------------
The average AUROC is 34.3286
The AUROC of I313 is 57.03
The AUROC of I314 is 11.63
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 13.0840
The Specificity of I313 is 26.10
The Specificity of I314 is 0.07
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.93it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 27%|████████████                                | 14/51 [03:50<09:58, 16.18s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.2793
The AUROC of I27 is 52.86
The AUROC of I34 is 51.75
The AUROC of I35 is 42.51
The AUROC of I36 is 61.99
-----------------------------------
The average Sensitivity is 50.9177
The Sensitivity of I27 is 64.71
The Sensitivity of I34 is 57.52
The Sensitivity of I35 is 4.52
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 62.8024
The Specificity of I27 is 57.65
The Specificity of I34 is 49.35
The Specificity of I35 is 96.47
The Specificity of I36 is 47.74
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 15.14254093170166, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.607349395751953, uma_loss is 1.535191297531128
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.13it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 15.12287712097168, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.578239440917969, uma_loss is 1.54463791847229
loss is 15.145615577697754, acc1 is 0.244140625, acc5 is 1.26953125, cma_loss is 13.62563705444336, uma_loss is 1.5199787616729736
loss is 15.003302574157715, acc1 is 0.244140625, acc5 is 1.171875, cma_loss is 13.533519744873047, uma_loss is 1.4697829484939575
loss is 15.091837882995605, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.606948852539062, uma_loss is 1.4848891496658325
loss is 15.101696014404297, acc1 is 0.09765625, acc5 is 1.025390625, cma_loss is 13.617767333984375, uma_loss is 1.4839284420013428
loss is 15.086919784545898, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.594966888427734, uma_loss is 1.491952657699585
loss is 15.112340927124023, acc1 is 0.244140625, acc5 is 1.171875, cma_loss is 13.599311828613281, uma_loss is 1.5130290985107422
loss is 15.066625595092773, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.602672576904297, uma_loss is 1.4639525413513184
loss is 15.04599666595459, acc1 is 0.29296875, acc5 is 1.123046875, cma_loss is 13.568050384521484, uma_loss is 1.477946400642395
loss is 14.960865020751953, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.5538330078125, uma_loss is 1.4070316553115845
loss is 14.987217903137207, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.586139678955078, uma_loss is 1.4010781049728394
loss is 14.998948097229004, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.579730987548828, uma_loss is 1.4192169904708862
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 119.04it/s]
14 epoch loss is 1.8653979437691826,                                    acc1 is 0.20658052884615385, acc5 is 1.1155348557692308
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.04it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 158.44it/s]
-----------------------------------
The average AUROC is 35.5407
The AUROC of I313 is 25.55
The AUROC of I314 is 45.54
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 14.3908
The Specificity of I313 is 0.40
The Specificity of I314 is 28.38
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.07it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 29%|████████████▉                               | 15/51 [04:06<09:40, 16.13s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.3898
The AUROC of I27 is 55.57
The AUROC of I34 is 49.30
The AUROC of I35 is 57.87
The AUROC of I36 is 58.82
-----------------------------------
The average Sensitivity is 80.5345
The Sensitivity of I27 is 88.24
The Sensitivity of I34 is 92.92
The Sensitivity of I35 is 71.75
The Sensitivity of I36 is 69.23
-----------------------------------
The average Specificity is 34.9532
The Specificity of I27 is 29.87
The Specificity of I34 is 13.70
The Specificity of I35 is 43.31
The Specificity of I36 is 52.94
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 15.028203010559082, acc1 is 0.29296875, acc5 is 1.3671875, cma_loss is 13.605365753173828, uma_loss is 1.4228376150131226
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.21it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 14.958490371704102, acc1 is 0.1953125, acc5 is 1.123046875, cma_loss is 13.559192657470703, uma_loss is 1.3992974758148193
loss is 14.923818588256836, acc1 is 0.537109375, acc5 is 1.3671875, cma_loss is 13.568675994873047, uma_loss is 1.3551424741744995
loss is 14.833786010742188, acc1 is 0.29296875, acc5 is 1.416015625, cma_loss is 13.499698638916016, uma_loss is 1.3340872526168823
loss is 14.892126083374023, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.569347381591797, uma_loss is 1.3227791786193848
loss is 14.910602569580078, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.589179992675781, uma_loss is 1.3214223384857178
loss is 14.900728225708008, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.57254409790039, uma_loss is 1.3281841278076172
loss is 14.835418701171875, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.569278717041016, uma_loss is 1.2661404609680176
loss is 14.798254013061523, acc1 is 0.1953125, acc5 is 1.26953125, cma_loss is 13.557437896728516, uma_loss is 1.2408161163330078
loss is 14.816869735717773, acc1 is 0.341796875, acc5 is 1.318359375, cma_loss is 13.547996520996094, uma_loss is 1.2688732147216797
loss is 14.846487998962402, acc1 is 0.1953125, acc5 is 1.26953125, cma_loss is 13.548614501953125, uma_loss is 1.2978733777999878
loss is 14.808801651000977, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.536846160888672, uma_loss is 1.2719553709030151
loss is 14.759622573852539, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.553726196289062, uma_loss is 1.2058968544006348
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 76.42it/s]
15 epoch loss is 1.8410781860351562,                                    acc1 is 0.2704326923076923, acc5 is 1.2244591346153846
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.64it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 139.80it/s]
-----------------------------------
The average AUROC is 37.8068
The AUROC of I313 is 32.02
The AUROC of I314 is 43.59
-----------------------------------
The average Sensitivity is 38.8889
The Sensitivity of I313 is 11.11
The Sensitivity of I314 is 66.67
-----------------------------------
The average Specificity is 75.4801
The Specificity of I313 is 97.06
The Specificity of I314 is 53.90
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.78it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 31%|█████████████▊                              | 16/51 [04:22<09:25, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.8813
The AUROC of I27 is 56.51
The AUROC of I34 is 52.41
The AUROC of I35 is 51.60
The AUROC of I36 is 51.01
-----------------------------------
The average Sensitivity is 89.7073
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 90.27
The Sensitivity of I35 is 89.83
The Sensitivity of I36 is 84.62
-----------------------------------
The average Specificity is 25.9059
The Specificity of I27 is 27.52
The Specificity of I34 is 17.93
The Specificity of I35 is 20.23
The Specificity of I36 is 37.95
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.768576622009277, acc1 is 0.29296875, acc5 is 1.66015625, cma_loss is 13.542953491210938, uma_loss is 1.2256228923797607
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 14.761103630065918, acc1 is 0.390625, acc5 is 1.7578125, cma_loss is 13.496498107910156, uma_loss is 1.2646056413650513
loss is 14.769304275512695, acc1 is 0.390625, acc5 is 1.5625, cma_loss is 13.522052764892578, uma_loss is 1.2472519874572754
loss is 14.688687324523926, acc1 is 0.341796875, acc5 is 1.611328125, cma_loss is 13.434379577636719, uma_loss is 1.254307746887207
loss is 14.85373306274414, acc1 is 0.341796875, acc5 is 1.220703125, cma_loss is 13.58120346069336, uma_loss is 1.2725297212600708
loss is 14.89411449432373, acc1 is 0.1953125, acc5 is 0.927734375, cma_loss is 13.644020080566406, uma_loss is 1.2500941753387451
loss is 14.793110847473145, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.625022888183594, uma_loss is 1.1680876016616821
loss is 14.861404418945312, acc1 is 0.146484375, acc5 is 1.07421875, cma_loss is 13.555595397949219, uma_loss is 1.3058085441589355
loss is 14.831625938415527, acc1 is 0.244140625, acc5 is 1.07421875, cma_loss is 13.63040542602539, uma_loss is 1.2012205123901367
loss is 14.729056358337402, acc1 is 0.48828125, acc5 is 1.7578125, cma_loss is 13.517810821533203, uma_loss is 1.2112457752227783
loss is 14.744612693786621, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.548274993896484, uma_loss is 1.1963376998901367
loss is 14.76172924041748, acc1 is 0.1953125, acc5 is 1.025390625, cma_loss is 13.532962799072266, uma_loss is 1.2287664413452148
loss is 14.76095962524414, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.584842681884766, uma_loss is 1.1761168241500854
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 78.29it/s]
16 epoch loss is 1.830647795540946,                                    acc1 is 0.28921274038461536, acc5 is 1.3108473557692308
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 145.87it/s]
-----------------------------------
The average AUROC is 32.7140
The AUROC of I313 is 43.27
The AUROC of I314 is 22.16
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 23.9631
The Specificity of I313 is 45.73
The Specificity of I314 is 2.20
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.83it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 33%|██████████████▋                             | 17/51 [04:38<09:13, 16.29s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.6644
The AUROC of I27 is 62.76
The AUROC of I34 is 51.10
The AUROC of I35 is 52.66
The AUROC of I36 is 56.13
-----------------------------------
The average Sensitivity is 80.7106
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 91.15
The Sensitivity of I35 is 84.18
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 36.0520
The Specificity of I27 is 57.79
The Specificity of I34 is 16.36
The Specificity of I35 is 24.96
The Specificity of I36 is 45.10
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.681625366210938, acc1 is 0.29296875, acc5 is 1.611328125, cma_loss is 13.534984588623047, uma_loss is 1.1466407775878906
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 14.711469650268555, acc1 is 0.390625, acc5 is 1.5625, cma_loss is 13.489795684814453, uma_loss is 1.2216743230819702
loss is 14.708492279052734, acc1 is 0.390625, acc5 is 1.416015625, cma_loss is 13.530197143554688, uma_loss is 1.1782948970794678
loss is 14.5780029296875, acc1 is 0.29296875, acc5 is 1.66015625, cma_loss is 13.439186096191406, uma_loss is 1.1388163566589355
loss is 14.663579940795898, acc1 is 0.439453125, acc5 is 2.001953125, cma_loss is 13.47879409790039, uma_loss is 1.1847853660583496
loss is 14.695856094360352, acc1 is 0.244140625, acc5 is 1.3671875, cma_loss is 13.53658676147461, uma_loss is 1.1592693328857422
loss is 14.647334098815918, acc1 is 0.341796875, acc5 is 1.513671875, cma_loss is 13.547122955322266, uma_loss is 1.1002107858657837
loss is 14.653350830078125, acc1 is 0.09765625, acc5 is 1.07421875, cma_loss is 13.51224136352539, uma_loss is 1.1411093473434448
loss is 14.572220802307129, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.499214172363281, uma_loss is 1.0730066299438477
loss is 14.531457901000977, acc1 is 0.244140625, acc5 is 1.46484375, cma_loss is 13.476533889770508, uma_loss is 1.054924488067627
loss is 14.553075790405273, acc1 is 0.146484375, acc5 is 1.26953125, cma_loss is 13.524017333984375, uma_loss is 1.0290586948394775
loss is 14.596000671386719, acc1 is 0.29296875, acc5 is 1.3671875, cma_loss is 13.51650619506836, uma_loss is 1.0794942378997803
loss is 14.566951751708984, acc1 is 0.29296875, acc5 is 1.708984375, cma_loss is 13.467765808105469, uma_loss is 1.0991864204406738
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 75.15it/s]
17 epoch loss is 1.8110420772007534,                                    acc1 is 0.29672475961538464, acc5 is 1.5024038461538463
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.72it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 126.39it/s]
-----------------------------------
The average AUROC is 41.2519
The AUROC of I313 is 36.77
The AUROC of I314 is 45.74
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 66.67
-----------------------------------
The average Specificity is 53.1813
The Specificity of I313 is 50.07
The Specificity of I314 is 56.30
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.01it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 35%|███████████████▌                            | 18/51 [04:55<08:59, 16.36s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.0777
The AUROC of I27 is 66.18
The AUROC of I34 is 47.72
The AUROC of I35 is 51.90
The AUROC of I36 is 54.51
-----------------------------------
The average Sensitivity is 57.2553
The Sensitivity of I27 is 88.24
The Sensitivity of I34 is 19.47
The Sensitivity of I35 is 55.93
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 61.1261
The Specificity of I27 is 51.34
The Specificity of I34 is 86.66
The Specificity of I35 is 51.88
The Specificity of I36 is 54.63
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.54414176940918, acc1 is 0.29296875, acc5 is 1.220703125, cma_loss is 13.489219665527344, uma_loss is 1.054922103881836
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 14.483723640441895, acc1 is 0.5859375, acc5 is 1.85546875, cma_loss is 13.423271179199219, uma_loss is 1.0604523420333862
loss is 14.534889221191406, acc1 is 0.29296875, acc5 is 1.708984375, cma_loss is 13.493423461914062, uma_loss is 1.0414659976959229
loss is 14.477972984313965, acc1 is 0.1953125, acc5 is 1.708984375, cma_loss is 13.468414306640625, uma_loss is 1.0095586776733398
loss is 14.540163040161133, acc1 is 0.341796875, acc5 is 1.611328125, cma_loss is 13.491008758544922, uma_loss is 1.0491539239883423
loss is 14.473384857177734, acc1 is 0.48828125, acc5 is 1.46484375, cma_loss is 13.450019836425781, uma_loss is 1.0233653783798218
loss is 14.510669708251953, acc1 is 0.390625, acc5 is 1.220703125, cma_loss is 13.495254516601562, uma_loss is 1.0154147148132324
loss is 14.552963256835938, acc1 is 0.341796875, acc5 is 1.220703125, cma_loss is 13.531784057617188, uma_loss is 1.021178960800171
loss is 14.501288414001465, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.505138397216797, uma_loss is 0.9961495995521545
loss is 14.45767879486084, acc1 is 0.48828125, acc5 is 1.708984375, cma_loss is 13.471160888671875, uma_loss is 0.9865177869796753
loss is 14.455965995788574, acc1 is 0.537109375, acc5 is 1.904296875, cma_loss is 13.47598648071289, uma_loss is 0.9799795150756836
loss is 14.516697883605957, acc1 is 0.29296875, acc5 is 1.5625, cma_loss is 13.50851821899414, uma_loss is 1.008179783821106
loss is 14.407212257385254, acc1 is 0.390625, acc5 is 1.904296875, cma_loss is 13.452144622802734, uma_loss is 0.95506751537323
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 74.50it/s]
18 epoch loss is 1.7948262078421457,                                    acc1 is 0.37560096153846156, acc5 is 1.5700120192307692
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.98it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 148.31it/s]
-----------------------------------
The average AUROC is 40.4120
The AUROC of I313 is 42.69
The AUROC of I314 is 38.13
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 57.9158
The Specificity of I313 is 87.78
The Specificity of I314 is 28.05
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.84it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 37%|████████████████▍                           | 19/51 [05:11<08:39, 16.25s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 53.0939
The AUROC of I27 is 51.39
The AUROC of I34 is 52.94
The AUROC of I35 is 47.36
The AUROC of I36 is 60.69
-----------------------------------
The average Sensitivity is 73.6428
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 65.49
The Sensitivity of I35 is 89.27
The Sensitivity of I36 is 69.23
-----------------------------------
The average Specificity is 39.9529
The Specificity of I27 is 41.54
The Specificity of I34 is 43.76
The Specificity of I35 is 14.89
The Specificity of I36 is 59.62
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.412737846374512, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.47701644897461, uma_loss is 0.9357212781906128
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.17it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 14.46054744720459, acc1 is 0.390625, acc5 is 2.05078125, cma_loss is 13.435466766357422, uma_loss is 1.025080919265747
loss is 14.4324369430542, acc1 is 0.29296875, acc5 is 1.7578125, cma_loss is 13.460580825805664, uma_loss is 0.9718557596206665
loss is 14.374105453491211, acc1 is 0.341796875, acc5 is 1.3671875, cma_loss is 13.411050796508789, uma_loss is 0.9630542397499084
loss is 14.504846572875977, acc1 is 0.341796875, acc5 is 1.904296875, cma_loss is 13.536197662353516, uma_loss is 0.9686489105224609
loss is 14.400261878967285, acc1 is 0.48828125, acc5 is 2.197265625, cma_loss is 13.465835571289062, uma_loss is 0.9344265460968018
loss is 14.49496078491211, acc1 is 0.29296875, acc5 is 1.611328125, cma_loss is 13.546890258789062, uma_loss is 0.9480704069137573
loss is 14.435992240905762, acc1 is 0.29296875, acc5 is 2.05078125, cma_loss is 13.493473052978516, uma_loss is 0.94251948595047
loss is 14.393321990966797, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.485424041748047, uma_loss is 0.9078976511955261
loss is 14.383890151977539, acc1 is 0.5859375, acc5 is 1.85546875, cma_loss is 13.441385269165039, uma_loss is 0.9425049424171448
loss is 14.449132919311523, acc1 is 0.1953125, acc5 is 1.220703125, cma_loss is 13.538002014160156, uma_loss is 0.9111306667327881
loss is 14.399920463562012, acc1 is 0.48828125, acc5 is 1.66015625, cma_loss is 13.478504180908203, uma_loss is 0.9214159250259399
loss is 14.379015922546387, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.4842529296875, uma_loss is 0.8947629928588867
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 85.28it/s]
19 epoch loss is 1.785915910629999,                                    acc1 is 0.33804086538461536, acc5 is 1.6451322115384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.56it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 143.99it/s]
-----------------------------------
The average AUROC is 41.0654
The AUROC of I313 is 42.75
The AUROC of I314 is 39.38
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 61.5172
The Specificity of I313 is 91.59
The Specificity of I314 is 31.45
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.98it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 39%|█████████████████▎                          | 20/51 [05:27<08:20, 16.14s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 54.1172
The AUROC of I27 is 55.36
The AUROC of I34 is 51.51
The AUROC of I35 is 51.47
The AUROC of I36 is 58.12
-----------------------------------
The average Sensitivity is 48.7638
The Sensitivity of I27 is 88.24
The Sensitivity of I34 is 32.74
The Sensitivity of I35 is 16.38
The Sensitivity of I36 is 57.69
-----------------------------------
The average Specificity is 65.6099
The Specificity of I27 is 31.61
The Specificity of I34 is 73.24
The Specificity of I35 is 88.65
The Specificity of I36 is 68.94
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.33856201171875, acc1 is 0.341796875, acc5 is 1.46484375, cma_loss is 13.469093322753906, uma_loss is 0.8694684505462646
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 14.286115646362305, acc1 is 0.48828125, acc5 is 2.001953125, cma_loss is 13.393287658691406, uma_loss is 0.8928279876708984
loss is 14.336734771728516, acc1 is 0.537109375, acc5 is 2.05078125, cma_loss is 13.459917068481445, uma_loss is 0.876817524433136
loss is 14.24734878540039, acc1 is 0.146484375, acc5 is 1.708984375, cma_loss is 13.371414184570312, uma_loss is 0.8759347200393677
loss is 14.319204330444336, acc1 is 0.390625, acc5 is 1.416015625, cma_loss is 13.426475524902344, uma_loss is 0.8927286863327026
loss is 14.285439491271973, acc1 is 0.341796875, acc5 is 1.806640625, cma_loss is 13.445528030395508, uma_loss is 0.8399113416671753
loss is 14.305366516113281, acc1 is 0.439453125, acc5 is 1.46484375, cma_loss is 13.455070495605469, uma_loss is 0.8502963185310364
loss is 14.260320663452148, acc1 is 0.29296875, acc5 is 1.5625, cma_loss is 13.431720733642578, uma_loss is 0.8286002278327942
loss is 14.274234771728516, acc1 is 0.537109375, acc5 is 1.708984375, cma_loss is 13.461984634399414, uma_loss is 0.8122496604919434
loss is 14.188801765441895, acc1 is 0.439453125, acc5 is 2.001953125, cma_loss is 13.359228134155273, uma_loss is 0.8295738101005554
loss is 14.268519401550293, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.441791534423828, uma_loss is 0.826728105545044
loss is 14.207894325256348, acc1 is 0.390625, acc5 is 1.806640625, cma_loss is 13.392902374267578, uma_loss is 0.8149923086166382
loss is 14.23740005493164, acc1 is 0.48828125, acc5 is 2.001953125, cma_loss is 13.404129028320312, uma_loss is 0.8332706689834595
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 86.49it/s]
20 epoch loss is 1.767199452718099,                                    acc1 is 0.40189302884615385, acc5 is 1.7315204326923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.87it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 128.14it/s]
-----------------------------------
The average AUROC is 46.0990
The AUROC of I313 is 39.00
The AUROC of I314 is 53.20
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 30.7905
The Specificity of I313 is 11.01
The Specificity of I314 is 50.57
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.78it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 41%|██████████████████                          | 21/51 [05:43<08:06, 16.21s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.5737
The AUROC of I27 is 42.87
The AUROC of I34 is 53.47
The AUROC of I35 is 46.26
The AUROC of I36 is 55.69
-----------------------------------
The average Sensitivity is 77.5218
The Sensitivity of I27 is 88.24
The Sensitivity of I34 is 59.29
The Sensitivity of I35 is 97.18
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 32.0658
The Specificity of I27 is 22.48
The Specificity of I34 is 49.21
The Specificity of I35 is 3.83
The Specificity of I36 is 52.73
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.255414962768555, acc1 is 0.29296875, acc5 is 1.708984375, cma_loss is 13.443880081176758, uma_loss is 0.8115345239639282
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.17it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 14.215944290161133, acc1 is 0.5859375, acc5 is 2.05078125, cma_loss is 13.375190734863281, uma_loss is 0.8407539129257202
loss is 14.204707145690918, acc1 is 0.439453125, acc5 is 1.611328125, cma_loss is 13.424827575683594, uma_loss is 0.7798798680305481
loss is 14.17475700378418, acc1 is 0.244140625, acc5 is 1.611328125, cma_loss is 13.406204223632812, uma_loss is 0.7685523629188538
loss is 14.243928909301758, acc1 is 0.68359375, acc5 is 2.24609375, cma_loss is 13.434062957763672, uma_loss is 0.8098663091659546
loss is 14.245048522949219, acc1 is 0.1953125, acc5 is 2.24609375, cma_loss is 13.441701889038086, uma_loss is 0.8033465147018433
loss is 14.268741607666016, acc1 is 0.5859375, acc5 is 1.611328125, cma_loss is 13.498031616210938, uma_loss is 0.7707098126411438
loss is 14.138317108154297, acc1 is 0.390625, acc5 is 2.5390625, cma_loss is 13.39482307434082, uma_loss is 0.7434936165809631
loss is 14.192938804626465, acc1 is 0.146484375, acc5 is 1.3671875, cma_loss is 13.469024658203125, uma_loss is 0.7239139080047607
loss is 14.14115047454834, acc1 is 0.341796875, acc5 is 1.953125, cma_loss is 13.390386581420898, uma_loss is 0.7507635354995728
loss is 14.194145202636719, acc1 is 0.537109375, acc5 is 1.806640625, cma_loss is 13.474014282226562, uma_loss is 0.7201311588287354
loss is 14.198338508605957, acc1 is 0.341796875, acc5 is 2.197265625, cma_loss is 13.452733993530273, uma_loss is 0.7456046342849731
loss is 14.166196823120117, acc1 is 0.48828125, acc5 is 1.806640625, cma_loss is 13.425533294677734, uma_loss is 0.7406635880470276
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 78.06it/s]
21 epoch loss is 1.7584726606096541,                                    acc1 is 0.40564903846153844, acc5 is 1.904296875
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.67it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 142.62it/s]
-----------------------------------
The average AUROC is 50.0452
The AUROC of I313 is 67.49
The AUROC of I314 is 32.60
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 28.9522
The Specificity of I313 is 38.18
The Specificity of I314 is 19.72
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.82it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 43%|██████████████████▉                         | 22/51 [05:59<07:48, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.9708
The AUROC of I27 is 47.13
The AUROC of I34 is 56.89
The AUROC of I35 is 52.65
The AUROC of I36 is 43.21
-----------------------------------
The average Sensitivity is 72.8784
The Sensitivity of I27 is 88.24
The Sensitivity of I34 is 68.14
The Sensitivity of I35 is 38.98
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 37.3934
The Specificity of I27 is 21.48
The Specificity of I34 is 44.76
The Specificity of I35 is 70.98
The Specificity of I36 is 12.36
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.123542785644531, acc1 is 0.439453125, acc5 is 1.85546875, cma_loss is 13.43232536315918, uma_loss is 0.6912175416946411
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.15it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 14.064860343933105, acc1 is 0.439453125, acc5 is 1.904296875, cma_loss is 13.329994201660156, uma_loss is 0.7348663210868835
loss is 14.124442100524902, acc1 is 0.732421875, acc5 is 1.46484375, cma_loss is 13.427360534667969, uma_loss is 0.697081446647644
loss is 14.04118824005127, acc1 is 0.439453125, acc5 is 2.197265625, cma_loss is 13.338115692138672, uma_loss is 0.7030723690986633
loss is 14.107403755187988, acc1 is 0.732421875, acc5 is 1.85546875, cma_loss is 13.399415969848633, uma_loss is 0.7079874873161316
loss is 14.143037796020508, acc1 is 0.390625, acc5 is 1.7578125, cma_loss is 13.463384628295898, uma_loss is 0.6796530485153198
loss is 14.083564758300781, acc1 is 0.5859375, acc5 is 2.05078125, cma_loss is 13.391895294189453, uma_loss is 0.6916692852973938
loss is 14.064019203186035, acc1 is 0.390625, acc5 is 1.66015625, cma_loss is 13.400545120239258, uma_loss is 0.6634737253189087
loss is 14.063597679138184, acc1 is 0.390625, acc5 is 2.099609375, cma_loss is 13.390897750854492, uma_loss is 0.6727001667022705
loss is 14.06835651397705, acc1 is 0.634765625, acc5 is 2.197265625, cma_loss is 13.354280471801758, uma_loss is 0.7140756845474243
loss is 14.043144226074219, acc1 is 0.439453125, acc5 is 2.1484375, cma_loss is 13.377227783203125, uma_loss is 0.6659164428710938
loss is 14.030797958374023, acc1 is 0.390625, acc5 is 1.806640625, cma_loss is 13.376174926757812, uma_loss is 0.6546231508255005
loss is 14.073860168457031, acc1 is 0.1953125, acc5 is 1.85546875, cma_loss is 13.408981323242188, uma_loss is 0.6648786067962646
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 77.14it/s]
22 epoch loss is 1.7431601478939964,                                    acc1 is 0.47701322115384615, acc5 is 1.9118088942307692
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.08it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 130.26it/s]
-----------------------------------
The average AUROC is 44.7350
The AUROC of I313 is 61.13
The AUROC of I314 is 28.34
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 40.4783
The Specificity of I313 is 71.96
The Specificity of I314 is 8.99
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.79it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 45%|███████████████████▊                        | 23/51 [06:15<07:30, 16.07s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.7565
The AUROC of I27 is 38.70
The AUROC of I34 is 56.52
The AUROC of I35 is 50.25
The AUROC of I36 is 53.55
-----------------------------------
The average Sensitivity is 71.2688
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 57.52
The Sensitivity of I35 is 42.94
The Sensitivity of I36 is 84.62
-----------------------------------
The average Specificity is 39.3856
The Specificity of I27 is 7.32
The Specificity of I34 is 56.60
The Specificity of I35 is 63.98
The Specificity of I36 is 29.64
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 14.000300407409668, acc1 is 0.5859375, acc5 is 2.44140625, cma_loss is 13.380748748779297, uma_loss is 0.6195520758628845
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.13it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.95511531829834, acc1 is 0.48828125, acc5 is 2.197265625, cma_loss is 13.302082061767578, uma_loss is 0.6530334949493408
loss is 13.980588912963867, acc1 is 0.537109375, acc5 is 2.24609375, cma_loss is 13.346887588500977, uma_loss is 0.6337012648582458
loss is 13.883649826049805, acc1 is 0.390625, acc5 is 2.44140625, cma_loss is 13.261837005615234, uma_loss is 0.6218125224113464
loss is 13.98187255859375, acc1 is 0.390625, acc5 is 2.294921875, cma_loss is 13.322345733642578, uma_loss is 0.6595273017883301
loss is 14.019659042358398, acc1 is 0.634765625, acc5 is 2.294921875, cma_loss is 13.38690185546875, uma_loss is 0.632757306098938
loss is 14.040776252746582, acc1 is 0.390625, acc5 is 1.953125, cma_loss is 13.42050552368164, uma_loss is 0.620270848274231
loss is 13.982802391052246, acc1 is 0.390625, acc5 is 2.05078125, cma_loss is 13.36806869506836, uma_loss is 0.6147337555885315
loss is 13.99864387512207, acc1 is 0.439453125, acc5 is 2.099609375, cma_loss is 13.385700225830078, uma_loss is 0.6129432320594788
loss is 13.935651779174805, acc1 is 0.78125, acc5 is 2.978515625, cma_loss is 13.309192657470703, uma_loss is 0.6264593601226807
loss is 14.000531196594238, acc1 is 0.5859375, acc5 is 1.85546875, cma_loss is 13.385971069335938, uma_loss is 0.6145604252815247
loss is 13.951753616333008, acc1 is 0.439453125, acc5 is 1.953125, cma_loss is 13.334005355834961, uma_loss is 0.6177479028701782
loss is 13.911860466003418, acc1 is 0.439453125, acc5 is 2.83203125, cma_loss is 13.301288604736328, uma_loss is 0.6105716228485107
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 71.86it/s]
23 epoch loss is 1.72993529183524,                                    acc1 is 0.49954927884615385, acc5 is 2.2798978365384617
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.77it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 138.36it/s]
-----------------------------------
The average AUROC is 42.4408
The AUROC of I313 is 52.38
The AUROC of I314 is 32.50
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 56.1274
The Specificity of I313 is 98.13
The Specificity of I314 is 14.12
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.79it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 47%|████████████████████▋                       | 24/51 [06:32<07:17, 16.20s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.9886
The AUROC of I27 is 46.62
The AUROC of I34 is 56.58
The AUROC of I35 is 50.13
The AUROC of I36 is 58.63
-----------------------------------
The average Sensitivity is 56.6577
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 40.71
The Sensitivity of I35 is 44.07
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 57.7798
The Specificity of I27 is 31.28
The Specificity of I34 is 72.53
The Specificity of I35 is 66.62
The Specificity of I36 is 60.70
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.95464038848877, acc1 is 0.5859375, acc5 is 2.294921875, cma_loss is 13.340248107910156, uma_loss is 0.6143921613693237
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 13.878756523132324, acc1 is 0.5859375, acc5 is 1.806640625, cma_loss is 13.269088745117188, uma_loss is 0.6096675395965576
loss is 13.950312614440918, acc1 is 0.87890625, acc5 is 2.490234375, cma_loss is 13.367982864379883, uma_loss is 0.5823299884796143
loss is 13.822273254394531, acc1 is 0.537109375, acc5 is 2.05078125, cma_loss is 13.238061904907227, uma_loss is 0.5842112302780151
loss is 13.910921096801758, acc1 is 0.5859375, acc5 is 2.1484375, cma_loss is 13.306930541992188, uma_loss is 0.6039901971817017
loss is 13.89724349975586, acc1 is 0.78125, acc5 is 2.83203125, cma_loss is 13.296701431274414, uma_loss is 0.6005420684814453
loss is 13.871803283691406, acc1 is 0.48828125, acc5 is 1.806640625, cma_loss is 13.312026977539062, uma_loss is 0.559776246547699
loss is 13.948895454406738, acc1 is 0.68359375, acc5 is 2.44140625, cma_loss is 13.379802703857422, uma_loss is 0.5690929293632507
loss is 13.9752836227417, acc1 is 0.537109375, acc5 is 2.05078125, cma_loss is 13.392172813415527, uma_loss is 0.583111047744751
loss is 13.880434036254883, acc1 is 0.78125, acc5 is 2.44140625, cma_loss is 13.296143531799316, uma_loss is 0.5842902660369873
loss is 13.88516902923584, acc1 is 0.537109375, acc5 is 2.490234375, cma_loss is 13.317136764526367, uma_loss is 0.5680326223373413
loss is 13.889931678771973, acc1 is 0.390625, acc5 is 2.34375, cma_loss is 13.329656600952148, uma_loss is 0.5602749586105347
loss is 13.913040161132812, acc1 is 0.5859375, acc5 is 2.197265625, cma_loss is 13.31766128540039, uma_loss is 0.5953792333602905
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 71.09it/s]
24 epoch loss is 1.7217019489833287,                                    acc1 is 0.6122295673076923, acc5 is 2.2611177884615383
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.95it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 143.14it/s]
-----------------------------------
The average AUROC is 46.5228
The AUROC of I313 is 50.10
The AUROC of I314 is 42.95
-----------------------------------
The average Sensitivity is 66.6667
The Sensitivity of I313 is 33.33
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 56.4500
The Specificity of I313 is 87.65
The Specificity of I314 is 25.25
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  5.00it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 49%|█████████████████████▌                      | 25/51 [06:48<07:03, 16.29s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.4121
The AUROC of I27 is 63.08
The AUROC of I34 is 48.78
The AUROC of I35 is 52.81
The AUROC of I36 is 64.97
-----------------------------------
The average Sensitivity is 58.3867
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 60.18
The Sensitivity of I35 is 41.24
The Sensitivity of I36 is 61.54
-----------------------------------
The average Specificity is 60.1819
The Specificity of I27 is 61.61
The Specificity of I34 is 43.54
The Specificity of I35 is 67.44
The Specificity of I36 is 68.13
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.93423080444336, acc1 is 0.78125, acc5 is 2.783203125, cma_loss is 13.33107852935791, uma_loss is 0.6031525135040283
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.87842082977295, acc1 is 0.68359375, acc5 is 2.587890625, cma_loss is 13.245344161987305, uma_loss is 0.6330764293670654
loss is 13.927037239074707, acc1 is 0.9765625, acc5 is 2.83203125, cma_loss is 13.341241836547852, uma_loss is 0.585795521736145
loss is 13.779764175415039, acc1 is 0.78125, acc5 is 2.83203125, cma_loss is 13.22060775756836, uma_loss is 0.5591564178466797
loss is 13.851333618164062, acc1 is 0.5859375, acc5 is 3.125, cma_loss is 13.271053314208984, uma_loss is 0.5802807807922363
loss is 13.80760669708252, acc1 is 1.171875, acc5 is 3.02734375, cma_loss is 13.256658554077148, uma_loss is 0.5509481430053711
loss is 13.820819854736328, acc1 is 0.48828125, acc5 is 2.392578125, cma_loss is 13.298768997192383, uma_loss is 0.5220510363578796
loss is 13.784046173095703, acc1 is 0.87890625, acc5 is 3.22265625, cma_loss is 13.251731872558594, uma_loss is 0.5323143601417542
loss is 13.833948135375977, acc1 is 0.830078125, acc5 is 3.3203125, cma_loss is 13.30358600616455, uma_loss is 0.5303616523742676
loss is 13.776984214782715, acc1 is 0.68359375, acc5 is 2.9296875, cma_loss is 13.242630958557129, uma_loss is 0.5343531966209412
loss is 13.739191055297852, acc1 is 1.123046875, acc5 is 3.41796875, cma_loss is 13.210430145263672, uma_loss is 0.5287604331970215
loss is 13.782504081726074, acc1 is 0.439453125, acc5 is 2.1484375, cma_loss is 13.262653350830078, uma_loss is 0.5198510885238647
loss is 13.798103332519531, acc1 is 0.634765625, acc5 is 3.125, cma_loss is 13.279508590698242, uma_loss is 0.5185950994491577
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 79.63it/s]
25 epoch loss is 1.7115618115379696,                                    acc1 is 0.7737379807692307, acc5 is 2.9033954326923075
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.82it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 149.70it/s]
-----------------------------------
The average AUROC is 51.2415
The AUROC of I313 is 46.08
The AUROC of I314 is 56.41
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 75.7151
The Specificity of I313 is 98.93
The Specificity of I314 is 52.50
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.86it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 51%|██████████████████████▍                     | 26/51 [07:04<06:47, 16.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 54.5499
The AUROC of I27 is 56.03
The AUROC of I34 is 50.18
The AUROC of I35 is 49.21
The AUROC of I36 is 62.78
-----------------------------------
The average Sensitivity is 61.4950
The Sensitivity of I27 is 82.35
The Sensitivity of I34 is 86.73
The Sensitivity of I35 is 19.21
The Sensitivity of I36 is 57.69
-----------------------------------
The average Specificity is 55.3781
The Specificity of I27 is 44.09
The Specificity of I34 is 20.59
The Specificity of I35 is 85.86
The Specificity of I36 is 70.97
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.721665382385254, acc1 is 0.927734375, acc5 is 3.125, cma_loss is 13.231067657470703, uma_loss is 0.49059778451919556
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.22it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 13.656261444091797, acc1 is 1.07421875, acc5 is 3.41796875, cma_loss is 13.170454025268555, uma_loss is 0.4858076572418213
loss is 13.723078727722168, acc1 is 1.025390625, acc5 is 3.125, cma_loss is 13.256747245788574, uma_loss is 0.46633103489875793
loss is 13.67623519897461, acc1 is 0.732421875, acc5 is 3.02734375, cma_loss is 13.185067176818848, uma_loss is 0.4911683201789856
loss is 13.71745491027832, acc1 is 0.5859375, acc5 is 3.125, cma_loss is 13.212545394897461, uma_loss is 0.5049095153808594
loss is 13.710111618041992, acc1 is 1.025390625, acc5 is 3.02734375, cma_loss is 13.244636535644531, uma_loss is 0.4654753804206848
loss is 13.71120548248291, acc1 is 0.48828125, acc5 is 2.44140625, cma_loss is 13.238515853881836, uma_loss is 0.47269004583358765
loss is 13.648856163024902, acc1 is 0.927734375, acc5 is 3.3203125, cma_loss is 13.179756164550781, uma_loss is 0.4691004157066345
loss is 13.72374153137207, acc1 is 0.5859375, acc5 is 2.734375, cma_loss is 13.24576187133789, uma_loss is 0.4779798090457916
loss is 13.644002914428711, acc1 is 0.830078125, acc5 is 3.22265625, cma_loss is 13.184735298156738, uma_loss is 0.45926788449287415
loss is 13.641190528869629, acc1 is 0.9765625, acc5 is 3.3203125, cma_loss is 13.163040161132812, uma_loss is 0.4781501889228821
loss is 13.683539390563965, acc1 is 0.634765625, acc5 is 2.44140625, cma_loss is 13.197137832641602, uma_loss is 0.4864019751548767
loss is 13.65888500213623, acc1 is 0.732421875, acc5 is 3.125, cma_loss is 13.18210220336914, uma_loss is 0.4767829477787018
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 76.15it/s]
26 epoch loss is 1.6944402694702148,                                    acc1 is 0.8112980769230769, acc5 is 3.034855769230769
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.88it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 134.77it/s]
-----------------------------------
The average AUROC is 55.5744
The AUROC of I313 is 54.06
The AUROC of I314 is 57.08
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 77.3807
The Specificity of I313 is 98.93
The Specificity of I314 is 55.83
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.83it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 53%|███████████████████████▎                    | 27/51 [07:20<06:29, 16.21s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.4152
The AUROC of I27 is 69.23
The AUROC of I34 is 47.45
The AUROC of I35 is 46.07
The AUROC of I36 is 58.90
-----------------------------------
The average Sensitivity is 56.6751
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 44.25
The Sensitivity of I35 is 11.86
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 63.8388
The Specificity of I27 is 79.73
The Specificity of I34 is 60.19
The Specificity of I35 is 91.80
The Specificity of I36 is 23.63
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.58847427368164, acc1 is 0.830078125, acc5 is 3.271484375, cma_loss is 13.134748458862305, uma_loss is 0.45372581481933594
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.22it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 13.635018348693848, acc1 is 1.171875, acc5 is 3.7109375, cma_loss is 13.149779319763184, uma_loss is 0.4852392077445984
loss is 13.761430740356445, acc1 is 1.025390625, acc5 is 3.271484375, cma_loss is 13.296845436096191, uma_loss is 0.46458497643470764
loss is 13.68069076538086, acc1 is 0.830078125, acc5 is 3.369140625, cma_loss is 13.195899963378906, uma_loss is 0.48479127883911133
loss is 13.634324073791504, acc1 is 1.025390625, acc5 is 3.61328125, cma_loss is 13.159374237060547, uma_loss is 0.47495025396347046
loss is 13.667277336120605, acc1 is 0.78125, acc5 is 3.076171875, cma_loss is 13.21350383758545, uma_loss is 0.4537731409072876
loss is 13.616950988769531, acc1 is 0.87890625, acc5 is 2.5390625, cma_loss is 13.184049606323242, uma_loss is 0.4329012334346771
loss is 13.69356632232666, acc1 is 0.732421875, acc5 is 3.515625, cma_loss is 13.246627807617188, uma_loss is 0.44693896174430847
loss is 13.774846076965332, acc1 is 0.927734375, acc5 is 3.125, cma_loss is 13.332670211791992, uma_loss is 0.4421755373477936
loss is 13.666369438171387, acc1 is 1.171875, acc5 is 3.515625, cma_loss is 13.20769214630127, uma_loss is 0.45867758989334106
loss is 13.724018096923828, acc1 is 1.025390625, acc5 is 3.3203125, cma_loss is 13.238214492797852, uma_loss is 0.4858032166957855
loss is 13.716769218444824, acc1 is 0.68359375, acc5 is 2.63671875, cma_loss is 13.21246337890625, uma_loss is 0.5043057203292847
loss is 13.71783447265625, acc1 is 0.732421875, acc5 is 3.466796875, cma_loss is 13.206453323364258, uma_loss is 0.5113815665245056
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 82.34it/s]
27 epoch loss is 1.6940720966884069,                                    acc1 is 0.9089543269230769, acc5 is 3.263972355769231
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.81it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 131.33it/s]
-----------------------------------
The average AUROC is 57.2471
The AUROC of I313 is 55.64
The AUROC of I314 is 58.85
-----------------------------------
The average Sensitivity is 63.8889
The Sensitivity of I313 is 44.44
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 71.0698
The Specificity of I313 is 83.85
The Specificity of I314 is 58.29
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.79it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 55%|████████████████████████▏                   | 28/51 [07:36<06:11, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 54.0243
The AUROC of I27 is 60.64
The AUROC of I34 is 45.72
The AUROC of I35 is 50.07
The AUROC of I36 is 59.67
-----------------------------------
The average Sensitivity is 75.0838
The Sensitivity of I27 is 58.82
The Sensitivity of I34 is 95.58
The Sensitivity of I35 is 92.09
The Sensitivity of I36 is 53.85
-----------------------------------
The average Specificity is 39.1870
The Specificity of I27 is 68.93
The Specificity of I34 is 6.24
The Specificity of I35 is 13.38
The Specificity of I36 is 68.20
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.685624122619629, acc1 is 0.87890625, acc5 is 3.7109375, cma_loss is 13.23283576965332, uma_loss is 0.4527879059314728
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 13.62896728515625, acc1 is 0.5859375, acc5 is 3.076171875, cma_loss is 13.147770881652832, uma_loss is 0.48119592666625977
loss is 13.720760345458984, acc1 is 0.87890625, acc5 is 3.22265625, cma_loss is 13.237591743469238, uma_loss is 0.4831685423851013
loss is 13.541176795959473, acc1 is 0.927734375, acc5 is 3.564453125, cma_loss is 13.114167213439941, uma_loss is 0.42701002955436707
loss is 13.606786727905273, acc1 is 0.830078125, acc5 is 3.466796875, cma_loss is 13.130814552307129, uma_loss is 0.4759717583656311
loss is 13.654072761535645, acc1 is 0.68359375, acc5 is 3.41796875, cma_loss is 13.187012672424316, uma_loss is 0.46706005930900574
loss is 13.601240158081055, acc1 is 0.78125, acc5 is 3.02734375, cma_loss is 13.148253440856934, uma_loss is 0.45298629999160767
loss is 13.531452178955078, acc1 is 1.025390625, acc5 is 3.857421875, cma_loss is 13.08752727508545, uma_loss is 0.44392451643943787
loss is 13.5980224609375, acc1 is 1.025390625, acc5 is 3.759765625, cma_loss is 13.17799186706543, uma_loss is 0.4200303554534912
loss is 13.539026260375977, acc1 is 1.416015625, acc5 is 3.90625, cma_loss is 13.104835510253906, uma_loss is 0.434190958738327
loss is 13.513086318969727, acc1 is 1.025390625, acc5 is 4.00390625, cma_loss is 13.099266052246094, uma_loss is 0.4138202965259552
loss is 13.519699096679688, acc1 is 1.123046875, acc5 is 3.564453125, cma_loss is 13.095890045166016, uma_loss is 0.4238092303276062
loss is 13.475988388061523, acc1 is 0.87890625, acc5 is 3.857421875, cma_loss is 13.077234268188477, uma_loss is 0.3987542986869812
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 92.22it/s]
28 epoch loss is 1.6820562181018648,                                    acc1 is 0.927734375, acc5 is 3.571965144230769
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.10it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 137.76it/s]
-----------------------------------
The average AUROC is 46.9946
The AUROC of I313 is 38.90
The AUROC of I314 is 55.09
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 67.8198
The Specificity of I313 is 98.33
The Specificity of I314 is 37.31
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.81it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 57%|█████████████████████████                   | 29/51 [07:52<05:54, 16.12s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.9595
The AUROC of I27 is 53.69
The AUROC of I34 is 48.28
The AUROC of I35 is 48.65
The AUROC of I36 is 53.22
-----------------------------------
The average Sensitivity is 50.5840
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 35.40
The Sensitivity of I35 is 27.12
The Sensitivity of I36 is 69.23
-----------------------------------
The average Specificity is 62.9819
The Specificity of I27 is 53.29
The Specificity of I34 is 68.94
The Specificity of I35 is 78.72
The Specificity of I36 is 50.98
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.488107681274414, acc1 is 1.26953125, acc5 is 3.955078125, cma_loss is 13.070487022399902, uma_loss is 0.41762030124664307
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 13.460699081420898, acc1 is 1.171875, acc5 is 4.1015625, cma_loss is 13.044439315795898, uma_loss is 0.41625991463661194
loss is 13.53614330291748, acc1 is 1.07421875, acc5 is 2.734375, cma_loss is 13.127591133117676, uma_loss is 0.4085525870323181
loss is 13.352288246154785, acc1 is 1.3671875, acc5 is 4.19921875, cma_loss is 12.958694458007812, uma_loss is 0.39359337091445923
loss is 13.373017311096191, acc1 is 1.07421875, acc5 is 3.61328125, cma_loss is 12.973458290100098, uma_loss is 0.3995586335659027
loss is 13.509393692016602, acc1 is 0.830078125, acc5 is 4.052734375, cma_loss is 13.113828659057617, uma_loss is 0.3955647349357605
loss is 13.595114707946777, acc1 is 0.78125, acc5 is 3.369140625, cma_loss is 13.210461616516113, uma_loss is 0.3846527934074402
loss is 13.504931449890137, acc1 is 1.171875, acc5 is 3.955078125, cma_loss is 13.10303020477295, uma_loss is 0.4019008278846741
loss is 13.580208778381348, acc1 is 1.123046875, acc5 is 3.759765625, cma_loss is 13.172821998596191, uma_loss is 0.4073863923549652
loss is 13.514320373535156, acc1 is 1.171875, acc5 is 3.41796875, cma_loss is 13.112283706665039, uma_loss is 0.4020364582538605
loss is 13.423940658569336, acc1 is 1.318359375, acc5 is 4.443359375, cma_loss is 13.023894309997559, uma_loss is 0.4000461995601654
loss is 13.4552583694458, acc1 is 1.123046875, acc5 is 4.00390625, cma_loss is 13.0634126663208, uma_loss is 0.3918456435203552
loss is 13.509442329406738, acc1 is 1.025390625, acc5 is 4.39453125, cma_loss is 13.112679481506348, uma_loss is 0.39676254987716675
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 81.46it/s]
29 epoch loss is 1.6695511045910063,                                    acc1 is 1.1155348557692308, acc5 is 3.8461538461538463
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.77it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 134.15it/s]
-----------------------------------
The average AUROC is 51.5202
The AUROC of I313 is 41.60
The AUROC of I314 is 61.44
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 67.0810
The Specificity of I313 is 92.39
The Specificity of I314 is 41.77
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.78it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 59%|█████████████████████████▉                  | 30/51 [08:09<05:39, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.1694
The AUROC of I27 is 61.32
The AUROC of I34 is 51.64
The AUROC of I35 is 45.25
The AUROC of I36 is 50.46
-----------------------------------
The average Sensitivity is 55.2119
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 73.45
The Sensitivity of I35 is 1.69
The Sensitivity of I36 is 69.23
-----------------------------------
The average Specificity is 59.4808
The Specificity of I27 is 56.58
The Specificity of I34 is 35.22
The Specificity of I35 is 99.40
The Specificity of I36 is 46.73
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.488472938537598, acc1 is 1.171875, acc5 is 3.90625, cma_loss is 13.083466529846191, uma_loss is 0.4050068259239197
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.47s/it]
loss is 13.535299301147461, acc1 is 1.07421875, acc5 is 3.90625, cma_loss is 13.125764846801758, uma_loss is 0.4095340371131897
loss is 13.52015495300293, acc1 is 1.513671875, acc5 is 3.80859375, cma_loss is 13.136079788208008, uma_loss is 0.3840752840042114
loss is 13.401032447814941, acc1 is 1.26953125, acc5 is 4.6875, cma_loss is 12.99710464477539, uma_loss is 0.4039279818534851
loss is 13.341548919677734, acc1 is 1.46484375, acc5 is 4.638671875, cma_loss is 12.951099395751953, uma_loss is 0.390449196100235
loss is 13.455011367797852, acc1 is 1.3671875, acc5 is 3.90625, cma_loss is 13.075738906860352, uma_loss is 0.3792727291584015
loss is 13.530028343200684, acc1 is 1.07421875, acc5 is 3.271484375, cma_loss is 13.159940719604492, uma_loss is 0.37008771300315857
loss is 13.457320213317871, acc1 is 1.123046875, acc5 is 4.00390625, cma_loss is 13.065319061279297, uma_loss is 0.3920010030269623
loss is 13.53220272064209, acc1 is 1.318359375, acc5 is 4.39453125, cma_loss is 13.148154258728027, uma_loss is 0.3840484023094177
loss is 13.486760139465332, acc1 is 1.123046875, acc5 is 3.80859375, cma_loss is 13.104836463928223, uma_loss is 0.3819236755371094
loss is 13.374176979064941, acc1 is 1.318359375, acc5 is 4.248046875, cma_loss is 12.986923217773438, uma_loss is 0.38725343346595764
loss is 13.340453147888184, acc1 is 1.611328125, acc5 is 4.98046875, cma_loss is 12.95536994934082, uma_loss is 0.38508328795433044
loss is 13.438140869140625, acc1 is 1.5625, acc5 is 4.39453125, cma_loss is 13.037694931030273, uma_loss is 0.40044552087783813
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 76.42it/s]
30 epoch loss is 1.6657200222923643,                                    acc1 is 1.3070913461538463, acc5 is 4.150390625
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.88it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 148.19it/s]
-----------------------------------
The average AUROC is 47.2637
The AUROC of I313 is 45.19
The AUROC of I314 is 49.33
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 68.5101
The Specificity of I313 is 89.12
The Specificity of I314 is 47.90
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.85it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 61%|██████████████████████████▋                 | 31/51 [08:25<05:22, 16.12s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.9703
The AUROC of I27 is 53.08
The AUROC of I34 is 46.61
The AUROC of I35 is 48.22
The AUROC of I36 is 51.97
-----------------------------------
The average Sensitivity is 73.4736
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 98.23
The Sensitivity of I35 is 32.77
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 38.1442
The Specificity of I27 is 48.66
The Specificity of I34 is 6.17
The Specificity of I35 is 72.63
The Specificity of I36 is 25.12
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.401604652404785, acc1 is 1.26953125, acc5 is 3.857421875, cma_loss is 13.001288414001465, uma_loss is 0.40031617879867554
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 13.378483772277832, acc1 is 1.318359375, acc5 is 4.98046875, cma_loss is 12.987018585205078, uma_loss is 0.39146488904953003
loss is 13.415145874023438, acc1 is 1.46484375, acc5 is 4.00390625, cma_loss is 13.047043800354004, uma_loss is 0.36810168623924255
loss is 13.266592979431152, acc1 is 1.904296875, acc5 is 5.712890625, cma_loss is 12.891642570495605, uma_loss is 0.37494996190071106
loss is 13.340047836303711, acc1 is 1.46484375, acc5 is 5.126953125, cma_loss is 12.949946403503418, uma_loss is 0.3901015818119049
loss is 13.348509788513184, acc1 is 1.611328125, acc5 is 4.8828125, cma_loss is 12.971378326416016, uma_loss is 0.37713104486465454
loss is 13.357063293457031, acc1 is 1.46484375, acc5 is 4.296875, cma_loss is 12.982182502746582, uma_loss is 0.3748810291290283
loss is 13.381610870361328, acc1 is 1.318359375, acc5 is 4.296875, cma_loss is 12.98076057434082, uma_loss is 0.4008500277996063
loss is 13.405921936035156, acc1 is 1.3671875, acc5 is 5.126953125, cma_loss is 13.042405128479004, uma_loss is 0.36351698637008667
loss is 13.347146987915039, acc1 is 1.904296875, acc5 is 4.931640625, cma_loss is 12.976959228515625, uma_loss is 0.37018802762031555
loss is 13.244457244873047, acc1 is 1.26953125, acc5 is 4.8828125, cma_loss is 12.884249687194824, uma_loss is 0.3602072596549988
loss is 13.205191612243652, acc1 is 1.708984375, acc5 is 4.541015625, cma_loss is 12.836230278015137, uma_loss is 0.368960976600647
loss is 13.287165641784668, acc1 is 1.708984375, acc5 is 5.17578125, cma_loss is 12.910645484924316, uma_loss is 0.3765198588371277
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 44.86it/s]
31 epoch loss is 1.651228023710705,                                    acc1 is 1.5211838942307692, acc5 is 4.755108173076923
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.82it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 141.91it/s]
-----------------------------------
The average AUROC is 43.2144
The AUROC of I313 is 37.69
The AUROC of I314 is 48.73
-----------------------------------
The average Sensitivity is 55.5556
The Sensitivity of I313 is 11.11
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 65.7893
The Specificity of I313 is 99.87
The Specificity of I314 is 31.71
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.76it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 63%|███████████████████████████▌                | 32/51 [08:41<05:05, 16.07s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.1312
The AUROC of I27 is 46.67
The AUROC of I34 is 45.50
The AUROC of I35 is 51.59
The AUROC of I36 is 48.76
-----------------------------------
The average Sensitivity is 71.4046
The Sensitivity of I27 is 82.35
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 31.07
The Sensitivity of I36 is 73.08
-----------------------------------
The average Specificity is 39.4385
The Specificity of I27 is 27.25
The Specificity of I34 is 2.44
The Specificity of I35 is 79.25
The Specificity of I36 is 48.82
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.1962890625, acc1 is 1.708984375, acc5 is 5.078125, cma_loss is 12.822723388671875, uma_loss is 0.3735656142234802
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 13.260968208312988, acc1 is 1.416015625, acc5 is 4.19921875, cma_loss is 12.893491744995117, uma_loss is 0.36747676134109497
loss is 13.363727569580078, acc1 is 1.26953125, acc5 is 4.931640625, cma_loss is 13.016525268554688, uma_loss is 0.347201943397522
loss is 13.299115180969238, acc1 is 1.5625, acc5 is 5.712890625, cma_loss is 12.940536499023438, uma_loss is 0.3585783839225769
loss is 13.25770092010498, acc1 is 1.513671875, acc5 is 4.8828125, cma_loss is 12.881251335144043, uma_loss is 0.37644922733306885
loss is 13.293867111206055, acc1 is 1.708984375, acc5 is 5.419921875, cma_loss is 12.957046508789062, uma_loss is 0.3368210792541504
loss is 13.408217430114746, acc1 is 1.611328125, acc5 is 3.955078125, cma_loss is 13.029257774353027, uma_loss is 0.3789592385292053
loss is 13.31868839263916, acc1 is 1.46484375, acc5 is 4.638671875, cma_loss is 12.95619010925293, uma_loss is 0.3624979853630066
loss is 13.360447883605957, acc1 is 1.7578125, acc5 is 5.224609375, cma_loss is 12.973396301269531, uma_loss is 0.38705188035964966
loss is 13.264554023742676, acc1 is 1.513671875, acc5 is 4.98046875, cma_loss is 12.895918846130371, uma_loss is 0.3686356246471405
loss is 13.280983924865723, acc1 is 1.66015625, acc5 is 5.46875, cma_loss is 12.912875175476074, uma_loss is 0.36810871958732605
loss is 13.323359489440918, acc1 is 1.46484375, acc5 is 4.4921875, cma_loss is 12.95256233215332, uma_loss is 0.3707967698574066
loss is 13.272246360778809, acc1 is 1.5625, acc5 is 5.078125, cma_loss is 12.909259796142578, uma_loss is 0.3629864454269409
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 75.06it/s]
32 epoch loss is 1.6466682434082032,                                    acc1 is 1.5549879807692308, acc5 is 4.927884615384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.97it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 134.98it/s]
-----------------------------------
The average AUROC is 40.7310
The AUROC of I313 is 39.65
The AUROC of I314 is 41.82
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 25.8007
The Specificity of I313 is 17.89
The Specificity of I314 is 33.71
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.78it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 65%|████████████████████████████▍               | 33/51 [08:57<04:48, 16.04s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.3816
The AUROC of I27 is 56.83
The AUROC of I34 is 41.53
The AUROC of I35 is 53.85
The AUROC of I36 is 49.31
-----------------------------------
The average Sensitivity is 77.3601
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 72.32
The Sensitivity of I36 is 61.54
-----------------------------------
The average Specificity is 36.8008
The Specificity of I27 is 51.74
The Specificity of I34 is 4.59
The Specificity of I35 is 36.92
The Specificity of I36 is 53.95
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.224383354187012, acc1 is 1.806640625, acc5 is 6.34765625, cma_loss is 12.856563568115234, uma_loss is 0.36782020330429077
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.24it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 13.18214225769043, acc1 is 1.611328125, acc5 is 5.2734375, cma_loss is 12.807744979858398, uma_loss is 0.374396950006485
loss is 13.285470962524414, acc1 is 1.46484375, acc5 is 5.517578125, cma_loss is 12.932056427001953, uma_loss is 0.35341447591781616
loss is 13.082971572875977, acc1 is 2.294921875, acc5 is 5.322265625, cma_loss is 12.743002891540527, uma_loss is 0.3399682641029358
loss is 13.053611755371094, acc1 is 2.24609375, acc5 is 6.201171875, cma_loss is 12.706128120422363, uma_loss is 0.3474833071231842
loss is 13.173975944519043, acc1 is 1.7578125, acc5 is 5.322265625, cma_loss is 12.823031425476074, uma_loss is 0.3509448766708374
loss is 13.267011642456055, acc1 is 1.953125, acc5 is 4.8828125, cma_loss is 12.918966293334961, uma_loss is 0.3480449318885803
loss is 13.196914672851562, acc1 is 2.099609375, acc5 is 5.17578125, cma_loss is 12.825743675231934, uma_loss is 0.3711705207824707
loss is 13.23246955871582, acc1 is 1.904296875, acc5 is 5.810546875, cma_loss is 12.877206802368164, uma_loss is 0.3552628457546234
loss is 13.211471557617188, acc1 is 1.7578125, acc5 is 4.833984375, cma_loss is 12.862386703491211, uma_loss is 0.3490845561027527
loss is 13.185596466064453, acc1 is 1.318359375, acc5 is 5.615234375, cma_loss is 12.848429679870605, uma_loss is 0.3371668756008148
loss is 13.13736343383789, acc1 is 2.1484375, acc5 is 6.640625, cma_loss is 12.802833557128906, uma_loss is 0.3345295488834381
loss is 13.239235877990723, acc1 is 1.806640625, acc5 is 4.736328125, cma_loss is 12.892818450927734, uma_loss is 0.34641721844673157
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 73.47it/s]
33 epoch loss is 1.6330725624447777,                                    acc1 is 1.8592247596153846, acc5 is 5.513822115384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.93it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 144.66it/s]
-----------------------------------
The average AUROC is 37.3890
The AUROC of I313 is 39.82
The AUROC of I314 is 34.95
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 19.6278
The Specificity of I313 is 7.54
The Specificity of I314 is 31.71
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.92it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 67%|█████████████████████████████▎              | 34/51 [09:13<04:33, 16.07s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.4137
The AUROC of I27 is 43.60
The AUROC of I34 is 43.72
The AUROC of I35 is 55.61
The AUROC of I36 is 46.73
-----------------------------------
The average Sensitivity is 60.7925
The Sensitivity of I27 is 11.76
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 55.37
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 48.4990
The Specificity of I27 is 97.58
The Specificity of I34 is 4.38
The Specificity of I35 is 56.99
The Specificity of I36 is 35.04
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.075017929077148, acc1 is 1.806640625, acc5 is 6.396484375, cma_loss is 12.735795974731445, uma_loss is 0.33922192454338074
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.16it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.58s/it]
loss is 13.156352043151855, acc1 is 1.5625, acc5 is 5.712890625, cma_loss is 12.797059059143066, uma_loss is 0.35929304361343384
loss is 13.256575584411621, acc1 is 1.904296875, acc5 is 5.810546875, cma_loss is 12.913942337036133, uma_loss is 0.3426330089569092
loss is 13.10958480834961, acc1 is 1.953125, acc5 is 6.4453125, cma_loss is 12.76885986328125, uma_loss is 0.340724915266037
loss is 13.002649307250977, acc1 is 2.197265625, acc5 is 5.859375, cma_loss is 12.663019180297852, uma_loss is 0.33963024616241455
loss is 13.236621856689453, acc1 is 1.806640625, acc5 is 5.56640625, cma_loss is 12.906336784362793, uma_loss is 0.33028465509414673
loss is 13.344746589660645, acc1 is 1.3671875, acc5 is 5.029296875, cma_loss is 12.956589698791504, uma_loss is 0.38815686106681824
loss is 13.23304557800293, acc1 is 1.3671875, acc5 is 5.126953125, cma_loss is 12.823905944824219, uma_loss is 0.40914008021354675
loss is 13.249300956726074, acc1 is 1.7578125, acc5 is 5.712890625, cma_loss is 12.873120307922363, uma_loss is 0.3761802315711975
loss is 13.20893383026123, acc1 is 1.7578125, acc5 is 4.78515625, cma_loss is 12.829781532287598, uma_loss is 0.3791520297527313
loss is 13.266287803649902, acc1 is 1.7578125, acc5 is 5.712890625, cma_loss is 12.919517517089844, uma_loss is 0.34677067399024963
loss is 13.200109481811523, acc1 is 2.1484375, acc5 is 6.4453125, cma_loss is 12.783171653747559, uma_loss is 0.4169376790523529
loss is 13.20621395111084, acc1 is 1.611328125, acc5 is 5.029296875, cma_loss is 12.862299919128418, uma_loss is 0.3439141809940338
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 56.20it/s]
34 epoch loss is 1.6337660925728934,                                    acc1 is 1.7690805288461537, acc5 is 5.6640625
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.68it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|██████████████████████████████████████████████| 4/4 [00:00<00:00, 86.85it/s]
-----------------------------------
The average AUROC is 42.1774
The AUROC of I313 is 38.87
The AUROC of I314 is 45.48
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 66.1110
The Specificity of I313 is 88.45
The Specificity of I314 is 43.77
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.81it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 69%|██████████████████████████████▏             | 35/51 [09:29<04:19, 16.19s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.0198
The AUROC of I27 is 57.15
The AUROC of I34 is 44.40
The AUROC of I35 is 62.45
The AUROC of I36 is 40.09
-----------------------------------
The average Sensitivity is 78.0702
The Sensitivity of I27 is 82.35
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 61.58
The Sensitivity of I36 is 69.23
-----------------------------------
The average Specificity is 35.4093
The Specificity of I27 is 41.54
The Specificity of I34 is 2.65
The Specificity of I35 is 60.98
The Specificity of I36 is 36.46
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 13.08293628692627, acc1 is 2.05078125, acc5 is 6.73828125, cma_loss is 12.716089248657227, uma_loss is 0.36684685945510864
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 13.111807823181152, acc1 is 2.490234375, acc5 is 6.34765625, cma_loss is 12.75043773651123, uma_loss is 0.3613698482513428
loss is 13.163515090942383, acc1 is 1.85546875, acc5 is 6.25, cma_loss is 12.788582801818848, uma_loss is 0.3749324679374695
loss is 13.097882270812988, acc1 is 2.099609375, acc5 is 6.103515625, cma_loss is 12.74011516571045, uma_loss is 0.3577670454978943
loss is 13.00002670288086, acc1 is 2.490234375, acc5 is 6.884765625, cma_loss is 12.65598201751709, uma_loss is 0.3440450429916382
loss is 13.095940589904785, acc1 is 1.953125, acc5 is 6.4453125, cma_loss is 12.752218246459961, uma_loss is 0.3437223434448242
loss is 13.059513092041016, acc1 is 1.708984375, acc5 is 6.201171875, cma_loss is 12.740036964416504, uma_loss is 0.31947657465934753
loss is 13.27098560333252, acc1 is 1.5625, acc5 is 5.17578125, cma_loss is 12.912232398986816, uma_loss is 0.35875290632247925
loss is 13.18568229675293, acc1 is 1.46484375, acc5 is 5.56640625, cma_loss is 12.843399047851562, uma_loss is 0.34228309988975525
loss is 13.119861602783203, acc1 is 2.099609375, acc5 is 5.517578125, cma_loss is 12.785093307495117, uma_loss is 0.33476877212524414
loss is 13.059024810791016, acc1 is 2.1484375, acc5 is 6.591796875, cma_loss is 12.704656600952148, uma_loss is 0.3543679714202881
loss is 13.12562084197998, acc1 is 1.85546875, acc5 is 5.859375, cma_loss is 12.786171913146973, uma_loss is 0.33944928646087646
loss is 13.073982238769531, acc1 is 1.3671875, acc5 is 5.56640625, cma_loss is 12.744606018066406, uma_loss is 0.3293757736682892
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 123.21it/s]
35 epoch loss is 1.6233026595342728,                                    acc1 is 1.9343449519230769, acc5 is 6.096003605769231
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.62it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 151.84it/s]
-----------------------------------
The average AUROC is 33.4477
The AUROC of I313 is 32.96
The AUROC of I314 is 33.93
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 20.7637
The Specificity of I313 is 10.88
The Specificity of I314 is 30.65
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.74it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 71%|███████████████████████████████             | 36/51 [09:46<04:03, 16.23s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.4276
The AUROC of I27 is 42.06
The AUROC of I34 is 45.79
The AUROC of I35 is 62.75
The AUROC of I36 is 43.12
-----------------------------------
The average Sensitivity is 63.4777
The Sensitivity of I27 is 5.88
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 60.45
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 46.2529
The Specificity of I27 is 98.66
The Specificity of I34 is 3.80
The Specificity of I35 is 63.31
The Specificity of I36 is 19.24
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.93874740600586, acc1 is 2.001953125, acc5 is 7.177734375, cma_loss is 12.60371208190918, uma_loss is 0.335035502910614
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.11it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 12.984641075134277, acc1 is 1.904296875, acc5 is 6.201171875, cma_loss is 12.649103164672852, uma_loss is 0.33553823828697205
loss is 13.039188385009766, acc1 is 2.63671875, acc5 is 6.689453125, cma_loss is 12.707763671875, uma_loss is 0.33142468333244324
loss is 12.919848442077637, acc1 is 2.44140625, acc5 is 7.51953125, cma_loss is 12.586151123046875, uma_loss is 0.3336976170539856
loss is 12.912047386169434, acc1 is 2.880859375, acc5 is 7.71484375, cma_loss is 12.588027000427246, uma_loss is 0.32402029633522034
loss is 13.10215950012207, acc1 is 2.1484375, acc5 is 6.73828125, cma_loss is 12.772806167602539, uma_loss is 0.32935360074043274
loss is 12.993424415588379, acc1 is 1.953125, acc5 is 6.0546875, cma_loss is 12.685836791992188, uma_loss is 0.30758726596832275
loss is 13.003824234008789, acc1 is 2.34375, acc5 is 6.640625, cma_loss is 12.677456855773926, uma_loss is 0.3263676166534424
loss is 12.966470718383789, acc1 is 2.5390625, acc5 is 6.884765625, cma_loss is 12.650650978088379, uma_loss is 0.31582003831863403
loss is 12.95988941192627, acc1 is 1.904296875, acc5 is 6.591796875, cma_loss is 12.647079467773438, uma_loss is 0.31280991435050964
loss is 12.941752433776855, acc1 is 2.34375, acc5 is 6.93359375, cma_loss is 12.617208480834961, uma_loss is 0.3245435953140259
loss is 12.96461296081543, acc1 is 2.978515625, acc5 is 6.8359375, cma_loss is 12.67151927947998, uma_loss is 0.2930939197540283
loss is 12.96440315246582, acc1 is 2.392578125, acc5 is 6.0546875, cma_loss is 12.639995574951172, uma_loss is 0.3244076669216156
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 118.71it/s]
36 epoch loss is 1.606581043061756,                                    acc1 is 2.34375, acc5 is 6.772085336538462
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.89it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 162.71it/s]
-----------------------------------
The average AUROC is 37.6536
The AUROC of I313 is 45.39
The AUROC of I314 is 29.91
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 16.8323
The Specificity of I313 is 10.21
The Specificity of I314 is 23.45
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.79it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 73%|███████████████████████████████▉            | 37/51 [10:02<03:46, 16.20s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.7325
The AUROC of I27 is 35.20
The AUROC of I34 is 47.33
The AUROC of I35 is 62.33
The AUROC of I36 is 42.06
-----------------------------------
The average Sensitivity is 87.6350
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 98.23
The Sensitivity of I35 is 58.19
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 21.2075
The Specificity of I27 is 11.68
The Specificity of I34 is 5.16
The Specificity of I35 is 62.18
The Specificity of I36 is 5.81
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.827201843261719, acc1 is 2.099609375, acc5 is 7.177734375, cma_loss is 12.524639129638672, uma_loss is 0.30256304144859314
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.53s/it]
loss is 12.857105255126953, acc1 is 2.783203125, acc5 is 7.12890625, cma_loss is 12.543633460998535, uma_loss is 0.31347188353538513
loss is 12.969979286193848, acc1 is 1.85546875, acc5 is 6.494140625, cma_loss is 12.652005195617676, uma_loss is 0.31797415018081665
loss is 12.881118774414062, acc1 is 2.490234375, acc5 is 6.8359375, cma_loss is 12.568009376525879, uma_loss is 0.31310924887657166
loss is 12.837478637695312, acc1 is 2.685546875, acc5 is 7.8125, cma_loss is 12.53110122680664, uma_loss is 0.3063770830631256
loss is 12.91641616821289, acc1 is 2.587890625, acc5 is 7.958984375, cma_loss is 12.603822708129883, uma_loss is 0.3125936985015869
loss is 12.989542007446289, acc1 is 2.490234375, acc5 is 6.0546875, cma_loss is 12.679109573364258, uma_loss is 0.31043246388435364
loss is 12.869865417480469, acc1 is 2.587890625, acc5 is 6.884765625, cma_loss is 12.555900573730469, uma_loss is 0.3139645755290985
loss is 12.877554893493652, acc1 is 2.685546875, acc5 is 7.8125, cma_loss is 12.562017440795898, uma_loss is 0.31553757190704346
loss is 12.88416576385498, acc1 is 2.197265625, acc5 is 6.73828125, cma_loss is 12.583064079284668, uma_loss is 0.3011021316051483
loss is 12.84701919555664, acc1 is 2.978515625, acc5 is 8.056640625, cma_loss is 12.514812469482422, uma_loss is 0.33220645785331726
loss is 12.821954727172852, acc1 is 2.685546875, acc5 is 7.861328125, cma_loss is 12.522284507751465, uma_loss is 0.2996699810028076
loss is 12.911927223205566, acc1 is 2.5390625, acc5 is 7.03125, cma_loss is 12.565835952758789, uma_loss is 0.34609130024909973
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 65.32it/s]
37 epoch loss is 1.595155516124907,                                    acc1 is 2.5127704326923075, acc5 is 7.219050480769231
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.84it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 131.00it/s]
-----------------------------------
The average AUROC is 18.3656
The AUROC of I313 is 29.67
The AUROC of I314 is 7.06
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 6.5711
The Specificity of I313 is 8.81
The Specificity of I314 is 4.33
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.81it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 75%|████████████████████████████████▊           | 38/51 [10:18<03:30, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.1604
The AUROC of I27 is 48.41
The AUROC of I34 is 49.44
The AUROC of I35 is 57.79
The AUROC of I36 is 45.01
-----------------------------------
The average Sensitivity is 65.0337
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 38.94
The Sensitivity of I35 is 62.15
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 45.6013
The Specificity of I27 is 40.94
The Specificity of I34 is 67.29
The Specificity of I35 is 52.03
The Specificity of I36 is 22.15
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.862401008605957, acc1 is 2.294921875, acc5 is 7.6171875, cma_loss is 12.54621696472168, uma_loss is 0.3161843419075012
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 12.870323181152344, acc1 is 2.734375, acc5 is 7.861328125, cma_loss is 12.53472900390625, uma_loss is 0.33559373021125793
loss is 12.872802734375, acc1 is 2.490234375, acc5 is 7.568359375, cma_loss is 12.550433158874512, uma_loss is 0.32236915826797485
loss is 12.735665321350098, acc1 is 3.22265625, acc5 is 8.88671875, cma_loss is 12.418034553527832, uma_loss is 0.3176303505897522
loss is 12.646787643432617, acc1 is 3.271484375, acc5 is 9.1796875, cma_loss is 12.333820343017578, uma_loss is 0.3129677474498749
loss is 12.802451133728027, acc1 is 3.076171875, acc5 is 8.203125, cma_loss is 12.496326446533203, uma_loss is 0.30612438917160034
loss is 12.886574745178223, acc1 is 2.24609375, acc5 is 6.689453125, cma_loss is 12.568300247192383, uma_loss is 0.3182741105556488
loss is 12.843260765075684, acc1 is 2.587890625, acc5 is 7.763671875, cma_loss is 12.540310859680176, uma_loss is 0.30295026302337646
loss is 12.779717445373535, acc1 is 3.125, acc5 is 9.9609375, cma_loss is 12.461387634277344, uma_loss is 0.318329393863678
loss is 12.834900856018066, acc1 is 2.63671875, acc5 is 7.6171875, cma_loss is 12.507953643798828, uma_loss is 0.32694706320762634
loss is 12.776947021484375, acc1 is 2.9296875, acc5 is 7.8125, cma_loss is 12.45848274230957, uma_loss is 0.31846392154693604
loss is 12.832558631896973, acc1 is 2.734375, acc5 is 8.056640625, cma_loss is 12.531684875488281, uma_loss is 0.3008733093738556
loss is 12.814778327941895, acc1 is 2.734375, acc5 is 7.8125, cma_loss is 12.509870529174805, uma_loss is 0.30490759015083313
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 76.09it/s]
38 epoch loss is 1.5862777982439313,                                    acc1 is 2.775691105769231, acc5 is 8.079176682692308
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.01it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 139.68it/s]
-----------------------------------
The average AUROC is 20.4509
The AUROC of I313 is 18.22
The AUROC of I314 is 22.68
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 10.9660
The Specificity of I313 is 6.61
The Specificity of I314 is 15.32
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.73it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 76%|█████████████████████████████████▋          | 39/51 [10:34<03:13, 16.14s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.7896
The AUROC of I27 is 39.05
The AUROC of I34 is 49.06
The AUROC of I35 is 56.34
The AUROC of I36 is 46.70
-----------------------------------
The average Sensitivity is 74.7449
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 91.15
The Sensitivity of I35 is 79.10
The Sensitivity of I36 is 34.62
-----------------------------------
The average Specificity is 33.8592
The Specificity of I27 is 16.04
The Specificity of I34 is 14.20
The Specificity of I35 is 35.04
The Specificity of I36 is 70.16
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.772053718566895, acc1 is 2.9296875, acc5 is 8.7890625, cma_loss is 12.43643569946289, uma_loss is 0.3356177806854248
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 12.816810607910156, acc1 is 3.076171875, acc5 is 7.91015625, cma_loss is 12.474390029907227, uma_loss is 0.34242063760757446
loss is 12.917594909667969, acc1 is 2.685546875, acc5 is 7.12890625, cma_loss is 12.577938079833984, uma_loss is 0.33965635299682617
loss is 12.678044319152832, acc1 is 2.685546875, acc5 is 7.958984375, cma_loss is 12.36822509765625, uma_loss is 0.30981940031051636
loss is 12.594263076782227, acc1 is 3.61328125, acc5 is 10.693359375, cma_loss is 12.260997772216797, uma_loss is 0.333265483379364
loss is 12.749244689941406, acc1 is 3.515625, acc5 is 8.544921875, cma_loss is 12.424729347229004, uma_loss is 0.32451575994491577
loss is 12.788806915283203, acc1 is 2.685546875, acc5 is 8.88671875, cma_loss is 12.471639633178711, uma_loss is 0.31716713309288025
loss is 12.758550643920898, acc1 is 3.22265625, acc5 is 8.59375, cma_loss is 12.443371772766113, uma_loss is 0.3151791989803314
loss is 12.76689338684082, acc1 is 3.515625, acc5 is 9.375, cma_loss is 12.445060729980469, uma_loss is 0.32183244824409485
loss is 12.753429412841797, acc1 is 3.271484375, acc5 is 8.349609375, cma_loss is 12.424555778503418, uma_loss is 0.3288733661174774
loss is 12.684383392333984, acc1 is 2.9296875, acc5 is 10.15625, cma_loss is 12.365846633911133, uma_loss is 0.3185369372367859
loss is 12.73499870300293, acc1 is 3.076171875, acc5 is 8.59375, cma_loss is 12.423823356628418, uma_loss is 0.3111751675605774
loss is 12.801804542541504, acc1 is 2.490234375, acc5 is 7.958984375, cma_loss is 12.501699447631836, uma_loss is 0.30010485649108887
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 61.28it/s]
39 epoch loss is 1.579208364940825,                                    acc1 is 3.0536358173076925, acc5 is 8.687650240384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.73it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 134.50it/s]
-----------------------------------
The average AUROC is 21.8061
The AUROC of I313 is 28.02
The AUROC of I314 is 15.59
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 6.8645
The Specificity of I313 is 2.40
The Specificity of I314 is 11.33
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.67it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 78%|██████████████████████████████████▌         | 40/51 [10:50<02:58, 16.22s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.4482
The AUROC of I27 is 36.60
The AUROC of I34 is 46.70
The AUROC of I35 is 50.55
The AUROC of I36 is 43.94
-----------------------------------
The average Sensitivity is 92.3775
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 98.23
The Sensitivity of I35 is 88.70
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 12.6973
The Specificity of I27 is 8.19
The Specificity of I34 is 5.45
The Specificity of I35 is 16.02
The Specificity of I36 is 21.13
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.617759704589844, acc1 is 3.61328125, acc5 is 9.27734375, cma_loss is 12.305898666381836, uma_loss is 0.3118610978126526
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.15it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.67s/it]
loss is 12.559335708618164, acc1 is 3.80859375, acc5 is 10.400390625, cma_loss is 12.255621910095215, uma_loss is 0.30371397733688354
loss is 12.718039512634277, acc1 is 3.076171875, acc5 is 9.130859375, cma_loss is 12.404129028320312, uma_loss is 0.31391090154647827
loss is 12.547651290893555, acc1 is 3.90625, acc5 is 9.765625, cma_loss is 12.249866485595703, uma_loss is 0.2977849245071411
loss is 12.59110164642334, acc1 is 4.58984375, acc5 is 10.05859375, cma_loss is 12.288841247558594, uma_loss is 0.3022603988647461
loss is 12.847386360168457, acc1 is 3.173828125, acc5 is 8.544921875, cma_loss is 12.536480903625488, uma_loss is 0.31090566515922546
loss is 12.811752319335938, acc1 is 3.271484375, acc5 is 8.447265625, cma_loss is 12.4747953414917, uma_loss is 0.3369573652744293
loss is 12.668196678161621, acc1 is 3.857421875, acc5 is 9.47265625, cma_loss is 12.35372257232666, uma_loss is 0.31447455286979675
loss is 12.618620872497559, acc1 is 3.7109375, acc5 is 9.326171875, cma_loss is 12.284676551818848, uma_loss is 0.3339442014694214
loss is 12.699971199035645, acc1 is 3.22265625, acc5 is 8.203125, cma_loss is 12.382097244262695, uma_loss is 0.31787389516830444
loss is 12.625309944152832, acc1 is 2.9296875, acc5 is 9.326171875, cma_loss is 12.300721168518066, uma_loss is 0.3245890438556671
loss is 12.680660247802734, acc1 is 2.83203125, acc5 is 8.88671875, cma_loss is 12.372687339782715, uma_loss is 0.30797260999679565
loss is 12.720839500427246, acc1 is 2.978515625, acc5 is 8.251953125, cma_loss is 12.407763481140137, uma_loss is 0.3130760192871094
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 73.91it/s]
40 epoch loss is 1.568634523664202,                                    acc1 is 3.459284855769231, acc5 is 9.160907451923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.66it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 132.05it/s]
-----------------------------------
The average AUROC is 30.7140
The AUROC of I313 is 23.32
The AUROC of I314 is 38.11
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.7925
The Specificity of I313 is 1.07
The Specificity of I314 is 24.52
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.76it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 80%|███████████████████████████████████▎        | 41/51 [11:07<02:42, 16.24s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.6303
The AUROC of I27 is 43.13
The AUROC of I34 is 44.51
The AUROC of I35 is 55.55
The AUROC of I36 is 55.33
-----------------------------------
The average Sensitivity is 82.3634
The Sensitivity of I27 is 76.47
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 80.79
The Sensitivity of I36 is 73.08
-----------------------------------
The average Specificity is 29.7275
The Specificity of I27 is 30.34
The Specificity of I34 is 5.16
The Specificity of I35 is 33.31
The Specificity of I36 is 50.10
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.511236190795898, acc1 is 3.61328125, acc5 is 10.3515625, cma_loss is 12.197198867797852, uma_loss is 0.31403759121894836
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.14it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 12.567770957946777, acc1 is 3.759765625, acc5 is 10.25390625, cma_loss is 12.250897407531738, uma_loss is 0.31687334179878235
loss is 12.559332847595215, acc1 is 3.857421875, acc5 is 9.9609375, cma_loss is 12.258633613586426, uma_loss is 0.3006996512413025
loss is 12.479736328125, acc1 is 3.7109375, acc5 is 9.326171875, cma_loss is 12.171135902404785, uma_loss is 0.3086008131504059
loss is 12.376871109008789, acc1 is 5.224609375, acc5 is 11.865234375, cma_loss is 12.063647270202637, uma_loss is 0.3132241666316986
loss is 12.530397415161133, acc1 is 3.61328125, acc5 is 10.205078125, cma_loss is 12.236913681030273, uma_loss is 0.2934834361076355
loss is 12.704389572143555, acc1 is 3.02734375, acc5 is 8.7890625, cma_loss is 12.40740966796875, uma_loss is 0.2969802916049957
loss is 12.626347541809082, acc1 is 3.857421875, acc5 is 8.740234375, cma_loss is 12.31412124633789, uma_loss is 0.3122260570526123
loss is 12.405988693237305, acc1 is 4.296875, acc5 is 11.62109375, cma_loss is 12.10262393951416, uma_loss is 0.30336427688598633
loss is 12.577813148498535, acc1 is 2.83203125, acc5 is 8.447265625, cma_loss is 12.276707649230957, uma_loss is 0.3011054992675781
loss is 12.62385368347168, acc1 is 3.3203125, acc5 is 9.326171875, cma_loss is 12.308320999145508, uma_loss is 0.3155326247215271
loss is 12.582305908203125, acc1 is 2.9296875, acc5 is 9.9609375, cma_loss is 12.269793510437012, uma_loss is 0.3125123977661133
loss is 12.67408561706543, acc1 is 3.173828125, acc5 is 8.642578125, cma_loss is 12.359434127807617, uma_loss is 0.3146512508392334
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 80.50it/s]
41 epoch loss is 1.5544774191720145,                                    acc1 is 3.632061298076923, acc5 is 9.80694110576923
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.63it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 135.73it/s]
-----------------------------------
The average AUROC is 31.9558
The AUROC of I313 is 34.50
The AUROC of I314 is 29.41
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 8.1971
The Specificity of I313 is 2.54
The Specificity of I314 is 13.86
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.63it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 82%|████████████████████████████████████▏       | 42/51 [11:23<02:25, 16.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.0294
The AUROC of I27 is 32.16
The AUROC of I34 is 43.94
The AUROC of I35 is 54.41
The AUROC of I36 is 53.60
-----------------------------------
The average Sensitivity is 61.4372
The Sensitivity of I27 is 5.88
The Sensitivity of I34 is 94.69
The Sensitivity of I35 is 64.41
The Sensitivity of I36 is 80.77
-----------------------------------
The average Specificity is 47.9883
The Specificity of I27 is 98.26
The Specificity of I34 is 7.25
The Specificity of I35 is 45.94
The Specificity of I36 is 40.51
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.440550804138184, acc1 is 3.369140625, acc5 is 10.64453125, cma_loss is 12.097232818603516, uma_loss is 0.3433179259300232
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.20it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 12.539983749389648, acc1 is 4.296875, acc5 is 9.86328125, cma_loss is 12.210347175598145, uma_loss is 0.32963642477989197
loss is 12.463451385498047, acc1 is 3.90625, acc5 is 10.64453125, cma_loss is 12.151494979858398, uma_loss is 0.3119564950466156
loss is 12.276237487792969, acc1 is 4.78515625, acc5 is 12.548828125, cma_loss is 11.961456298828125, uma_loss is 0.3147813677787781
loss is 12.321022033691406, acc1 is 4.638671875, acc5 is 12.20703125, cma_loss is 12.001565933227539, uma_loss is 0.31945574283599854
loss is 12.42330265045166, acc1 is 4.296875, acc5 is 10.83984375, cma_loss is 12.104438781738281, uma_loss is 0.31886351108551025
loss is 12.519388198852539, acc1 is 3.369140625, acc5 is 9.228515625, cma_loss is 12.224167823791504, uma_loss is 0.29522085189819336
loss is 12.550846099853516, acc1 is 4.443359375, acc5 is 10.009765625, cma_loss is 12.22118091583252, uma_loss is 0.3296647071838379
loss is 12.46146297454834, acc1 is 4.736328125, acc5 is 11.1328125, cma_loss is 12.143842697143555, uma_loss is 0.31762057542800903
loss is 12.485523223876953, acc1 is 3.955078125, acc5 is 10.107421875, cma_loss is 12.158190727233887, uma_loss is 0.3273327648639679
loss is 12.430052757263184, acc1 is 4.1015625, acc5 is 10.205078125, cma_loss is 12.111802101135254, uma_loss is 0.3182510733604431
loss is 12.486422538757324, acc1 is 3.90625, acc5 is 10.25390625, cma_loss is 12.20450210571289, uma_loss is 0.28192073106765747
loss is 12.44333267211914, acc1 is 3.857421875, acc5 is 10.44921875, cma_loss is 12.133066177368164, uma_loss is 0.3102664649486542
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 114.86it/s]
42 epoch loss is 1.5413483483450754,                                    acc1 is 4.1278545673076925, acc5 is 10.625751201923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 151.94it/s]
-----------------------------------
The average AUROC is 40.4965
The AUROC of I313 is 56.79
The AUROC of I314 is 24.21
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 35.4314
The Specificity of I313 is 55.01
The Specificity of I314 is 15.86
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.71it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 84%|█████████████████████████████████████       | 43/51 [11:39<02:09, 16.15s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 42.4106
The AUROC of I27 is 30.08
The AUROC of I34 is 41.84
The AUROC of I35 is 50.38
The AUROC of I36 is 47.35
-----------------------------------
The average Sensitivity is 97.3164
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 100.00
The Sensitivity of I35 is 89.27
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 10.5141
The Specificity of I27 is 1.14
The Specificity of I34 is 3.59
The Specificity of I35 is 19.10
The Specificity of I36 is 18.23
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.249886512756348, acc1 is 4.4921875, acc5 is 12.40234375, cma_loss is 11.946433067321777, uma_loss is 0.30345356464385986
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.56s/it]
loss is 12.321173667907715, acc1 is 4.296875, acc5 is 10.693359375, cma_loss is 12.02547550201416, uma_loss is 0.2956984043121338
loss is 12.381235122680664, acc1 is 3.80859375, acc5 is 11.328125, cma_loss is 12.056760787963867, uma_loss is 0.324474573135376
loss is 12.241944313049316, acc1 is 4.4921875, acc5 is 12.6953125, cma_loss is 11.940573692321777, uma_loss is 0.30137085914611816
loss is 12.03731632232666, acc1 is 5.2734375, acc5 is 14.111328125, cma_loss is 11.743143081665039, uma_loss is 0.29417291283607483
loss is 12.307038307189941, acc1 is 5.17578125, acc5 is 12.255859375, cma_loss is 11.994165420532227, uma_loss is 0.31287282705307007
loss is 12.345213890075684, acc1 is 4.39453125, acc5 is 11.279296875, cma_loss is 12.051579475402832, uma_loss is 0.293634295463562
loss is 12.293065071105957, acc1 is 4.150390625, acc5 is 11.81640625, cma_loss is 11.994640350341797, uma_loss is 0.29842498898506165
loss is 12.288796424865723, acc1 is 5.37109375, acc5 is 12.98828125, cma_loss is 11.996631622314453, uma_loss is 0.29216477274894714
loss is 12.369368553161621, acc1 is 3.955078125, acc5 is 10.64453125, cma_loss is 12.072555541992188, uma_loss is 0.29681333899497986
loss is 12.268198013305664, acc1 is 4.443359375, acc5 is 11.865234375, cma_loss is 11.964922904968262, uma_loss is 0.3032747507095337
loss is 12.305206298828125, acc1 is 4.8828125, acc5 is 11.572265625, cma_loss is 12.005613327026367, uma_loss is 0.2995927929878235
loss is 12.393628120422363, acc1 is 3.955078125, acc5 is 10.3515625, cma_loss is 12.105273246765137, uma_loss is 0.28835529088974
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 41.70it/s]
43 epoch loss is 1.5219244820731026,                                    acc1 is 4.5147235576923075, acc5 is 11.846454326923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.92it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 141.88it/s]
-----------------------------------
The average AUROC is 21.1821
The AUROC of I313 is 24.03
The AUROC of I314 is 18.33
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 7.0965
The Specificity of I313 is 1.27
The Specificity of I314 is 12.92
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.73it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 86%|█████████████████████████████████████▉      | 44/51 [11:55<01:52, 16.13s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 40.8178
The AUROC of I27 is 24.12
The AUROC of I34 is 43.34
The AUROC of I35 is 51.41
The AUROC of I36 is 44.40
-----------------------------------
The average Sensitivity is 93.1349
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 92.66
The Sensitivity of I36 is 80.77
-----------------------------------
The average Specificity is 14.3783
The Specificity of I27 is 4.03
The Specificity of I34 is 5.67
The Specificity of I35 is 16.69
The Specificity of I36 is 31.13
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.152327537536621, acc1 is 5.126953125, acc5 is 12.060546875, cma_loss is 11.84439468383789, uma_loss is 0.3079332113265991
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.18it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.53s/it]
loss is 12.261368751525879, acc1 is 4.98046875, acc5 is 12.109375, cma_loss is 11.954397201538086, uma_loss is 0.3069711923599243
loss is 12.291566848754883, acc1 is 4.638671875, acc5 is 11.279296875, cma_loss is 12.001971244812012, uma_loss is 0.2895958125591278
loss is 12.159902572631836, acc1 is 4.541015625, acc5 is 12.79296875, cma_loss is 11.87765121459961, uma_loss is 0.2822514772415161
loss is 12.119199752807617, acc1 is 5.56640625, acc5 is 13.330078125, cma_loss is 11.822254180908203, uma_loss is 0.2969452142715454
loss is 12.39560317993164, acc1 is 3.857421875, acc5 is 11.181640625, cma_loss is 12.08870792388916, uma_loss is 0.3068951964378357
loss is 12.290308952331543, acc1 is 4.6875, acc5 is 11.669921875, cma_loss is 12.003012657165527, uma_loss is 0.28729671239852905
loss is 12.276101112365723, acc1 is 5.224609375, acc5 is 13.0859375, cma_loss is 11.976181030273438, uma_loss is 0.2999197244644165
loss is 12.245108604431152, acc1 is 5.859375, acc5 is 12.744140625, cma_loss is 11.947004318237305, uma_loss is 0.2981046438217163
loss is 12.226273536682129, acc1 is 4.248046875, acc5 is 11.23046875, cma_loss is 11.940668106079102, uma_loss is 0.2856050431728363
loss is 12.134238243103027, acc1 is 5.029296875, acc5 is 12.98828125, cma_loss is 11.829516410827637, uma_loss is 0.3047214150428772
loss is 12.292999267578125, acc1 is 4.150390625, acc5 is 12.158203125, cma_loss is 11.995777130126953, uma_loss is 0.2972223460674286
loss is 12.322065353393555, acc1 is 3.955078125, acc5 is 11.62109375, cma_loss is 12.011512756347656, uma_loss is 0.3105523884296417
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 73.31it/s]
44 epoch loss is 1.5158767972673688,                                    acc1 is 4.7588641826923075, acc5 is 12.173227163461538
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.73it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 135.80it/s]
-----------------------------------
The average AUROC is 30.4218
The AUROC of I313 is 40.22
The AUROC of I314 is 20.62
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 7.6417
The Specificity of I313 is 13.48
The Specificity of I314 is 1.80
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.77it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 88%|██████████████████████████████████████▊     | 45/51 [12:11<01:36, 16.12s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.5168
The AUROC of I27 is 30.83
The AUROC of I34 is 43.45
The AUROC of I35 is 55.22
The AUROC of I36 is 56.58
-----------------------------------
The average Sensitivity is 79.8255
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 99.12
The Sensitivity of I35 is 54.80
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 30.2770
The Specificity of I27 is 5.10
The Specificity of I34 is 4.09
The Specificity of I35 is 57.29
The Specificity of I36 is 54.63
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 12.134215354919434, acc1 is 5.322265625, acc5 is 12.3046875, cma_loss is 11.834545135498047, uma_loss is 0.29967042803764343
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.17it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 12.176015853881836, acc1 is 5.17578125, acc5 is 12.79296875, cma_loss is 11.881409645080566, uma_loss is 0.29460668563842773
loss is 12.23088264465332, acc1 is 4.39453125, acc5 is 11.669921875, cma_loss is 11.927154541015625, uma_loss is 0.3037281632423401
loss is 12.009777069091797, acc1 is 5.126953125, acc5 is 12.060546875, cma_loss is 11.726276397705078, uma_loss is 0.2835005521774292
loss is 11.908681869506836, acc1 is 6.93359375, acc5 is 15.13671875, cma_loss is 11.592854499816895, uma_loss is 0.31582707166671753
loss is 12.184649467468262, acc1 is 5.46875, acc5 is 12.744140625, cma_loss is 11.896015167236328, uma_loss is 0.288634330034256
loss is 12.338956832885742, acc1 is 3.955078125, acc5 is 10.400390625, cma_loss is 12.032522201538086, uma_loss is 0.30643510818481445
loss is 12.0805082321167, acc1 is 5.56640625, acc5 is 13.037109375, cma_loss is 11.786090850830078, uma_loss is 0.2944173216819763
loss is 12.090803146362305, acc1 is 5.419921875, acc5 is 13.96484375, cma_loss is 11.773550033569336, uma_loss is 0.31725287437438965
loss is 12.27139663696289, acc1 is 4.6875, acc5 is 12.5, cma_loss is 11.952469825744629, uma_loss is 0.31892699003219604
loss is 12.170662879943848, acc1 is 4.58984375, acc5 is 12.40234375, cma_loss is 11.83480453491211, uma_loss is 0.33585870265960693
loss is 12.19765567779541, acc1 is 4.345703125, acc5 is 12.6953125, cma_loss is 11.912275314331055, uma_loss is 0.28538045287132263
loss is 12.181798934936523, acc1 is 4.541015625, acc5 is 12.6953125, cma_loss is 11.864021301269531, uma_loss is 0.31777727603912354
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 80.79it/s]
45 epoch loss is 1.5045333771478562,                                    acc1 is 5.040564903846154, acc5 is 12.646484375
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.66it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 147.42it/s]
-----------------------------------
The average AUROC is 38.7554
The AUROC of I313 is 53.45
The AUROC of I314 is 24.06
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 41.0076
The Specificity of I313 is 68.22
The Specificity of I314 is 13.79
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.64it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 90%|███████████████████████████████████████▋    | 46/51 [12:27<01:20, 16.15s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.4214
The AUROC of I27 is 27.21
The AUROC of I34 is 45.77
The AUROC of I35 is 51.74
The AUROC of I36 is 56.98
-----------------------------------
The average Sensitivity is 84.4570
The Sensitivity of I27 is 94.12
The Sensitivity of I34 is 98.23
The Sensitivity of I35 is 95.48
The Sensitivity of I36 is 50.00
-----------------------------------
The average Specificity is 24.0332
The Specificity of I27 is 8.99
The Specificity of I34 is 7.25
The Specificity of I35 is 10.75
The Specificity of I36 is 69.14
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 11.945096969604492, acc1 is 5.419921875, acc5 is 14.35546875, cma_loss is 11.639360427856445, uma_loss is 0.3057366609573364
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 12.18386173248291, acc1 is 5.517578125, acc5 is 13.134765625, cma_loss is 11.861990928649902, uma_loss is 0.3218705654144287
loss is 12.148173332214355, acc1 is 5.17578125, acc5 is 12.255859375, cma_loss is 11.847694396972656, uma_loss is 0.30047932267189026
loss is 11.934929847717285, acc1 is 4.78515625, acc5 is 13.8671875, cma_loss is 11.6522798538208, uma_loss is 0.282649964094162
loss is 11.865406036376953, acc1 is 5.95703125, acc5 is 15.625, cma_loss is 11.555076599121094, uma_loss is 0.3103293180465698
loss is 12.003396987915039, acc1 is 5.322265625, acc5 is 13.37890625, cma_loss is 11.704985618591309, uma_loss is 0.29841116070747375
loss is 12.05707836151123, acc1 is 6.005859375, acc5 is 13.76953125, cma_loss is 11.770099639892578, uma_loss is 0.28697866201400757
loss is 11.954919815063477, acc1 is 5.6640625, acc5 is 15.185546875, cma_loss is 11.654914855957031, uma_loss is 0.30000507831573486
loss is 11.868677139282227, acc1 is 7.12890625, acc5 is 15.869140625, cma_loss is 11.560037612915039, uma_loss is 0.3086393475532532
loss is 12.108445167541504, acc1 is 5.37109375, acc5 is 12.744140625, cma_loss is 11.823740005493164, uma_loss is 0.28470516204833984
loss is 12.009134292602539, acc1 is 5.46875, acc5 is 12.939453125, cma_loss is 11.706401824951172, uma_loss is 0.30273258686065674
loss is 12.159257888793945, acc1 is 5.17578125, acc5 is 13.232421875, cma_loss is 11.85496997833252, uma_loss is 0.3042874336242676
loss is 12.013176918029785, acc1 is 5.46875, acc5 is 13.134765625, cma_loss is 11.731664657592773, uma_loss is 0.28151261806488037
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 77.17it/s]
46 epoch loss is 1.4881100427536738,                                    acc1 is 5.573918269230769, acc5 is 13.807091346153847
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.78it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 136.75it/s]
-----------------------------------
The average AUROC is 23.6489
The AUROC of I313 is 33.18
The AUROC of I314 is 14.11
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 4.0349
The Specificity of I313 is 4.27
The Specificity of I314 is 3.80
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.93it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 92%|████████████████████████████████████████▌   | 47/51 [12:44<01:05, 16.34s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.7092
The AUROC of I27 is 28.52
The AUROC of I34 is 50.30
The AUROC of I35 is 47.69
The AUROC of I36 is 52.34
-----------------------------------
The average Sensitivity is 87.9136
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 76.99
The Sensitivity of I35 is 97.74
The Sensitivity of I36 is 76.92
-----------------------------------
The average Specificity is 20.8508
The Specificity of I27 is 6.24
The Specificity of I34 is 29.70
The Specificity of I35 is 4.59
The Specificity of I36 is 42.88
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 11.88338565826416, acc1 is 4.98046875, acc5 is 14.2578125, cma_loss is 11.577773094177246, uma_loss is 0.3056129217147827
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.09it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 12.157910346984863, acc1 is 5.224609375, acc5 is 13.037109375, cma_loss is 11.864524841308594, uma_loss is 0.29338565468788147
loss is 11.980466842651367, acc1 is 5.56640625, acc5 is 14.453125, cma_loss is 11.671720504760742, uma_loss is 0.30874669551849365
loss is 11.855746269226074, acc1 is 5.517578125, acc5 is 14.697265625, cma_loss is 11.565423011779785, uma_loss is 0.2903234660625458
loss is 12.029468536376953, acc1 is 6.15234375, acc5 is 14.697265625, cma_loss is 11.707948684692383, uma_loss is 0.321519672870636
loss is 12.203071594238281, acc1 is 5.322265625, acc5 is 12.890625, cma_loss is 11.884560585021973, uma_loss is 0.3185109496116638
loss is 12.202241897583008, acc1 is 5.2734375, acc5 is 13.28125, cma_loss is 11.899543762207031, uma_loss is 0.30269768834114075
loss is 11.927694320678711, acc1 is 6.005859375, acc5 is 14.501953125, cma_loss is 11.59304428100586, uma_loss is 0.33464980125427246
loss is 11.901796340942383, acc1 is 6.4453125, acc5 is 15.380859375, cma_loss is 11.610322952270508, uma_loss is 0.2914731204509735
loss is 12.106987953186035, acc1 is 4.8828125, acc5 is 11.962890625, cma_loss is 11.8115234375, uma_loss is 0.29546406865119934
loss is 11.920534133911133, acc1 is 6.201171875, acc5 is 14.453125, cma_loss is 11.60978889465332, uma_loss is 0.31074559688568115
loss is 12.01652717590332, acc1 is 5.419921875, acc5 is 14.35546875, cma_loss is 11.715457916259766, uma_loss is 0.30106937885284424
loss is 11.97456169128418, acc1 is 5.615234375, acc5 is 13.8671875, cma_loss is 11.650070190429688, uma_loss is 0.32449132204055786
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 79.44it/s]
47 epoch loss is 1.4872418358212425,                                    acc1 is 5.585186298076923, acc5 is 13.987379807692308
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.21it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 140.45it/s]
-----------------------------------
The average AUROC is 22.7850
The AUROC of I313 is 29.78
The AUROC of I314 is 15.79
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 3.4652
The Specificity of I313 is 0.80
The Specificity of I314 is 6.13
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.69it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 94%|█████████████████████████████████████████▍  | 48/51 [13:00<00:48, 16.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.3257
The AUROC of I27 is 39.92
The AUROC of I34 is 48.80
The AUROC of I35 is 43.04
The AUROC of I36 is 41.54
-----------------------------------
The average Sensitivity is 92.2046
The Sensitivity of I27 is 70.59
The Sensitivity of I34 is 98.23
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 11.8060
The Specificity of I27 is 36.11
The Specificity of I34 is 5.95
The Specificity of I35 is 0.30
The Specificity of I36 is 4.86
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 11.798657417297363, acc1 is 6.15234375, acc5 is 15.72265625, cma_loss is 11.480737686157227, uma_loss is 0.31791961193084717
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.04it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.56s/it]
loss is 12.005289077758789, acc1 is 5.37109375, acc5 is 14.013671875, cma_loss is 11.719342231750488, uma_loss is 0.28594714403152466
loss is 11.899650573730469, acc1 is 5.810546875, acc5 is 14.6484375, cma_loss is 11.612747192382812, uma_loss is 0.2869033217430115
loss is 11.756880760192871, acc1 is 6.201171875, acc5 is 15.625, cma_loss is 11.47111701965332, uma_loss is 0.2857635021209717
loss is 11.677433013916016, acc1 is 7.2265625, acc5 is 17.08984375, cma_loss is 11.372325897216797, uma_loss is 0.30510663986206055
loss is 11.802240371704102, acc1 is 6.005859375, acc5 is 15.72265625, cma_loss is 11.532552719116211, uma_loss is 0.2696878910064697
loss is 11.80472469329834, acc1 is 7.080078125, acc5 is 16.2109375, cma_loss is 11.511030197143555, uma_loss is 0.2936941981315613
loss is 11.79871654510498, acc1 is 6.494140625, acc5 is 16.455078125, cma_loss is 11.48750114440918, uma_loss is 0.3112150728702545
loss is 11.674099922180176, acc1 is 7.666015625, acc5 is 17.724609375, cma_loss is 11.381549835205078, uma_loss is 0.2925504148006439
loss is 11.82351016998291, acc1 is 6.103515625, acc5 is 14.892578125, cma_loss is 11.532027244567871, uma_loss is 0.29148298501968384
loss is 11.650522232055664, acc1 is 6.005859375, acc5 is 15.72265625, cma_loss is 11.35000991821289, uma_loss is 0.30051225423812866
loss is 11.978708267211914, acc1 is 5.46875, acc5 is 14.74609375, cma_loss is 11.668819427490234, uma_loss is 0.3098883628845215
loss is 11.98276138305664, acc1 is 5.37109375, acc5 is 13.8671875, cma_loss is 11.67501449584961, uma_loss is 0.30774736404418945
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 114.82it/s]
48 epoch loss is 1.463363756452288,                                    acc1 is 6.2274639423076925, acc5 is 15.572415865384615
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  3.69it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 149.33it/s]
-----------------------------------
The average AUROC is 46.8286
The AUROC of I313 is 43.12
The AUROC of I314 is 50.53
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 25.7900
The Specificity of I313 is 7.21
The Specificity of I314 is 44.37
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.65it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 96%|██████████████████████████████████████████▎ | 49/51 [13:16<00:32, 16.27s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.1692
The AUROC of I27 is 54.31
The AUROC of I34 is 50.74
The AUROC of I35 is 49.92
The AUROC of I36 is 37.70
-----------------------------------
The average Sensitivity is 81.3795
The Sensitivity of I27 is 64.71
The Sensitivity of I34 is 88.50
The Sensitivity of I35 is 72.32
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 30.3819
The Specificity of I27 is 59.33
The Specificity of I34 is 20.59
The Specificity of I35 is 31.95
The Specificity of I36 is 9.66
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 11.765247344970703, acc1 is 5.95703125, acc5 is 15.52734375, cma_loss is 11.464365005493164, uma_loss is 0.30088281631469727
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  2.70it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 11.91049575805664, acc1 is 6.201171875, acc5 is 14.697265625, cma_loss is 11.591009140014648, uma_loss is 0.31948643922805786
loss is 11.96336555480957, acc1 is 5.810546875, acc5 is 13.96484375, cma_loss is 11.648269653320312, uma_loss is 0.3150961995124817
loss is 11.727171897888184, acc1 is 6.396484375, acc5 is 16.552734375, cma_loss is 11.42208194732666, uma_loss is 0.30509018898010254
loss is 11.54909610748291, acc1 is 7.2265625, acc5 is 17.7734375, cma_loss is 11.247183799743652, uma_loss is 0.3019118905067444
loss is 11.81901741027832, acc1 is 6.640625, acc5 is 16.796875, cma_loss is 11.526205062866211, uma_loss is 0.2928121089935303
loss is 11.763863563537598, acc1 is 6.298828125, acc5 is 15.4296875, cma_loss is 11.47452163696289, uma_loss is 0.2893420159816742
loss is 11.740814208984375, acc1 is 7.080078125, acc5 is 17.28515625, cma_loss is 11.416418075561523, uma_loss is 0.324396014213562
loss is 11.7442045211792, acc1 is 7.421875, acc5 is 16.455078125, cma_loss is 11.409790992736816, uma_loss is 0.334413081407547
loss is 11.765584945678711, acc1 is 6.494140625, acc5 is 15.087890625, cma_loss is 11.460417747497559, uma_loss is 0.30516764521598816
loss is 11.590688705444336, acc1 is 6.494140625, acc5 is 17.1875, cma_loss is 11.281723976135254, uma_loss is 0.30896490812301636
loss is 11.764469146728516, acc1 is 6.73828125, acc5 is 16.455078125, cma_loss is 11.45395278930664, uma_loss is 0.3105158805847168
loss is 11.788565635681152, acc1 is 5.419921875, acc5 is 15.087890625, cma_loss is 11.476001739501953, uma_loss is 0.3125638961791992
start validation
100%|██████████████████████████████████████████████| 2/2 [00:00<00:00, 88.10it/s]
49 epoch loss is 1.4561198552449544,                                    acc1 is 6.475360576923077, acc5 is 16.02313701923077
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.08it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 135.88it/s]
-----------------------------------
The average AUROC is 25.4539
The AUROC of I313 is 37.56
The AUROC of I314 is 13.35
-----------------------------------
The average Sensitivity is 55.5556
The Sensitivity of I313 is 11.11
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 52.8632
The Specificity of I313 is 98.40
The Specificity of I314 is 7.33
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.75it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
 98%|███████████████████████████████████████████▏| 50/51 [13:33<00:16, 16.47s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.9723
The AUROC of I27 is 50.95
The AUROC of I34 is 50.11
The AUROC of I35 is 51.24
The AUROC of I36 is 51.58
-----------------------------------
The average Sensitivity is 71.6176
The Sensitivity of I27 is 52.94
The Sensitivity of I34 is 90.27
The Sensitivity of I35 is 54.80
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 38.3541
The Specificity of I27 is 63.56
The Specificity of I34 is 16.36
The Specificity of I35 is 52.71
The Specificity of I36 is 20.80
-----------------------------------
  with autocast():                                        | 0/13 [00:00<?, ?it/s]
loss is 11.61612319946289, acc1 is 6.787109375, acc5 is 16.064453125, cma_loss is 11.296979904174805, uma_loss is 0.3191429376602173
100%|████████████████████████████████████████████| 13/13 [00:04<00:00,  3.19it/s]
100%|██████████████████████████████████████████████| 1/1 [00:01<00:00,  1.56s/it]
loss is 11.988201141357422, acc1 is 6.494140625, acc5 is 14.892578125, cma_loss is 11.692100524902344, uma_loss is 0.29610082507133484
loss is 12.00636100769043, acc1 is 5.17578125, acc5 is 13.916015625, cma_loss is 11.675456047058105, uma_loss is 0.3309051990509033
loss is 11.94762897491455, acc1 is 5.46875, acc5 is 14.404296875, cma_loss is 11.608633041381836, uma_loss is 0.3389958441257477
loss is 11.721942901611328, acc1 is 6.73828125, acc5 is 16.9921875, cma_loss is 11.382369995117188, uma_loss is 0.3395726978778839
loss is 11.686178207397461, acc1 is 7.03125, acc5 is 16.89453125, cma_loss is 11.364212036132812, uma_loss is 0.3219664394855499
loss is 12.085190773010254, acc1 is 5.56640625, acc5 is 14.0625, cma_loss is 11.733907699584961, uma_loss is 0.3512835204601288
loss is 11.79028606414795, acc1 is 7.03125, acc5 is 16.748046875, cma_loss is 11.43252182006836, uma_loss is 0.35776397585868835
loss is 11.576568603515625, acc1 is 8.49609375, acc5 is 17.919921875, cma_loss is 11.259763717651367, uma_loss is 0.31680452823638916
loss is 11.899539947509766, acc1 is 6.396484375, acc5 is 14.84375, cma_loss is 11.534399032592773, uma_loss is 0.36514079570770264
loss is 11.841506958007812, acc1 is 5.76171875, acc5 is 15.52734375, cma_loss is 11.513923645019531, uma_loss is 0.3275834918022156
loss is 11.9970121383667, acc1 is 5.126953125, acc5 is 13.76953125, cma_loss is 11.674903869628906, uma_loss is 0.3221079111099243
loss is 11.761442184448242, acc1 is 6.4453125, acc5 is 15.72265625, cma_loss is 11.438356399536133, uma_loss is 0.32308584451675415
start validation
100%|█████████████████████████████████████████████| 2/2 [00:00<00:00, 132.45it/s]
50 epoch loss is 1.465885543823242,                                    acc1 is 6.34765625, acc5 is 15.51983173076923
***********************************
zeroshot classification set is I313_I314
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.56it/s]
['The effusion appears circumferential. The effusion is echo dense, consistent with blood.', 'no The effusion appears circumferential. The effusion is echo dense, consistent with blood.']
['consistent with impaired fillling/tamponade physiology', 'no consistent with impaired fillling/tamponade physiology']
100%|█████████████████████████████████████████████| 4/4 [00:00<00:00, 151.16it/s]
-----------------------------------
The average AUROC is 16.6176
The AUROC of I313 is 30.54
The AUROC of I314 is 2.70
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 0.3666
The Specificity of I313 is 0.13
The Specificity of I314 is 0.60
-----------------------------------
***********************************
zeroshot classification set is I_num_2
100%|██████████████████████████████████████████████| 6/6 [00:01<00:00,  4.55it/s]
['There is severe pulmonary artery systolic hypertension.', 'no There is severe pulmonary artery systolic hypertension.']
['Mitral regurgitation is seen', 'no Mitral regurgitation is seen']
['Aortic regurgitation is seen', 'no Aortic regurgitation is seen']
['Tricuspid regurgitation is seen', 'no Tricuspid regurgitation is seen']
100%|████████████████████████████████████████████| 51/51 [13:50<00:00, 16.28s/it]
-----------------------------------
The average AUROC is 52.7759
The AUROC of I27 is 51.74
The AUROC of I34 is 51.40
The AUROC of I35 is 53.70
The AUROC of I36 is 54.26
-----------------------------------
The average Sensitivity is 57.4937
The Sensitivity of I27 is 52.94
The Sensitivity of I34 is 51.33
The Sensitivity of I35 is 75.71
The Sensitivity of I36 is 50.00
-----------------------------------
The average Specificity is 53.8500
The Specificity of I27 is 61.48
The Specificity of I34 is 54.88
The Specificity of I35 is 33.68
The Specificity of I36 is 65.36
-----------------------------------
