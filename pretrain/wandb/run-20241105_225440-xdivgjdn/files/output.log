directory "../checkpoints/" existing for save checkpoint!
#########################################
Be patient..., checking checkpoint now...
Start training from 0 epoch
#########################################
training start!
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:91: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
  0%|                                                                                                                                                                                                                                                                                                                                            | 0/51 [00:00<?, ?it/s]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 27.88440704345703, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.926029205322266, uma_loss is 13.958377838134766
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  2.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.63s/it]
loss is 28.06581687927246, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.490888595581055, uma_loss is 13.574928283691406
loss is 26.35968589782715, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 14.190601348876953, uma_loss is 12.169084548950195
loss is 25.55463409423828, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.853343963623047, uma_loss is 10.701290130615234
loss is 23.332902908325195, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.904926300048828, uma_loss is 9.427976608276367
loss is 22.32769012451172, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.902118682861328, uma_loss is 8.42557144165039
loss is 21.948530197143555, acc1 is 0.1953125, acc5 is 0.537109375, cma_loss is 13.943042755126953, uma_loss is 8.005487442016602
loss is 21.555469512939453, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.917022705078125, uma_loss is 7.638446807861328
loss is 21.162696838378906, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.88498306274414, uma_loss is 7.277712821960449
loss is 20.843765258789062, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.872634887695312, uma_loss is 6.97113037109375
loss is 20.36796760559082, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.871723175048828, uma_loss is 6.496244430541992
loss is 19.92220687866211, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.871490478515625, uma_loss is 6.050717353820801
loss is 19.706707000732422, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.874687194824219, uma_loss is 5.832019805908203
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 103.84it/s]
0 epoch loss is 2.8479283832368396,                                    acc1 is 0.11643629807692307, acc5 is 0.5483774038461539
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.03it/s]
  2%|██████▎                                                                                                                                                                                                                                                                                                                             | 1/51 [00:18<15:13, 18.27s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 68.7750
The AUROC of I313 is 56.06
The AUROC of I314 is 81.49
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 54.9374
The Specificity of I313 is 40.72
The Specificity of I314 is 69.15
-----------------------------------
The average Youden Index is 49.3819
The Youden Index of I313 is 29.61
The Youden Index of I314 is 69.15
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 19.441497802734375, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.87582778930664, uma_loss is 5.565669059753418
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 19.081037521362305, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.8782958984375, uma_loss is 5.202741622924805
loss is 18.896316528320312, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.875652313232422, uma_loss is 5.020665168762207
loss is 18.783727645874023, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.8699951171875, uma_loss is 4.913732528686523
loss is 18.744598388671875, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.867454528808594, uma_loss is 4.877142906188965
loss is 18.539752960205078, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.868034362792969, uma_loss is 4.671717643737793
loss is 18.461223602294922, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.861988067626953, uma_loss is 4.599234580993652
loss is 18.259733200073242, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.860637664794922, uma_loss is 4.3990960121154785
loss is 18.049182891845703, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.86224365234375, uma_loss is 4.186938762664795
loss is 17.847362518310547, acc1 is 0.1953125, acc5 is 0.390625, cma_loss is 13.87039566040039, uma_loss is 3.97696590423584
loss is 17.778675079345703, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.874977111816406, uma_loss is 3.903697967529297
loss is 17.687110900878906, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.872745513916016, uma_loss is 3.814365863800049
loss is 17.52228355407715, acc1 is 0.1953125, acc5 is 0.48828125, cma_loss is 13.862327575683594, uma_loss is 3.659956455230713
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 74.59it/s]
1 epoch loss is 2.2770714532761347,                                    acc1 is 0.10892427884615384, acc5 is 0.5258413461538461
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.51it/s]
  4%|████████████▋                                                                                                                                                                                                                                                                                                                       | 2/51 [00:30<12:04, 14.78s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.7330
The AUROC of I313 is 30.47
The AUROC of I314 is 73.00
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 73.6013
The Specificity of I313 is 83.71
The Specificity of I314 is 63.49
-----------------------------------
The average Youden Index is 26.3791
The Youden Index of I313 is 5.93
The Youden Index of I314 is 46.82
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 17.351749420166016, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.859195709228516, uma_loss is 3.4925537109375
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 17.219440460205078, acc1 is 0.09765625, acc5 is 0.341796875, cma_loss is 13.864185333251953, uma_loss is 3.355255126953125
loss is 17.180099487304688, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.860225677490234, uma_loss is 3.319873332977295
loss is 17.0666446685791, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.854934692382812, uma_loss is 3.211709499359131
loss is 17.05646514892578, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.856437683105469, uma_loss is 3.2000272274017334
loss is 16.975664138793945, acc1 is 0.09765625, acc5 is 0.390625, cma_loss is 13.856430053710938, uma_loss is 3.1192336082458496
loss is 16.91351318359375, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.860332489013672, uma_loss is 3.053180694580078
loss is 16.9019718170166, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.8570556640625, uma_loss is 3.0449156761169434
loss is 16.88983726501465, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.861034393310547, uma_loss is 3.0288021564483643
loss is 16.841794967651367, acc1 is 0.1953125, acc5 is 0.439453125, cma_loss is 13.859020233154297, uma_loss is 2.9827752113342285
loss is 16.79564666748047, acc1 is 0.244140625, acc5 is 0.537109375, cma_loss is 13.859535217285156, uma_loss is 2.936112403869629
loss is 16.81448745727539, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.854164123535156, uma_loss is 2.960322856903076
loss is 16.791500091552734, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.849849700927734, uma_loss is 2.941650867462158
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 77.30it/s]
2 epoch loss is 2.1028458549862816,                                    acc1 is 0.1239483173076923, acc5 is 0.5033052884615384
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.38it/s]
  6%|███████████████████                                                                                                                                                                                                                                                                                                                 | 3/51 [00:44<11:40, 14.60s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 79.2501
The AUROC of I313 is 80.66
The AUROC of I314 is 77.84
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 67.7905
The Specificity of I313 is 69.03
The Specificity of I314 is 66.56
-----------------------------------
The average Youden Index is 62.2349
The Youden Index of I313 is 57.91
The Youden Index of I314 is 66.56
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.725418090820312, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.849464416503906, uma_loss is 2.8759543895721436
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 16.72273063659668, acc1 is 0.29296875, acc5 is 0.78125, cma_loss is 13.859081268310547, uma_loss is 2.863649606704712
loss is 16.656919479370117, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.857292175292969, uma_loss is 2.7996280193328857
loss is 16.6204776763916, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.849308013916016, uma_loss is 2.771170139312744
loss is 16.48809051513672, acc1 is 0.146484375, acc5 is 0.68359375, cma_loss is 13.855594635009766, uma_loss is 2.6324968338012695
loss is 16.411531448364258, acc1 is 0.048828125, acc5 is 0.830078125, cma_loss is 13.84768295288086, uma_loss is 2.5638492107391357
loss is 16.326005935668945, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.860374450683594, uma_loss is 2.4656312465667725
loss is 16.190845489501953, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.848407745361328, uma_loss is 2.342438220977783
loss is 16.21401023864746, acc1 is 0.0, acc5 is 0.439453125, cma_loss is 13.853252410888672, uma_loss is 2.360757350921631
loss is 16.24998664855957, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.851509094238281, uma_loss is 2.398477792739868
loss is 16.185155868530273, acc1 is 0.09765625, acc5 is 0.390625, cma_loss is 13.850135803222656, uma_loss is 2.335019826889038
loss is 16.176599502563477, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.844619750976562, uma_loss is 2.331979274749756
loss is 16.136634826660156, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.838058471679688, uma_loss is 2.2985754013061523
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.99it/s]
3 epoch loss is 2.0295657748267764,                                    acc1 is 0.09765625, acc5 is 0.6047175480769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.56it/s]
  8%|█████████████████████████▍                                                                                                                                                                                                                                                                                                          | 4/51 [00:57<10:43, 13.70s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 73.8148
The AUROC of I313 is 60.33
The AUROC of I314 is 87.30
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 63.3755
The Specificity of I313 is 51.07
The Specificity of I314 is 75.68
-----------------------------------
The average Youden Index is 52.2644
The Youden Index of I313 is 28.85
The Youden Index of I314 is 75.68
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.095638275146484, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.834117889404297, uma_loss is 2.26151967048645
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 16.07868766784668, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.848003387451172, uma_loss is 2.230684757232666
loss is 16.072107315063477, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.853229522705078, uma_loss is 2.2188777923583984
loss is 16.068586349487305, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.815380096435547, uma_loss is 2.2532055377960205
loss is 16.046524047851562, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.835346221923828, uma_loss is 2.211177349090576
loss is 15.965373039245605, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.81960678100586, uma_loss is 2.145766258239746
loss is 15.922082901000977, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.83205795288086, uma_loss is 2.090024709701538
loss is 15.92441177368164, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.817001342773438, uma_loss is 2.107409954071045
loss is 15.864385604858398, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.802894592285156, uma_loss is 2.061491012573242
loss is 15.811319351196289, acc1 is 0.0, acc5 is 0.390625, cma_loss is 13.818550109863281, uma_loss is 1.9927692413330078
loss is 15.775424003601074, acc1 is 0.146484375, acc5 is 0.439453125, cma_loss is 13.809917449951172, uma_loss is 1.9655067920684814
loss is 15.660576820373535, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.786304473876953, uma_loss is 1.874272346496582
loss is 15.648512840270996, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.781932830810547, uma_loss is 1.8665801286697388
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 81.55it/s]
4 epoch loss is 1.9707964760916574,                                    acc1 is 0.11268028846153846, acc5 is 0.5709134615384616
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.30it/s]
 10%|███████████████████████████████▊                                                                                                                                                                                                                                                                                                    | 5/51 [01:09<10:02, 13.11s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 33.2281
The AUROC of I313 is 44.73
The AUROC of I314 is 21.73
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 16.0767
The Specificity of I313 is 20.76
The Specificity of I314 is 11.39
-----------------------------------
The average Youden Index is 16.0767
The Youden Index of I313 is 20.76
The Youden Index of I314 is 11.39
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.586590766906738, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.773143768310547, uma_loss is 1.8134469985961914
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.61s/it]
loss is 15.670548439025879, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.798641204833984, uma_loss is 1.8719069957733154
loss is 15.613105773925781, acc1 is 0.0, acc5 is 0.537109375, cma_loss is 13.784648895263672, uma_loss is 1.8284573554992676
loss is 15.530620574951172, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.737640380859375, uma_loss is 1.7929799556732178
loss is 15.559562683105469, acc1 is 0.29296875, acc5 is 1.025390625, cma_loss is 13.790973663330078, uma_loss is 1.7685892581939697
loss is 15.566593170166016, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.791606903076172, uma_loss is 1.7749866247177124
loss is 15.542564392089844, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.827766418457031, uma_loss is 1.714798092842102
loss is 15.51307201385498, acc1 is 0.09765625, acc5 is 0.830078125, cma_loss is 13.759521484375, uma_loss is 1.7535505294799805
loss is 15.5053071975708, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.780929565429688, uma_loss is 1.7243773937225342
loss is 15.46523666381836, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.753650665283203, uma_loss is 1.711585521697998
loss is 15.451559066772461, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.77947998046875, uma_loss is 1.67207932472229
loss is 15.348254203796387, acc1 is 0.29296875, acc5 is 0.830078125, cma_loss is 13.740093231201172, uma_loss is 1.6081609725952148
loss is 15.348299026489258, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.742252349853516, uma_loss is 1.6060463190078735
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.99it/s]
5 epoch loss is 1.9209648949759348,                                    acc1 is 0.16150841346153846, acc5 is 0.7624699519230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.38it/s]
 12%|██████████████████████████████████████                                                                                                                                                                                                                                                                                              | 6/51 [01:21<09:38, 12.85s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 27.9148
The AUROC of I313 is 38.92
The AUROC of I314 is 16.91
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.7082
The Specificity of I313 is 16.02
The Specificity of I314 is 7.40
-----------------------------------
The average Youden Index is 11.7082
The Youden Index of I313 is 16.02
The Youden Index of I314 is 7.40
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.240416526794434, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.710029602050781, uma_loss is 1.5303868055343628
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 15.201269149780273, acc1 is 0.244140625, acc5 is 0.68359375, cma_loss is 13.708354949951172, uma_loss is 1.4929146766662598
loss is 15.207340240478516, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.732414245605469, uma_loss is 1.474926233291626
loss is 15.069040298461914, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.64425277709961, uma_loss is 1.4247872829437256
loss is 15.115279197692871, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.678436279296875, uma_loss is 1.436842679977417
loss is 15.078556060791016, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.692680358886719, uma_loss is 1.3858760595321655
loss is 15.080988883972168, acc1 is 0.09765625, acc5 is 0.87890625, cma_loss is 13.677486419677734, uma_loss is 1.403502106666565
loss is 15.011479377746582, acc1 is 0.244140625, acc5 is 0.87890625, cma_loss is 13.638896942138672, uma_loss is 1.3725825548171997
loss is 15.050119400024414, acc1 is 0.0, acc5 is 0.78125, cma_loss is 13.672676086425781, uma_loss is 1.3774433135986328
loss is 14.968534469604492, acc1 is 0.1953125, acc5 is 0.732421875, cma_loss is 13.67205810546875, uma_loss is 1.296476125717163
loss is 14.971686363220215, acc1 is 0.244140625, acc5 is 0.87890625, cma_loss is 13.660812377929688, uma_loss is 1.3108739852905273
loss is 14.887796401977539, acc1 is 0.341796875, acc5 is 1.123046875, cma_loss is 13.639774322509766, uma_loss is 1.248022198677063
loss is 14.94410228729248, acc1 is 0.048828125, acc5 is 0.78125, cma_loss is 13.664009094238281, uma_loss is 1.2800928354263306
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 80.13it/s]
6 epoch loss is 1.8650153205508277,                                    acc1 is 0.16150841346153846, acc5 is 0.8150540865384616
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.39it/s]
 14%|████████████████████████████████████████████▍                                                                                                                                                                                                                                                                                       | 7/51 [01:34<09:18, 12.70s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 29.3098
The AUROC of I313 is 40.50
The AUROC of I314 is 18.12
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 16.3491
The Specificity of I313 is 26.64
The Specificity of I314 is 6.06
-----------------------------------
The average Youden Index is 10.7935
The Youden Index of I313 is 15.52
The Youden Index of I314 is 6.06
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.806915283203125, acc1 is 0.09765625, acc5 is 0.927734375, cma_loss is 13.64046859741211, uma_loss is 1.1664471626281738
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.44s/it]
loss is 14.769245147705078, acc1 is 0.09765625, acc5 is 0.9765625, cma_loss is 13.609378814697266, uma_loss is 1.159866452217102
loss is 14.859489440917969, acc1 is 0.09765625, acc5 is 0.927734375, cma_loss is 13.646717071533203, uma_loss is 1.2127718925476074
loss is 14.720192909240723, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.60824203491211, uma_loss is 1.1119508743286133
loss is 14.798347473144531, acc1 is 0.29296875, acc5 is 1.025390625, cma_loss is 13.623577117919922, uma_loss is 1.1747698783874512
loss is 14.78835678100586, acc1 is 0.146484375, acc5 is 1.07421875, cma_loss is 13.63223648071289, uma_loss is 1.1561201810836792
loss is 14.722626686096191, acc1 is 0.29296875, acc5 is 1.171875, cma_loss is 13.60610580444336, uma_loss is 1.116520643234253
loss is 14.721504211425781, acc1 is 0.29296875, acc5 is 1.3671875, cma_loss is 13.602279663085938, uma_loss is 1.1192244291305542
loss is 14.690305709838867, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.637203216552734, uma_loss is 1.053102731704712
loss is 14.629642486572266, acc1 is 0.1953125, acc5 is 1.123046875, cma_loss is 13.604911804199219, uma_loss is 1.024731159210205
loss is 14.588874816894531, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.552242279052734, uma_loss is 1.0366321802139282
loss is 14.58682918548584, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.596891403198242, uma_loss is 0.9899377822875977
loss is 14.54953384399414, acc1 is 0.09765625, acc5 is 0.87890625, cma_loss is 13.600509643554688, uma_loss is 0.9490245580673218
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 96.36it/s]
7 epoch loss is 1.8212558473859515,                                    acc1 is 0.18404447115384615, acc5 is 1.0216346153846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.51it/s]
 16%|██████████████████████████████████████████████████▊                                                                                                                                                                                                                                                                                 | 8/51 [01:46<08:57, 12.49s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 29.9782
The AUROC of I313 is 40.76
The AUROC of I314 is 19.20
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.6110
The Specificity of I313 is 19.43
The Specificity of I314 is 5.80
-----------------------------------
The average Youden Index is 12.6110
The Youden Index of I313 is 19.43
The Youden Index of I314 is 5.80
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.535209655761719, acc1 is 0.244140625, acc5 is 0.78125, cma_loss is 13.56845474243164, uma_loss is 0.9667544960975647
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 14.486639976501465, acc1 is 0.09765625, acc5 is 1.123046875, cma_loss is 13.534927368164062, uma_loss is 0.9517126083374023
loss is 14.542149543762207, acc1 is 0.244140625, acc5 is 1.171875, cma_loss is 13.58331298828125, uma_loss is 0.9588363170623779
loss is 14.48203182220459, acc1 is 0.341796875, acc5 is 1.26953125, cma_loss is 13.531002044677734, uma_loss is 0.9510298371315002
loss is 14.564216613769531, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.616891860961914, uma_loss is 0.9473245143890381
loss is 14.574846267700195, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.652763366699219, uma_loss is 0.9220828413963318
loss is 14.540220260620117, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.640495300292969, uma_loss is 0.8997248411178589
loss is 14.486714363098145, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.564922332763672, uma_loss is 0.921791672706604
loss is 14.522882461547852, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.620098114013672, uma_loss is 0.9027846455574036
loss is 14.477507591247559, acc1 is 0.390625, acc5 is 1.220703125, cma_loss is 13.585308074951172, uma_loss is 0.8921995162963867
loss is 14.395112037658691, acc1 is 0.1953125, acc5 is 1.3671875, cma_loss is 13.538768768310547, uma_loss is 0.8563435673713684
loss is 14.4424409866333, acc1 is 0.09765625, acc5 is 0.927734375, cma_loss is 13.567672729492188, uma_loss is 0.8747678995132446
loss is 14.39172077178955, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.55520248413086, uma_loss is 0.8365181684494019
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 74.96it/s]
8 epoch loss is 1.7946827843075708,                                    acc1 is 0.21784855769230768, acc5 is 1.0667067307692308
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.56it/s]
 18%|█████████████████████████████████████████████████████████▏                                                                                                                                                                                                                                                                          | 9/51 [01:58<08:44, 12.50s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 29.2939
The AUROC of I313 is 39.36
The AUROC of I314 is 19.23
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 10.7084
The Specificity of I313 is 15.55
The Specificity of I314 is 5.86
-----------------------------------
The average Youden Index is 10.7084
The Youden Index of I313 is 15.55
The Youden Index of I314 is 5.86
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.406787872314453, acc1 is 0.29296875, acc5 is 1.220703125, cma_loss is 13.578605651855469, uma_loss is 0.8281822800636292
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.58s/it]
loss is 14.322010040283203, acc1 is 0.341796875, acc5 is 1.513671875, cma_loss is 13.510982513427734, uma_loss is 0.8110270500183105
loss is 14.371688842773438, acc1 is 0.439453125, acc5 is 1.318359375, cma_loss is 13.560298919677734, uma_loss is 0.8113895058631897
loss is 14.281449317932129, acc1 is 0.244140625, acc5 is 1.46484375, cma_loss is 13.499935150146484, uma_loss is 0.7815142869949341
loss is 14.270724296569824, acc1 is 0.48828125, acc5 is 1.416015625, cma_loss is 13.478286743164062, uma_loss is 0.7924376726150513
loss is 14.312739372253418, acc1 is 0.048828125, acc5 is 1.171875, cma_loss is 13.511974334716797, uma_loss is 0.800765335559845
loss is 14.246939659118652, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.484371185302734, uma_loss is 0.7625687718391418
loss is 14.263671875, acc1 is 0.341796875, acc5 is 1.220703125, cma_loss is 13.491153717041016, uma_loss is 0.772517740726471
loss is 14.305519104003906, acc1 is 0.439453125, acc5 is 1.416015625, cma_loss is 13.523124694824219, uma_loss is 0.7823948264122009
loss is 14.266006469726562, acc1 is 0.146484375, acc5 is 1.171875, cma_loss is 13.492477416992188, uma_loss is 0.7735291719436646
loss is 14.224968910217285, acc1 is 0.244140625, acc5 is 1.416015625, cma_loss is 13.463310241699219, uma_loss is 0.7616584300994873
loss is 14.211135864257812, acc1 is 0.537109375, acc5 is 1.7578125, cma_loss is 13.474370956420898, uma_loss is 0.736764669418335
loss is 14.187751770019531, acc1 is 0.390625, acc5 is 1.171875, cma_loss is 13.469730377197266, uma_loss is 0.7180210947990417
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 46.59it/s]
9 epoch loss is 1.76829898470924,                                    acc1 is 0.33052884615384615, acc5 is 1.3408954326923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.61it/s]
 20%|███████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                                   | 10/51 [02:11<08:33, 12.53s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 28.9172
The AUROC of I313 is 38.37
The AUROC of I314 is 19.46
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 16.6166
The Specificity of I313 is 27.64
The Specificity of I314 is 5.60
-----------------------------------
The average Youden Index is 11.0610
The Youden Index of I313 is 16.53
The Youden Index of I314 is 5.60
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.180620193481445, acc1 is 0.146484375, acc5 is 1.3671875, cma_loss is 13.461746215820312, uma_loss is 0.7188737392425537
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.47s/it]
loss is 14.092491149902344, acc1 is 0.341796875, acc5 is 1.513671875, cma_loss is 13.394371032714844, uma_loss is 0.6981199383735657
loss is 14.176491737365723, acc1 is 0.48828125, acc5 is 1.5625, cma_loss is 13.479679107666016, uma_loss is 0.6968129277229309
loss is 14.063539505004883, acc1 is 0.537109375, acc5 is 1.806640625, cma_loss is 13.374961853027344, uma_loss is 0.6885779500007629
loss is 14.114968299865723, acc1 is 0.244140625, acc5 is 1.46484375, cma_loss is 13.440467834472656, uma_loss is 0.6745004653930664
loss is 14.114178657531738, acc1 is 0.390625, acc5 is 1.7578125, cma_loss is 13.442134857177734, uma_loss is 0.6720442175865173
loss is 14.092263221740723, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.429695129394531, uma_loss is 0.6625682711601257
loss is 14.109959602355957, acc1 is 0.48828125, acc5 is 1.708984375, cma_loss is 13.424873352050781, uma_loss is 0.6850859522819519
loss is 14.1586275100708, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.4940185546875, uma_loss is 0.6646088361740112
loss is 14.107345581054688, acc1 is 0.244140625, acc5 is 1.318359375, cma_loss is 13.411514282226562, uma_loss is 0.6958313584327698
loss is 14.052274703979492, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.396858215332031, uma_loss is 0.65541672706604
loss is 14.08328914642334, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.39975357055664, uma_loss is 0.6835357546806335
loss is 14.06395435333252, acc1 is 0.09765625, acc5 is 1.513671875, cma_loss is 13.403263092041016, uma_loss is 0.6606914401054382
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 130.27it/s]
10 epoch loss is 1.746761939639137,                                    acc1 is 0.32677283653846156, acc5 is 1.5061598557692308
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.32it/s]
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/zeroshot_val.py:186: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
-----------------------------------
The average AUROC is 31.4102
The AUROC of I313 is 40.42
The AUROC of I314 is 22.40
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 16.8823
The Specificity of I313 is 26.90
The Specificity of I314 is 6.86
-----------------------------------
The average Youden Index is 11.3268
The Youden Index of I313 is 15.79
The Youden Index of I314 is 6.86
***********************************
 22%|█████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                                             | 11/51 [02:23<08:18, 12.46s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.054750442504883, acc1 is 0.537109375, acc5 is 1.611328125, cma_loss is 13.401601791381836, uma_loss is 0.653148353099823
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.49s/it]
loss is 14.022668838500977, acc1 is 0.341796875, acc5 is 1.708984375, cma_loss is 13.379322052001953, uma_loss is 0.643346905708313
loss is 14.087977409362793, acc1 is 0.341796875, acc5 is 1.611328125, cma_loss is 13.433757781982422, uma_loss is 0.6542198061943054
loss is 13.972375869750977, acc1 is 0.537109375, acc5 is 1.611328125, cma_loss is 13.334346771240234, uma_loss is 0.6380289793014526
loss is 13.970659255981445, acc1 is 0.439453125, acc5 is 2.05078125, cma_loss is 13.320249557495117, uma_loss is 0.6504101157188416
loss is 14.063516616821289, acc1 is 0.29296875, acc5 is 1.07421875, cma_loss is 13.431587219238281, uma_loss is 0.6319291591644287
loss is 14.042585372924805, acc1 is 0.390625, acc5 is 1.513671875, cma_loss is 13.395439147949219, uma_loss is 0.6471463441848755
loss is 14.012921333312988, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.387458801269531, uma_loss is 0.6254622936248779
loss is 14.01904010772705, acc1 is 0.29296875, acc5 is 1.708984375, cma_loss is 13.36948013305664, uma_loss is 0.6495596170425415
loss is 13.956281661987305, acc1 is 0.439453125, acc5 is 1.5625, cma_loss is 13.321868896484375, uma_loss is 0.6344123482704163
loss is 13.932743072509766, acc1 is 0.48828125, acc5 is 1.904296875, cma_loss is 13.321319580078125, uma_loss is 0.6114235520362854
loss is 13.937731742858887, acc1 is 0.1953125, acc5 is 1.953125, cma_loss is 13.310676574707031, uma_loss is 0.6270554661750793
loss is 14.016158103942871, acc1 is 0.244140625, acc5 is 2.294921875, cma_loss is 13.387516021728516, uma_loss is 0.6286424398422241
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 93.14it/s]
11 epoch loss is 1.7341848555065336,                                    acc1 is 0.3718449519230769, acc5 is 1.6977163461538463
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.32it/s]
 24%|████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                                       | 12/51 [02:35<08:04, 12.43s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 30.6090
The AUROC of I313 is 40.54
The AUROC of I314 is 20.68
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.4096
The Specificity of I313 is 17.22
The Specificity of I314 is 5.60
-----------------------------------
The average Youden Index is 11.4096
The Youden Index of I313 is 17.22
The Youden Index of I314 is 5.60
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.097906112670898, acc1 is 0.341796875, acc5 is 1.5625, cma_loss is 13.472419738769531, uma_loss is 0.6254865527153015
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 14.014049530029297, acc1 is 0.390625, acc5 is 2.001953125, cma_loss is 13.398002624511719, uma_loss is 0.6160464882850647
loss is 14.012239456176758, acc1 is 0.48828125, acc5 is 1.85546875, cma_loss is 13.397968292236328, uma_loss is 0.614270806312561
loss is 13.948075294494629, acc1 is 0.29296875, acc5 is 2.099609375, cma_loss is 13.337364196777344, uma_loss is 0.6107111573219299
loss is 13.916707992553711, acc1 is 0.439453125, acc5 is 2.197265625, cma_loss is 13.315330505371094, uma_loss is 0.6013770699501038
loss is 13.993063926696777, acc1 is 0.390625, acc5 is 1.220703125, cma_loss is 13.409370422363281, uma_loss is 0.5836932063102722
loss is 13.911205291748047, acc1 is 0.537109375, acc5 is 1.85546875, cma_loss is 13.3187255859375, uma_loss is 0.5924801826477051
loss is 13.899553298950195, acc1 is 0.537109375, acc5 is 2.1484375, cma_loss is 13.329828262329102, uma_loss is 0.5697246789932251
loss is 13.943442344665527, acc1 is 0.48828125, acc5 is 2.197265625, cma_loss is 13.375125885009766, uma_loss is 0.5683163404464722
loss is 13.8789701461792, acc1 is 0.537109375, acc5 is 1.806640625, cma_loss is 13.31021499633789, uma_loss is 0.5687553286552429
loss is 13.853431701660156, acc1 is 0.48828125, acc5 is 1.953125, cma_loss is 13.2711181640625, uma_loss is 0.5823136568069458
loss is 13.850151062011719, acc1 is 0.439453125, acc5 is 2.001953125, cma_loss is 13.285600662231445, uma_loss is 0.564550518989563
loss is 13.85543155670166, acc1 is 0.439453125, acc5 is 1.85546875, cma_loss is 13.289714813232422, uma_loss is 0.5657168626785278
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 67.01it/s]
12 epoch loss is 1.725468835376558,                                    acc1 is 0.4469651442307692, acc5 is 1.904296875
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.64it/s]
 25%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                | 13/51 [02:48<07:49, 12.36s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 30.2742
The AUROC of I313 is 40.71
The AUROC of I314 is 19.84
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 10.2754
The Specificity of I313 is 15.62
The Specificity of I314 is 4.93
-----------------------------------
The average Youden Index is 10.2754
The Youden Index of I313 is 15.62
The Youden Index of I314 is 4.93
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.837095260620117, acc1 is 0.439453125, acc5 is 2.24609375, cma_loss is 13.272964477539062, uma_loss is 0.5641312599182129
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.793686866760254, acc1 is 0.244140625, acc5 is 2.099609375, cma_loss is 13.22165298461914, uma_loss is 0.5720341205596924
loss is 13.858230590820312, acc1 is 0.390625, acc5 is 1.806640625, cma_loss is 13.309589385986328, uma_loss is 0.5486412644386292
loss is 13.789381980895996, acc1 is 0.634765625, acc5 is 2.685546875, cma_loss is 13.22225570678711, uma_loss is 0.567126452922821
loss is 13.776765823364258, acc1 is 0.68359375, acc5 is 2.587890625, cma_loss is 13.233051300048828, uma_loss is 0.5437145829200745
loss is 13.862128257751465, acc1 is 0.29296875, acc5 is 1.708984375, cma_loss is 13.326644897460938, uma_loss is 0.5354835391044617
loss is 13.787991523742676, acc1 is 0.78125, acc5 is 2.1484375, cma_loss is 13.243597030639648, uma_loss is 0.5443947315216064
loss is 13.73184585571289, acc1 is 0.5859375, acc5 is 2.197265625, cma_loss is 13.197315216064453, uma_loss is 0.5345302820205688
loss is 13.852866172790527, acc1 is 0.439453125, acc5 is 1.5625, cma_loss is 13.305789947509766, uma_loss is 0.5470761060714722
loss is 13.774431228637695, acc1 is 0.439453125, acc5 is 2.34375, cma_loss is 13.252655029296875, uma_loss is 0.5217758417129517
loss is 13.755229949951172, acc1 is 0.390625, acc5 is 2.490234375, cma_loss is 13.21566390991211, uma_loss is 0.5395663976669312
loss is 13.759696006774902, acc1 is 0.634765625, acc5 is 2.392578125, cma_loss is 13.211956024169922, uma_loss is 0.5477397441864014
loss is 13.734691619873047, acc1 is 0.5859375, acc5 is 2.05078125, cma_loss is 13.230377197265625, uma_loss is 0.5043143630027771
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 69.81it/s]
13 epoch loss is 1.7077527727399553,                                    acc1 is 0.5033052884615384, acc5 is 2.178485576923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.46it/s]
 27%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                          | 14/51 [03:00<07:33, 12.26s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 35.9030
The AUROC of I313 is 45.47
The AUROC of I314 is 26.34
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.7123
The Specificity of I313 is 20.09
The Specificity of I314 is 3.33
-----------------------------------
The average Youden Index is 11.7123
The Youden Index of I313 is 20.09
The Youden Index of I314 is 3.33
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.687612533569336, acc1 is 0.78125, acc5 is 2.44140625, cma_loss is 13.169185638427734, uma_loss is 0.5184267163276672
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.79554271697998, acc1 is 0.48828125, acc5 is 2.24609375, cma_loss is 13.253105163574219, uma_loss is 0.5424378514289856
loss is 13.799918174743652, acc1 is 0.537109375, acc5 is 1.904296875, cma_loss is 13.299701690673828, uma_loss is 0.5002169013023376
loss is 13.722972869873047, acc1 is 0.390625, acc5 is 2.44140625, cma_loss is 13.207185745239258, uma_loss is 0.5157868266105652
loss is 13.679194450378418, acc1 is 0.48828125, acc5 is 2.44140625, cma_loss is 13.187454223632812, uma_loss is 0.49173980951309204
loss is 13.73228645324707, acc1 is 0.48828125, acc5 is 2.24609375, cma_loss is 13.238933563232422, uma_loss is 0.49335259199142456
loss is 13.713105201721191, acc1 is 0.341796875, acc5 is 1.806640625, cma_loss is 13.22079086303711, uma_loss is 0.49231407046318054
loss is 13.74647045135498, acc1 is 0.68359375, acc5 is 2.294921875, cma_loss is 13.247749328613281, uma_loss is 0.49872100353240967
loss is 13.90990924835205, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.414073944091797, uma_loss is 0.49583542346954346
loss is 13.778937339782715, acc1 is 0.48828125, acc5 is 2.05078125, cma_loss is 13.286581039428711, uma_loss is 0.4923561215400696
loss is 13.737534523010254, acc1 is 0.439453125, acc5 is 2.1484375, cma_loss is 13.249244689941406, uma_loss is 0.48828965425491333
loss is 13.678510665893555, acc1 is 0.78125, acc5 is 2.490234375, cma_loss is 13.196414947509766, uma_loss is 0.48209530115127563
loss is 13.70166015625, acc1 is 0.29296875, acc5 is 2.05078125, cma_loss is 13.228893280029297, uma_loss is 0.4727669656276703
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 79.99it/s]
14 epoch loss is 1.7017490931919643,                                    acc1 is 0.49954927884615385, acc5 is 2.155949519230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.39it/s]
 29%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                    | 15/51 [03:12<07:24, 12.34s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 28.7530
The AUROC of I313 is 36.98
The AUROC of I314 is 20.53
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.9427
The Specificity of I313 is 16.02
The Specificity of I314 is 3.86
-----------------------------------
The average Youden Index is 9.9427
The Youden Index of I313 is 16.02
The Youden Index of I314 is 3.86
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.681947708129883, acc1 is 0.48828125, acc5 is 2.099609375, cma_loss is 13.209819793701172, uma_loss is 0.47212833166122437
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 13.633737564086914, acc1 is 0.5859375, acc5 is 2.783203125, cma_loss is 13.182205200195312, uma_loss is 0.4515320956707001
loss is 13.688958168029785, acc1 is 0.5859375, acc5 is 1.953125, cma_loss is 13.221670150756836, uma_loss is 0.4672876000404358
loss is 13.633050918579102, acc1 is 0.537109375, acc5 is 2.685546875, cma_loss is 13.167316436767578, uma_loss is 0.46573466062545776
loss is 13.586762428283691, acc1 is 0.390625, acc5 is 2.34375, cma_loss is 13.128643035888672, uma_loss is 0.4581189751625061
loss is 13.69784164428711, acc1 is 0.48828125, acc5 is 2.1484375, cma_loss is 13.236848831176758, uma_loss is 0.4609932005405426
loss is 13.610028266906738, acc1 is 0.5859375, acc5 is 2.392578125, cma_loss is 13.139135360717773, uma_loss is 0.4708927869796753
loss is 13.538688659667969, acc1 is 0.390625, acc5 is 2.099609375, cma_loss is 13.098295211791992, uma_loss is 0.44039323925971985
loss is 13.624464988708496, acc1 is 0.537109375, acc5 is 2.294921875, cma_loss is 13.183246612548828, uma_loss is 0.4412182569503784
loss is 13.574685096740723, acc1 is 0.68359375, acc5 is 2.44140625, cma_loss is 13.129949569702148, uma_loss is 0.44473540782928467
loss is 13.559331893920898, acc1 is 0.87890625, acc5 is 2.783203125, cma_loss is 13.097480773925781, uma_loss is 0.4618513286113739
loss is 13.564980506896973, acc1 is 0.830078125, acc5 is 3.125, cma_loss is 13.105545043945312, uma_loss is 0.45943576097488403
loss is 13.542513847351074, acc1 is 0.5859375, acc5 is 3.515625, cma_loss is 13.103052139282227, uma_loss is 0.43946143984794617
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 80.52it/s]
15 epoch loss is 1.6851142065865652,                                    acc1 is 0.5821814903846154, acc5 is 2.5127704326923075
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.51it/s]
 31%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                             | 16/51 [03:24<07:08, 12.25s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 27.5482
The AUROC of I313 is 36.98
The AUROC of I314 is 18.12
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.1089
The Specificity of I313 is 15.02
The Specificity of I314 is 3.20
-----------------------------------
The average Youden Index is 9.1089
The Youden Index of I313 is 15.02
The Youden Index of I314 is 3.20
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.473599433898926, acc1 is 0.927734375, acc5 is 3.369140625, cma_loss is 13.052835464477539, uma_loss is 0.42076364159584045
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.58s/it]
loss is 13.480334281921387, acc1 is 0.634765625, acc5 is 3.369140625, cma_loss is 13.053071975708008, uma_loss is 0.4272625148296356
loss is 13.536206245422363, acc1 is 0.439453125, acc5 is 2.1484375, cma_loss is 13.111234664916992, uma_loss is 0.42497125267982483
loss is 13.447673797607422, acc1 is 0.927734375, acc5 is 3.271484375, cma_loss is 12.996953964233398, uma_loss is 0.4507197141647339
loss is 13.59034252166748, acc1 is 0.48828125, acc5 is 2.685546875, cma_loss is 13.153806686401367, uma_loss is 0.43653616309165955
loss is 13.573189735412598, acc1 is 0.48828125, acc5 is 2.44140625, cma_loss is 13.13067626953125, uma_loss is 0.44251376390457153
loss is 13.523143768310547, acc1 is 0.732421875, acc5 is 2.685546875, cma_loss is 13.092794418334961, uma_loss is 0.43034952878952026
loss is 13.513955116271973, acc1 is 0.5859375, acc5 is 2.783203125, cma_loss is 13.076789855957031, uma_loss is 0.4371655285358429
loss is 13.620536804199219, acc1 is 0.5859375, acc5 is 2.099609375, cma_loss is 13.201766967773438, uma_loss is 0.4187696576118469
loss is 13.459805488586426, acc1 is 1.220703125, acc5 is 3.076171875, cma_loss is 13.030040740966797, uma_loss is 0.42976489663124084
loss is 13.50307559967041, acc1 is 0.634765625, acc5 is 2.978515625, cma_loss is 13.062524795532227, uma_loss is 0.44055086374282837
loss is 13.638591766357422, acc1 is 0.5859375, acc5 is 2.1484375, cma_loss is 13.182004928588867, uma_loss is 0.45658645033836365
loss is 13.8294677734375, acc1 is 0.537109375, acc5 is 1.904296875, cma_loss is 13.396965026855469, uma_loss is 0.43250253796577454
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 76.82it/s]
16 epoch loss is 1.677999260312035,                                    acc1 is 0.6760817307692307, acc5 is 2.6893028846153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.24it/s]
 33%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                       | 17/51 [03:37<07:00, 12.37s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 28.8742
The AUROC of I313 is 37.87
The AUROC of I314 is 19.88
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.3461
The Specificity of I313 is 20.36
The Specificity of I314 is 2.33
-----------------------------------
The average Youden Index is 11.3461
The Youden Index of I313 is 20.36
The Youden Index of I314 is 2.33
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.808697700500488, acc1 is 0.48828125, acc5 is 2.587890625, cma_loss is 13.377988815307617, uma_loss is 0.4307088255882263
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 13.683579444885254, acc1 is 0.5859375, acc5 is 2.490234375, cma_loss is 13.255508422851562, uma_loss is 0.42807069420814514
loss is 13.709463119506836, acc1 is 0.48828125, acc5 is 2.490234375, cma_loss is 13.269210815429688, uma_loss is 0.44025251269340515
loss is 13.746752738952637, acc1 is 0.439453125, acc5 is 2.294921875, cma_loss is 13.317222595214844, uma_loss is 0.42953017354011536
loss is 13.621790885925293, acc1 is 0.439453125, acc5 is 2.24609375, cma_loss is 13.185712814331055, uma_loss is 0.4360778331756592
loss is 13.66634750366211, acc1 is 0.537109375, acc5 is 2.1484375, cma_loss is 13.222450256347656, uma_loss is 0.44389694929122925
loss is 13.657483100891113, acc1 is 0.390625, acc5 is 2.24609375, cma_loss is 13.209753036499023, uma_loss is 0.4477299153804779
loss is 13.600653648376465, acc1 is 0.78125, acc5 is 2.9296875, cma_loss is 13.148332595825195, uma_loss is 0.4523206949234009
loss is 13.643482208251953, acc1 is 0.634765625, acc5 is 2.734375, cma_loss is 13.192728042602539, uma_loss is 0.450754314661026
loss is 13.53443431854248, acc1 is 0.732421875, acc5 is 2.685546875, cma_loss is 13.097020149230957, uma_loss is 0.4374137818813324
loss is 13.520160675048828, acc1 is 0.48828125, acc5 is 2.685546875, cma_loss is 13.091447830200195, uma_loss is 0.42871329188346863
loss is 13.507275581359863, acc1 is 0.732421875, acc5 is 3.173828125, cma_loss is 13.053260803222656, uma_loss is 0.45401477813720703
loss is 13.521469116210938, acc1 is 0.439453125, acc5 is 2.880859375, cma_loss is 13.091341018676758, uma_loss is 0.4301281273365021
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.37it/s]
17 epoch loss is 1.6878246670677548,                                    acc1 is 0.5521334134615384, acc5 is 2.5841346153846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.45it/s]
 35%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                 | 18/51 [03:49<06:43, 12.24s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 26.3198
The AUROC of I313 is 37.36
The AUROC of I314 is 15.28
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 10.8438
The Specificity of I313 is 17.69
The Specificity of I314 is 4.00
-----------------------------------
The average Youden Index is 10.8438
The Youden Index of I313 is 17.69
The Youden Index of I314 is 4.00
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.506169319152832, acc1 is 0.341796875, acc5 is 3.076171875, cma_loss is 13.07291030883789, uma_loss is 0.4332585632801056
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 13.469496726989746, acc1 is 0.732421875, acc5 is 3.125, cma_loss is 13.042619705200195, uma_loss is 0.4268772602081299
loss is 13.498172760009766, acc1 is 0.78125, acc5 is 3.173828125, cma_loss is 13.055238723754883, uma_loss is 0.4429340362548828
loss is 13.447861671447754, acc1 is 0.68359375, acc5 is 2.783203125, cma_loss is 13.00648307800293, uma_loss is 0.44137847423553467
loss is 13.407584190368652, acc1 is 0.9765625, acc5 is 3.02734375, cma_loss is 12.970806121826172, uma_loss is 0.43677765130996704
loss is 13.542278289794922, acc1 is 0.732421875, acc5 is 3.22265625, cma_loss is 13.094505310058594, uma_loss is 0.44777318835258484
loss is 13.456703186035156, acc1 is 0.78125, acc5 is 2.685546875, cma_loss is 13.005266189575195, uma_loss is 0.4514371454715729
loss is 13.436634063720703, acc1 is 0.732421875, acc5 is 3.41796875, cma_loss is 13.001422882080078, uma_loss is 0.4352109134197235
loss is 13.49550724029541, acc1 is 0.830078125, acc5 is 2.83203125, cma_loss is 13.057632446289062, uma_loss is 0.43787485361099243
loss is 13.302002906799316, acc1 is 0.927734375, acc5 is 3.515625, cma_loss is 12.881450653076172, uma_loss is 0.4205518662929535
loss is 13.296907424926758, acc1 is 1.025390625, acc5 is 3.076171875, cma_loss is 12.877677917480469, uma_loss is 0.4192294776439667
loss is 13.347554206848145, acc1 is 0.9765625, acc5 is 3.90625, cma_loss is 12.912343978881836, uma_loss is 0.4352099299430847
loss is 13.38664722442627, acc1 is 0.634765625, acc5 is 3.515625, cma_loss is 12.970117568969727, uma_loss is 0.41652965545654297
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 82.43it/s]
18 epoch loss is 1.662795421055385,                                    acc1 is 0.78125, acc5 is 3.181340144230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.52it/s]
 37%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                          | 19/51 [04:01<06:35, 12.35s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 29.9746
The AUROC of I313 is 39.05
The AUROC of I314 is 20.90
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.1089
The Specificity of I313 is 15.02
The Specificity of I314 is 3.20
-----------------------------------
The average Youden Index is 9.1089
The Youden Index of I313 is 15.02
The Youden Index of I314 is 3.20
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.315691947937012, acc1 is 1.220703125, acc5 is 4.150390625, cma_loss is 12.907413482666016, uma_loss is 0.4082788825035095
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 13.313980102539062, acc1 is 1.025390625, acc5 is 3.7109375, cma_loss is 12.906719207763672, uma_loss is 0.4072605073451996
loss is 13.486875534057617, acc1 is 0.68359375, acc5 is 2.978515625, cma_loss is 13.066015243530273, uma_loss is 0.4208598732948303
loss is 13.294486045837402, acc1 is 1.123046875, acc5 is 3.759765625, cma_loss is 12.888692855834961, uma_loss is 0.405792772769928
loss is 13.416415214538574, acc1 is 1.025390625, acc5 is 3.7109375, cma_loss is 12.998992919921875, uma_loss is 0.41742193698883057
loss is 13.450581550598145, acc1 is 0.68359375, acc5 is 3.22265625, cma_loss is 13.04488754272461, uma_loss is 0.40569382905960083
loss is 13.348304748535156, acc1 is 0.87890625, acc5 is 3.369140625, cma_loss is 12.955923080444336, uma_loss is 0.3923812210559845
loss is 13.333956718444824, acc1 is 1.123046875, acc5 is 3.857421875, cma_loss is 12.920429229736328, uma_loss is 0.41352754831314087
loss is 13.316776275634766, acc1 is 0.830078125, acc5 is 3.02734375, cma_loss is 12.925127029418945, uma_loss is 0.3916488587856293
loss is 13.266393661499023, acc1 is 1.123046875, acc5 is 3.80859375, cma_loss is 12.837884902954102, uma_loss is 0.42850908637046814
loss is 13.247504234313965, acc1 is 1.07421875, acc5 is 3.955078125, cma_loss is 12.866640090942383, uma_loss is 0.38086438179016113
loss is 13.308771133422852, acc1 is 0.68359375, acc5 is 3.22265625, cma_loss is 12.908201217651367, uma_loss is 0.4005698561668396
loss is 13.33767318725586, acc1 is 0.830078125, acc5 is 3.759765625, cma_loss is 12.939569473266602, uma_loss is 0.3981036841869354
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.10it/s]
19 epoch loss is 1.6517848605201357,                                    acc1 is 0.9465144230769231, acc5 is 3.5794771634615383
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.40it/s]
 39%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                    | 20/51 [04:14<06:21, 12.31s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.2432
The AUROC of I313 is 56.97
The AUROC of I314 is 45.51
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 66.67
-----------------------------------
The average Specificity is 58.6966
The Specificity of I313 is 69.09
The Specificity of I314 is 48.30
-----------------------------------
The average Youden Index is 19.8077
The Youden Index of I313 is 24.65
The Youden Index of I314 is 14.97
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.27198600769043, acc1 is 1.07421875, acc5 is 4.248046875, cma_loss is 12.877082824707031, uma_loss is 0.3949030935764313
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 13.213722229003906, acc1 is 1.07421875, acc5 is 4.150390625, cma_loss is 12.855207443237305, uma_loss is 0.3585151433944702
loss is 13.260741233825684, acc1 is 0.732421875, acc5 is 3.90625, cma_loss is 12.865894317626953, uma_loss is 0.39484673738479614
loss is 13.225913047790527, acc1 is 1.07421875, acc5 is 3.7109375, cma_loss is 12.831363677978516, uma_loss is 0.394549697637558
loss is 13.285674095153809, acc1 is 1.3671875, acc5 is 4.736328125, cma_loss is 12.883646011352539, uma_loss is 0.40202784538269043
loss is 13.255522727966309, acc1 is 1.07421875, acc5 is 3.90625, cma_loss is 12.882772445678711, uma_loss is 0.3727506995201111
loss is 13.232866287231445, acc1 is 0.78125, acc5 is 3.662109375, cma_loss is 12.854059219360352, uma_loss is 0.3788072168827057
loss is 13.203411102294922, acc1 is 0.78125, acc5 is 3.759765625, cma_loss is 12.817434310913086, uma_loss is 0.3859766125679016
loss is 13.331411361694336, acc1 is 0.68359375, acc5 is 2.978515625, cma_loss is 12.94813346862793, uma_loss is 0.3832775354385376
loss is 13.177529335021973, acc1 is 1.123046875, acc5 is 3.857421875, cma_loss is 12.791866302490234, uma_loss is 0.3856634497642517
loss is 13.106818199157715, acc1 is 0.9765625, acc5 is 3.857421875, cma_loss is 12.735816955566406, uma_loss is 0.3710010349750519
loss is 13.203670501708984, acc1 is 1.220703125, acc5 is 4.296875, cma_loss is 12.845027923583984, uma_loss is 0.3586426079273224
loss is 13.235998153686523, acc1 is 1.123046875, acc5 is 3.7109375, cma_loss is 12.88088607788086, uma_loss is 0.3551119863986969
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 80.61it/s]
20 epoch loss is 1.6381453741164433,                                    acc1 is 1.0066105769230769, acc5 is 3.90625
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.41it/s]
 41%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                              | 21/51 [04:26<06:09, 12.31s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.0696
The AUROC of I313 is 44.10
The AUROC of I314 is 46.04
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 23.6614
The Specificity of I313 is 10.48
The Specificity of I314 is 36.84
-----------------------------------
The average Youden Index is 15.3280
The Youden Index of I313 is 10.48
The Youden Index of I314 is 20.18
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.170401573181152, acc1 is 1.46484375, acc5 is 4.931640625, cma_loss is 12.807380676269531, uma_loss is 0.3630213439464569
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 13.276561737060547, acc1 is 1.611328125, acc5 is 4.6875, cma_loss is 12.936113357543945, uma_loss is 0.34044790267944336
loss is 13.36827278137207, acc1 is 1.025390625, acc5 is 3.466796875, cma_loss is 13.00986099243164, uma_loss is 0.35841184854507446
loss is 13.194897651672363, acc1 is 1.07421875, acc5 is 4.00390625, cma_loss is 12.824586868286133, uma_loss is 0.3703109323978424
loss is 13.231807708740234, acc1 is 1.318359375, acc5 is 4.19921875, cma_loss is 12.850908279418945, uma_loss is 0.3808993399143219
loss is 13.306572914123535, acc1 is 1.318359375, acc5 is 4.00390625, cma_loss is 12.938855171203613, uma_loss is 0.3677181601524353
loss is 13.185641288757324, acc1 is 0.78125, acc5 is 4.296875, cma_loss is 12.834821701049805, uma_loss is 0.3508197069168091
loss is 13.141790390014648, acc1 is 1.26953125, acc5 is 4.39453125, cma_loss is 12.773460388183594, uma_loss is 0.3683304488658905
loss is 13.255696296691895, acc1 is 0.830078125, acc5 is 3.61328125, cma_loss is 12.908885955810547, uma_loss is 0.34681054949760437
loss is 13.198131561279297, acc1 is 1.123046875, acc5 is 3.466796875, cma_loss is 12.836231231689453, uma_loss is 0.3619006872177124
loss is 13.081388473510742, acc1 is 1.318359375, acc5 is 4.19921875, cma_loss is 12.727639198303223, uma_loss is 0.35374903678894043
loss is 13.161728858947754, acc1 is 1.07421875, acc5 is 4.39453125, cma_loss is 12.800908088684082, uma_loss is 0.3608211874961853
loss is 13.110107421875, acc1 is 1.46484375, acc5 is 4.296875, cma_loss is 12.761201858520508, uma_loss is 0.3489057421684265
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 43.68it/s]
21 epoch loss is 1.635076177687872,                                    acc1 is 1.2056790865384615, acc5 is 4.150390625
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.56it/s]
 43%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                       | 22/51 [04:38<05:58, 12.37s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 39.7385
The AUROC of I313 is 39.08
The AUROC of I314 is 40.40
-----------------------------------
The average Sensitivity is 66.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 33.33
-----------------------------------
The average Specificity is 46.0788
The Specificity of I313 is 9.48
The Specificity of I314 is 82.68
-----------------------------------
The average Youden Index is 12.7454
The Youden Index of I313 is 9.48
The Youden Index of I314 is 16.01
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.058011054992676, acc1 is 1.3671875, acc5 is 4.248046875, cma_loss is 12.729249954223633, uma_loss is 0.32876092195510864
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.1065092086792, acc1 is 1.26953125, acc5 is 4.541015625, cma_loss is 12.750720977783203, uma_loss is 0.3557886779308319
loss is 13.106554985046387, acc1 is 1.26953125, acc5 is 4.345703125, cma_loss is 12.76553726196289, uma_loss is 0.34101787209510803
loss is 13.042901039123535, acc1 is 1.3671875, acc5 is 4.931640625, cma_loss is 12.673279762268066, uma_loss is 0.3696211576461792
loss is 13.028295516967773, acc1 is 1.5625, acc5 is 5.029296875, cma_loss is 12.688037872314453, uma_loss is 0.3402579724788666
loss is 13.096257209777832, acc1 is 1.318359375, acc5 is 5.078125, cma_loss is 12.745695114135742, uma_loss is 0.3505617082118988
loss is 13.050122261047363, acc1 is 1.318359375, acc5 is 4.833984375, cma_loss is 12.70503044128418, uma_loss is 0.34509170055389404
loss is 13.036269187927246, acc1 is 1.123046875, acc5 is 4.541015625, cma_loss is 12.688461303710938, uma_loss is 0.34780794382095337
loss is 13.145333290100098, acc1 is 1.416015625, acc5 is 4.052734375, cma_loss is 12.783912658691406, uma_loss is 0.3614206314086914
loss is 13.004345893859863, acc1 is 1.513671875, acc5 is 5.126953125, cma_loss is 12.671285629272461, uma_loss is 0.3330603539943695
loss is 12.87356185913086, acc1 is 2.099609375, acc5 is 5.6640625, cma_loss is 12.535224914550781, uma_loss is 0.3383365273475647
loss is 13.036870956420898, acc1 is 1.07421875, acc5 is 4.345703125, cma_loss is 12.691119194030762, uma_loss is 0.345752090215683
loss is 13.112661361694336, acc1 is 1.416015625, acc5 is 4.98046875, cma_loss is 12.767394065856934, uma_loss is 0.3452669680118561
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 87.14it/s]
22 epoch loss is 1.6161685126168388,                                    acc1 is 1.3934795673076923, acc5 is 4.747596153846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.25it/s]
 45%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                 | 23/51 [04:51<05:47, 12.42s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.6687
The AUROC of I313 is 64.58
The AUROC of I314 is 50.76
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 66.67
-----------------------------------
The average Specificity is 52.1191
The Specificity of I313 is 53.81
The Specificity of I314 is 50.43
-----------------------------------
The average Youden Index is 29.8968
The Youden Index of I313 is 42.69
The Youden Index of I314 is 17.10
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.112622261047363, acc1 is 1.123046875, acc5 is 4.8828125, cma_loss is 12.774471282958984, uma_loss is 0.33815088868141174
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 13.1077241897583, acc1 is 1.025390625, acc5 is 4.931640625, cma_loss is 12.753593444824219, uma_loss is 0.35413089394569397
loss is 13.121670722961426, acc1 is 1.416015625, acc5 is 4.4921875, cma_loss is 12.749839782714844, uma_loss is 0.3718308210372925
loss is 12.988068580627441, acc1 is 1.66015625, acc5 is 5.17578125, cma_loss is 12.621073722839355, uma_loss is 0.3669944703578949
loss is 13.018524169921875, acc1 is 1.7578125, acc5 is 5.2734375, cma_loss is 12.678047180175781, uma_loss is 0.3404774069786072
loss is 13.207600593566895, acc1 is 1.416015625, acc5 is 4.19921875, cma_loss is 12.869111061096191, uma_loss is 0.33848944306373596
loss is 13.017597198486328, acc1 is 1.318359375, acc5 is 5.078125, cma_loss is 12.690853118896484, uma_loss is 0.326744019985199
loss is 13.074169158935547, acc1 is 1.318359375, acc5 is 4.58984375, cma_loss is 12.72601318359375, uma_loss is 0.3481559455394745
loss is 12.983484268188477, acc1 is 1.26953125, acc5 is 4.6875, cma_loss is 12.642803192138672, uma_loss is 0.3406810760498047
loss is 12.896471977233887, acc1 is 1.85546875, acc5 is 5.810546875, cma_loss is 12.571232795715332, uma_loss is 0.32523927092552185
loss is 12.979561805725098, acc1 is 1.66015625, acc5 is 5.517578125, cma_loss is 12.630282402038574, uma_loss is 0.3492792248725891
loss is 13.018056869506836, acc1 is 1.26953125, acc5 is 5.615234375, cma_loss is 12.700760841369629, uma_loss is 0.31729647517204285
loss is 12.991610527038574, acc1 is 1.220703125, acc5 is 4.931640625, cma_loss is 12.665218353271484, uma_loss is 0.3263918161392212
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 86.09it/s]
23 epoch loss is 1.6144491649809338,                                    acc1 is 1.4085036057692308, acc5 is 5.014272836538462
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.45it/s]
 47%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                           | 24/51 [05:04<05:38, 12.55s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 38.1323
The AUROC of I313 is 54.04
The AUROC of I314 is 22.23
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 20.7567
The Specificity of I313 is 37.25
The Specificity of I314 is 4.26
-----------------------------------
The average Youden Index is 9.6456
The Youden Index of I313 is 15.03
The Youden Index of I314 is 4.26
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.92420768737793, acc1 is 1.7578125, acc5 is 5.6640625, cma_loss is 12.60508918762207, uma_loss is 0.319118469953537
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 12.931051254272461, acc1 is 1.611328125, acc5 is 5.95703125, cma_loss is 12.610624313354492, uma_loss is 0.3204273283481598
loss is 12.95523452758789, acc1 is 1.46484375, acc5 is 5.17578125, cma_loss is 12.630492210388184, uma_loss is 0.32474279403686523
loss is 12.820243835449219, acc1 is 1.85546875, acc5 is 6.15234375, cma_loss is 12.492938995361328, uma_loss is 0.3273050785064697
loss is 12.754786491394043, acc1 is 1.7578125, acc5 is 6.0546875, cma_loss is 12.430791854858398, uma_loss is 0.3239949643611908
loss is 12.99888801574707, acc1 is 1.85546875, acc5 is 5.517578125, cma_loss is 12.678764343261719, uma_loss is 0.3201234042644501
loss is 12.902934074401855, acc1 is 1.3671875, acc5 is 5.859375, cma_loss is 12.581056594848633, uma_loss is 0.3218778073787689
loss is 12.830183029174805, acc1 is 1.513671875, acc5 is 5.46875, cma_loss is 12.521833419799805, uma_loss is 0.3083498179912567
loss is 13.017906188964844, acc1 is 1.708984375, acc5 is 4.4921875, cma_loss is 12.687835693359375, uma_loss is 0.3300703167915344
loss is 12.896648406982422, acc1 is 1.611328125, acc5 is 5.908203125, cma_loss is 12.566880226135254, uma_loss is 0.3297680914402008
loss is 12.792801856994629, acc1 is 1.708984375, acc5 is 5.322265625, cma_loss is 12.484081268310547, uma_loss is 0.3087206482887268
loss is 12.835614204406738, acc1 is 1.7578125, acc5 is 5.76171875, cma_loss is 12.511139869689941, uma_loss is 0.32447463274002075
loss is 12.848936080932617, acc1 is 2.24609375, acc5 is 6.34765625, cma_loss is 12.54574966430664, uma_loss is 0.303186297416687
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 76.79it/s]
24 epoch loss is 1.5953279586065383,                                    acc1 is 1.708984375, acc5 is 5.667818509615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.45it/s]
 49%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                    | 25/51 [05:16<05:25, 12.53s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.1010
The AUROC of I313 is 45.40
The AUROC of I314 is 48.80
-----------------------------------
The average Sensitivity is 66.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 33.33
-----------------------------------
The average Specificity is 48.0803
The Specificity of I313 is 12.35
The Specificity of I314 is 83.81
-----------------------------------
The average Youden Index is 14.7470
The Youden Index of I313 is 12.35
The Youden Index of I314 is 17.14
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.886798858642578, acc1 is 1.66015625, acc5 is 6.005859375, cma_loss is 12.577159881591797, uma_loss is 0.3096391558647156
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 12.844472885131836, acc1 is 2.001953125, acc5 is 6.4453125, cma_loss is 12.551173210144043, uma_loss is 0.2932993173599243
loss is 12.840497970581055, acc1 is 1.513671875, acc5 is 6.25, cma_loss is 12.529854774475098, uma_loss is 0.3106433153152466
loss is 12.767312049865723, acc1 is 2.001953125, acc5 is 6.8359375, cma_loss is 12.443556785583496, uma_loss is 0.3237556219100952
loss is 12.737709045410156, acc1 is 2.24609375, acc5 is 6.8359375, cma_loss is 12.43470287322998, uma_loss is 0.3030059337615967
loss is 13.006901741027832, acc1 is 1.708984375, acc5 is 6.34765625, cma_loss is 12.705374717712402, uma_loss is 0.3015266954898834
loss is 13.422599792480469, acc1 is 1.220703125, acc5 is 4.541015625, cma_loss is 13.099824905395508, uma_loss is 0.32277536392211914
loss is 13.177340507507324, acc1 is 1.318359375, acc5 is 4.78515625, cma_loss is 12.827228546142578, uma_loss is 0.35011178255081177
loss is 13.329707145690918, acc1 is 1.07421875, acc5 is 4.248046875, cma_loss is 12.99863052368164, uma_loss is 0.3310762345790863
loss is 13.202677726745605, acc1 is 1.904296875, acc5 is 4.833984375, cma_loss is 12.85123348236084, uma_loss is 0.35144421458244324
loss is 13.127385139465332, acc1 is 2.197265625, acc5 is 6.25, cma_loss is 12.750762939453125, uma_loss is 0.3766225576400757
loss is 13.0708646774292, acc1 is 1.220703125, acc5 is 5.126953125, cma_loss is 12.701003074645996, uma_loss is 0.36986175179481506
loss is 13.067184448242188, acc1 is 1.66015625, acc5 is 5.029296875, cma_loss is 12.707923889160156, uma_loss is 0.3592603802680969
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 82.57it/s]
25 epoch loss is 1.6141090665544782,                                    acc1 is 1.6714242788461537, acc5 is 5.656550480769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.18it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                              | 26/51 [05:29<05:14, 12.56s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.7757
The AUROC of I313 is 59.55
The AUROC of I314 is 42.01
-----------------------------------
The average Sensitivity is 63.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 50.00
-----------------------------------
The average Specificity is 55.1781
The Specificity of I313 is 48.20
The Specificity of I314 is 62.16
-----------------------------------
The average Youden Index is 19.0670
The Youden Index of I313 is 25.98
The Youden Index of I314 is 12.16
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.053152084350586, acc1 is 1.85546875, acc5 is 6.005859375, cma_loss is 12.72431468963623, uma_loss is 0.32883769273757935
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.70s/it]
loss is 12.94882869720459, acc1 is 1.318359375, acc5 is 6.34765625, cma_loss is 12.600037574768066, uma_loss is 0.3487909138202667
loss is 12.930084228515625, acc1 is 2.24609375, acc5 is 5.810546875, cma_loss is 12.590564727783203, uma_loss is 0.3395192623138428
loss is 12.78789234161377, acc1 is 2.05078125, acc5 is 6.201171875, cma_loss is 12.439763069152832, uma_loss is 0.3481293022632599
loss is 12.824549674987793, acc1 is 1.85546875, acc5 is 5.517578125, cma_loss is 12.460726737976074, uma_loss is 0.3638225793838501
loss is 12.87155818939209, acc1 is 1.953125, acc5 is 6.0546875, cma_loss is 12.56202507019043, uma_loss is 0.30953288078308105
loss is 12.858741760253906, acc1 is 1.318359375, acc5 is 5.6640625, cma_loss is 12.535643577575684, uma_loss is 0.32309821248054504
loss is 12.83754825592041, acc1 is 2.294921875, acc5 is 6.298828125, cma_loss is 12.507551193237305, uma_loss is 0.3299969732761383
loss is 12.893951416015625, acc1 is 1.953125, acc5 is 6.4453125, cma_loss is 12.570306777954102, uma_loss is 0.3236442804336548
loss is 12.83275318145752, acc1 is 2.24609375, acc5 is 6.640625, cma_loss is 12.494199752807617, uma_loss is 0.3385535478591919
loss is 12.67073917388916, acc1 is 2.490234375, acc5 is 7.568359375, cma_loss is 12.346672058105469, uma_loss is 0.3240671455860138
loss is 12.728193283081055, acc1 is 1.7578125, acc5 is 6.25, cma_loss is 12.410869598388672, uma_loss is 0.3173235356807709
loss is 12.672303199768066, acc1 is 2.1484375, acc5 is 6.103515625, cma_loss is 12.34511661529541, uma_loss is 0.3271868824958801
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 66.46it/s]
26 epoch loss is 1.589621861775716,                                    acc1 is 1.9606370192307692, acc5 is 6.2237079326923075
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.87it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                        | 27/51 [05:43<05:10, 12.93s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 33.2049
The AUROC of I313 is 43.70
The AUROC of I314 is 22.71
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.1405
The Specificity of I313 is 13.28
The Specificity of I314 is 5.00
-----------------------------------
The average Youden Index is 9.1405
The Youden Index of I313 is 13.28
The Youden Index of I314 is 5.00
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.708815574645996, acc1 is 1.953125, acc5 is 6.884765625, cma_loss is 12.413240432739258, uma_loss is 0.2955755591392517
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.04s/it]
loss is 12.774280548095703, acc1 is 2.392578125, acc5 is 7.03125, cma_loss is 12.445050239562988, uma_loss is 0.32923048734664917
loss is 12.741559028625488, acc1 is 2.1484375, acc5 is 6.54296875, cma_loss is 12.418442726135254, uma_loss is 0.32311636209487915
loss is 12.6339750289917, acc1 is 1.904296875, acc5 is 7.763671875, cma_loss is 12.309260368347168, uma_loss is 0.3247149586677551
loss is 12.590154647827148, acc1 is 2.392578125, acc5 is 8.349609375, cma_loss is 12.270462989807129, uma_loss is 0.3196917176246643
loss is 12.605193138122559, acc1 is 2.5390625, acc5 is 7.177734375, cma_loss is 12.316661834716797, uma_loss is 0.2885309159755707
loss is 12.63817024230957, acc1 is 2.099609375, acc5 is 7.666015625, cma_loss is 12.339143753051758, uma_loss is 0.2990269660949707
loss is 12.674006462097168, acc1 is 2.44140625, acc5 is 7.470703125, cma_loss is 12.367920875549316, uma_loss is 0.30608588457107544
loss is 12.667835235595703, acc1 is 2.783203125, acc5 is 7.373046875, cma_loss is 12.369634628295898, uma_loss is 0.29820072650909424
loss is 12.75205135345459, acc1 is 2.1484375, acc5 is 6.8359375, cma_loss is 12.4237699508667, uma_loss is 0.3282810151576996
loss is 12.636088371276855, acc1 is 1.806640625, acc5 is 7.2265625, cma_loss is 12.318663597106934, uma_loss is 0.3174247443675995
loss is 12.696050643920898, acc1 is 2.24609375, acc5 is 7.958984375, cma_loss is 12.366432189941406, uma_loss is 0.32961854338645935
loss is 12.516138076782227, acc1 is 2.587890625, acc5 is 7.666015625, cma_loss is 12.211053848266602, uma_loss is 0.3050841987133026
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 87.23it/s]
27 epoch loss is 1.567945889064244,                                    acc1 is 2.264873798076923, acc5 is 7.380558894230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.20it/s]
 55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                 | 28/51 [05:58<05:15, 13.70s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 56.8462
The AUROC of I313 is 35.90
The AUROC of I314 is 77.79
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 31.3205
The Specificity of I313 is 8.08
The Specificity of I314 is 54.56
-----------------------------------
The average Youden Index is 31.3205
The Youden Index of I313 is 8.08
The Youden Index of I314 is 54.56
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.524848937988281, acc1 is 2.83203125, acc5 is 7.8125, cma_loss is 12.223000526428223, uma_loss is 0.3018481135368347
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.79s/it]
loss is 12.659374237060547, acc1 is 2.392578125, acc5 is 8.203125, cma_loss is 12.342645645141602, uma_loss is 0.31672894954681396
loss is 12.621192932128906, acc1 is 2.44140625, acc5 is 7.861328125, cma_loss is 12.302894592285156, uma_loss is 0.3182978630065918
loss is 12.420567512512207, acc1 is 2.24609375, acc5 is 9.5703125, cma_loss is 12.115227699279785, uma_loss is 0.30533960461616516
loss is 12.458513259887695, acc1 is 2.83203125, acc5 is 8.7890625, cma_loss is 12.14970874786377, uma_loss is 0.30880483984947205
loss is 12.631179809570312, acc1 is 3.076171875, acc5 is 7.91015625, cma_loss is 12.331950187683105, uma_loss is 0.2992299199104309
loss is 12.54306411743164, acc1 is 2.734375, acc5 is 8.7890625, cma_loss is 12.223702430725098, uma_loss is 0.3193613886833191
loss is 12.613325119018555, acc1 is 2.099609375, acc5 is 7.6171875, cma_loss is 12.311104774475098, uma_loss is 0.3022199869155884
loss is 12.579907417297363, acc1 is 3.076171875, acc5 is 8.69140625, cma_loss is 12.28282356262207, uma_loss is 0.2970842719078064
loss is 12.539651870727539, acc1 is 2.5390625, acc5 is 8.203125, cma_loss is 12.221380233764648, uma_loss is 0.31827205419540405
loss is 12.54435920715332, acc1 is 2.9296875, acc5 is 7.958984375, cma_loss is 12.223146438598633, uma_loss is 0.3212130665779114
loss is 12.610462188720703, acc1 is 1.806640625, acc5 is 7.568359375, cma_loss is 12.290148735046387, uma_loss is 0.32031378149986267
loss is 12.510272026062012, acc1 is 2.587890625, acc5 is 8.88671875, cma_loss is 12.203189849853516, uma_loss is 0.30708256363868713
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 77.00it/s]
28 epoch loss is 1.5548258917672293,                                    acc1 is 2.5841346153846154, acc5 is 8.297025240384615
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.82it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                           | 29/51 [06:11<04:55, 13.44s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 54.3387
The AUROC of I313 is 45.32
The AUROC of I314 is 63.36
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 43.6630
The Specificity of I313 is 25.43
The Specificity of I314 is 61.89
-----------------------------------
The average Youden Index is 35.3297
The Youden Index of I313 is 25.43
The Youden Index of I314 is 45.23
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.457840919494629, acc1 is 2.587890625, acc5 is 8.154296875, cma_loss is 12.156938552856445, uma_loss is 0.3009023666381836
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 12.566449165344238, acc1 is 2.685546875, acc5 is 8.49609375, cma_loss is 12.261466979980469, uma_loss is 0.30498233437538147
loss is 12.58457088470459, acc1 is 2.44140625, acc5 is 8.251953125, cma_loss is 12.261934280395508, uma_loss is 0.32263660430908203
loss is 12.202764511108398, acc1 is 3.173828125, acc5 is 10.302734375, cma_loss is 11.892515182495117, uma_loss is 0.3102489113807678
loss is 12.363533020019531, acc1 is 2.978515625, acc5 is 8.7890625, cma_loss is 12.053730010986328, uma_loss is 0.30980345606803894
loss is 12.43881893157959, acc1 is 3.22265625, acc5 is 10.205078125, cma_loss is 12.147552490234375, uma_loss is 0.29126638174057007
loss is 12.377035140991211, acc1 is 3.466796875, acc5 is 9.130859375, cma_loss is 12.087467193603516, uma_loss is 0.289567768573761
loss is 12.332549095153809, acc1 is 3.41796875, acc5 is 9.912109375, cma_loss is 12.035609245300293, uma_loss is 0.29693979024887085
loss is 12.3839693069458, acc1 is 3.515625, acc5 is 9.033203125, cma_loss is 12.100513458251953, uma_loss is 0.28345587849617004
loss is 12.398833274841309, acc1 is 2.83203125, acc5 is 8.984375, cma_loss is 12.100924491882324, uma_loss is 0.2979086637496948
loss is 12.343435287475586, acc1 is 3.076171875, acc5 is 8.7890625, cma_loss is 12.051907539367676, uma_loss is 0.291527658700943
loss is 12.434152603149414, acc1 is 2.978515625, acc5 is 8.49609375, cma_loss is 12.12995719909668, uma_loss is 0.3041955828666687
loss is 12.322321891784668, acc1 is 3.857421875, acc5 is 9.47265625, cma_loss is 12.029176712036133, uma_loss is 0.29314520955085754
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 90.00it/s]
29 epoch loss is 1.535297847929455,                                    acc1 is 3.094951923076923, acc5 is 9.078275240384615
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.35it/s]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                     | 30/51 [06:23<04:33, 13.04s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 73.4562
The AUROC of I313 is 68.10
The AUROC of I314 is 78.81
-----------------------------------
The average Sensitivity is 72.2222
The Sensitivity of I313 is 44.44
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 72.6376
The Specificity of I313 is 86.05
The Specificity of I314 is 59.23
-----------------------------------
The average Youden Index is 44.8598
The Youden Index of I313 is 30.49
The Youden Index of I314 is 59.23
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.367443084716797, acc1 is 3.271484375, acc5 is 8.69140625, cma_loss is 12.061538696289062, uma_loss is 0.30590391159057617
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 12.245361328125, acc1 is 3.515625, acc5 is 9.814453125, cma_loss is 11.955228805541992, uma_loss is 0.29013216495513916
loss is 12.388195991516113, acc1 is 2.5390625, acc5 is 8.642578125, cma_loss is 12.099424362182617, uma_loss is 0.28877192735671997
loss is 12.202032089233398, acc1 is 3.369140625, acc5 is 10.986328125, cma_loss is 11.908072471618652, uma_loss is 0.29395967721939087
loss is 12.23306655883789, acc1 is 3.466796875, acc5 is 10.44921875, cma_loss is 11.935750961303711, uma_loss is 0.29731571674346924
loss is 12.470043182373047, acc1 is 3.22265625, acc5 is 9.66796875, cma_loss is 12.165191650390625, uma_loss is 0.3048519492149353
loss is 12.304298400878906, acc1 is 3.61328125, acc5 is 8.88671875, cma_loss is 12.012826919555664, uma_loss is 0.29147154092788696
loss is 12.3110990524292, acc1 is 2.783203125, acc5 is 9.619140625, cma_loss is 12.012479782104492, uma_loss is 0.29861903190612793
loss is 12.271864891052246, acc1 is 4.052734375, acc5 is 10.7421875, cma_loss is 11.978408813476562, uma_loss is 0.293456494808197
loss is 12.38708209991455, acc1 is 2.9296875, acc5 is 8.30078125, cma_loss is 12.09255599975586, uma_loss is 0.2945258617401123
loss is 12.272989273071289, acc1 is 4.052734375, acc5 is 10.205078125, cma_loss is 11.975118637084961, uma_loss is 0.297870397567749
loss is 12.383304595947266, acc1 is 2.685546875, acc5 is 8.837890625, cma_loss is 12.082265853881836, uma_loss is 0.30103862285614014
loss is 12.322836875915527, acc1 is 3.271484375, acc5 is 9.66796875, cma_loss is 12.010583877563477, uma_loss is 0.31225335597991943
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.52it/s]
30 epoch loss is 1.525329689752488,                                    acc1 is 3.290264423076923, acc5 is 9.57782451923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.35it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                              | 31/51 [06:35<04:16, 12.81s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 76.7317
The AUROC of I313 is 69.91
The AUROC of I314 is 83.56
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 74.0245
The Specificity of I313 is 73.90
The Specificity of I314 is 74.15
-----------------------------------
The average Youden Index is 57.3579
The Youden Index of I313 is 40.57
The Youden Index of I314 is 74.15
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.177924156188965, acc1 is 2.9296875, acc5 is 8.349609375, cma_loss is 11.90749454498291, uma_loss is 0.2704295814037323
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 12.202510833740234, acc1 is 3.80859375, acc5 is 10.693359375, cma_loss is 11.915000915527344, uma_loss is 0.2875099182128906
loss is 12.313311576843262, acc1 is 3.369140625, acc5 is 8.7890625, cma_loss is 12.026297569274902, uma_loss is 0.2870136797428131
loss is 12.112653732299805, acc1 is 4.052734375, acc5 is 10.986328125, cma_loss is 11.82372760772705, uma_loss is 0.28892579674720764
loss is 11.953264236450195, acc1 is 4.345703125, acc5 is 11.962890625, cma_loss is 11.667743682861328, uma_loss is 0.2855204939842224
loss is 12.153444290161133, acc1 is 3.90625, acc5 is 11.767578125, cma_loss is 11.856413841247559, uma_loss is 0.2970304787158966
loss is 12.220996856689453, acc1 is 3.759765625, acc5 is 10.498046875, cma_loss is 11.934883117675781, uma_loss is 0.2861138582229614
loss is 12.275832176208496, acc1 is 3.7109375, acc5 is 10.595703125, cma_loss is 11.973716735839844, uma_loss is 0.30211544036865234
loss is 12.23327922821045, acc1 is 3.90625, acc5 is 10.7421875, cma_loss is 11.951375961303711, uma_loss is 0.2819032669067383
loss is 12.107924461364746, acc1 is 3.564453125, acc5 is 10.986328125, cma_loss is 11.836020469665527, uma_loss is 0.2719043493270874
loss is 12.095131874084473, acc1 is 3.759765625, acc5 is 10.498046875, cma_loss is 11.817106246948242, uma_loss is 0.27802571654319763
loss is 12.244054794311523, acc1 is 3.22265625, acc5 is 9.619140625, cma_loss is 11.95787239074707, uma_loss is 0.2861820459365845
loss is 12.222126007080078, acc1 is 3.41796875, acc5 is 9.66796875, cma_loss is 11.937359809875488, uma_loss is 0.28476619720458984
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 72.35it/s]
31 epoch loss is 1.5077376592726934,                                    acc1 is 3.6733774038461537, acc5 is 10.396634615384615
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.68it/s]
 63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                        | 32/51 [06:48<04:00, 12.64s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.6447
The AUROC of I313 is 85.01
The AUROC of I314 is 30.28
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 33.9049
The Specificity of I313 is 60.88
The Specificity of I314 is 6.93
-----------------------------------
The average Youden Index is 33.9049
The Youden Index of I313 is 60.88
The Youden Index of I314 is 6.93
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.015851020812988, acc1 is 3.662109375, acc5 is 9.716796875, cma_loss is 11.737165451049805, uma_loss is 0.2786853313446045
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 12.109343528747559, acc1 is 3.80859375, acc5 is 11.03515625, cma_loss is 11.82956314086914, uma_loss is 0.2797800898551941
loss is 12.201539993286133, acc1 is 3.7109375, acc5 is 9.66796875, cma_loss is 11.909212112426758, uma_loss is 0.29232823848724365
loss is 12.065543174743652, acc1 is 3.076171875, acc5 is 10.546875, cma_loss is 11.80203914642334, uma_loss is 0.2635042667388916
loss is 12.021120071411133, acc1 is 4.00390625, acc5 is 11.5234375, cma_loss is 11.737678527832031, uma_loss is 0.2834413945674896
loss is 12.181219100952148, acc1 is 3.662109375, acc5 is 11.669921875, cma_loss is 11.918137550354004, uma_loss is 0.2630819082260132
loss is 11.9563570022583, acc1 is 4.39453125, acc5 is 12.060546875, cma_loss is 11.68123722076416, uma_loss is 0.27511945366859436
loss is 11.824516296386719, acc1 is 4.443359375, acc5 is 12.939453125, cma_loss is 11.57525634765625, uma_loss is 0.2492598444223404
loss is 11.981514930725098, acc1 is 5.46875, acc5 is 13.4765625, cma_loss is 11.702581405639648, uma_loss is 0.2789331078529358
loss is 11.896171569824219, acc1 is 4.58984375, acc5 is 12.890625, cma_loss is 11.636302947998047, uma_loss is 0.2598685622215271
loss is 11.961606979370117, acc1 is 3.80859375, acc5 is 10.791015625, cma_loss is 11.67497444152832, uma_loss is 0.28663206100463867
loss is 11.87231731414795, acc1 is 4.1015625, acc5 is 12.890625, cma_loss is 11.590892791748047, uma_loss is 0.28142476081848145
loss is 11.988165855407715, acc1 is 4.4921875, acc5 is 11.669921875, cma_loss is 11.711782455444336, uma_loss is 0.2763829827308655
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 75.97it/s]
32 epoch loss is 1.4864311127435594,                                    acc1 is 4.094050480769231, acc5 is 11.606069711538462
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.35it/s]
 65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                  | 33/51 [07:00<03:46, 12.60s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.0233
The AUROC of I313 is 73.86
The AUROC of I314 is 22.19
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 32.6005
The Specificity of I313 is 55.54
The Specificity of I314 is 9.66
-----------------------------------
The average Youden Index is 27.0449
The Youden Index of I313 is 44.43
The Youden Index of I314 is 9.66
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.840862274169922, acc1 is 4.6875, acc5 is 13.134765625, cma_loss is 11.595527648925781, uma_loss is 0.24533432722091675
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.62s/it]
loss is 11.870255470275879, acc1 is 4.4921875, acc5 is 11.865234375, cma_loss is 11.6290922164917, uma_loss is 0.24116355180740356
loss is 11.933496475219727, acc1 is 4.00390625, acc5 is 11.962890625, cma_loss is 11.665842056274414, uma_loss is 0.26765403151512146
loss is 11.722033500671387, acc1 is 5.029296875, acc5 is 13.57421875, cma_loss is 11.474640846252441, uma_loss is 0.2473922222852707
loss is 11.838494300842285, acc1 is 5.078125, acc5 is 12.40234375, cma_loss is 11.555654525756836, uma_loss is 0.28284013271331787
loss is 11.852926254272461, acc1 is 4.39453125, acc5 is 11.865234375, cma_loss is 11.593809127807617, uma_loss is 0.25911664962768555
loss is 11.926265716552734, acc1 is 5.322265625, acc5 is 13.525390625, cma_loss is 11.648853302001953, uma_loss is 0.2774125337600708
loss is 12.036548614501953, acc1 is 4.4921875, acc5 is 12.3046875, cma_loss is 11.760828018188477, uma_loss is 0.27572011947631836
loss is 12.120678901672363, acc1 is 4.443359375, acc5 is 11.62109375, cma_loss is 11.851442337036133, uma_loss is 0.26923686265945435
loss is 12.0182466506958, acc1 is 4.6875, acc5 is 12.5, cma_loss is 11.759428024291992, uma_loss is 0.2588183879852295
loss is 11.867356300354004, acc1 is 4.19921875, acc5 is 11.767578125, cma_loss is 11.605552673339844, uma_loss is 0.26180365681648254
loss is 12.089499473571777, acc1 is 4.248046875, acc5 is 11.23046875, cma_loss is 11.814817428588867, uma_loss is 0.27468159794807434
loss is 11.883829116821289, acc1 is 4.736328125, acc5 is 13.037109375, cma_loss is 11.609674453735352, uma_loss is 0.2741548418998718
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 75.36it/s]
33 epoch loss is 1.476195171901158,                                    acc1 is 4.601111778846154, acc5 is 12.368539663461538
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.10it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                           | 34/51 [07:12<03:32, 12.50s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 53.9511
The AUROC of I313 is 55.57
The AUROC of I314 is 52.33
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 50.00
-----------------------------------
The average Specificity is 60.3161
The Specificity of I313 is 56.34
The Specificity of I314 is 64.29
-----------------------------------
The average Youden Index is 18.6495
The Youden Index of I313 is 23.01
The Youden Index of I314 is 14.29
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.775811195373535, acc1 is 4.541015625, acc5 is 12.744140625, cma_loss is 11.520095825195312, uma_loss is 0.255715548992157
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.53s/it]
loss is 11.828119277954102, acc1 is 4.345703125, acc5 is 13.330078125, cma_loss is 11.553634643554688, uma_loss is 0.27448511123657227
loss is 11.837226867675781, acc1 is 3.955078125, acc5 is 11.572265625, cma_loss is 11.567176818847656, uma_loss is 0.2700502872467041
loss is 11.701653480529785, acc1 is 5.419921875, acc5 is 13.720703125, cma_loss is 11.437582015991211, uma_loss is 0.2640715539455414
loss is 11.661636352539062, acc1 is 5.37109375, acc5 is 14.111328125, cma_loss is 11.392847061157227, uma_loss is 0.26878929138183594
loss is 11.746747016906738, acc1 is 4.58984375, acc5 is 13.916015625, cma_loss is 11.472066879272461, uma_loss is 0.2746802270412445
loss is 11.545455932617188, acc1 is 5.76171875, acc5 is 14.990234375, cma_loss is 11.279435157775879, uma_loss is 0.26602062582969666
loss is 11.54987621307373, acc1 is 6.640625, acc5 is 16.259765625, cma_loss is 11.28582763671875, uma_loss is 0.26404857635498047
loss is 11.789080619812012, acc1 is 5.95703125, acc5 is 14.306640625, cma_loss is 11.529333114624023, uma_loss is 0.25974705815315247
loss is 11.704283714294434, acc1 is 6.005859375, acc5 is 14.453125, cma_loss is 11.420743942260742, uma_loss is 0.28353941440582275
loss is 11.594733238220215, acc1 is 5.17578125, acc5 is 13.720703125, cma_loss is 11.335241317749023, uma_loss is 0.25949203968048096
loss is 11.683662414550781, acc1 is 5.419921875, acc5 is 14.404296875, cma_loss is 11.41238784790039, uma_loss is 0.27127450704574585
loss is 11.63424301147461, acc1 is 5.17578125, acc5 is 14.111328125, cma_loss is 11.364258766174316, uma_loss is 0.2699841856956482
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 108.63it/s]
34 epoch loss is 1.4481193270002093,                                    acc1 is 5.258413461538462, acc5 is 13.97235576923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.54it/s]
 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                     | 35/51 [07:25<03:19, 12.44s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 62.7657
The AUROC of I313 is 64.94
The AUROC of I314 is 60.59
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 43.4130
The Specificity of I313 is 41.92
The Specificity of I314 is 44.90
-----------------------------------
The average Youden Index is 43.4130
The Youden Index of I313 is 41.92
The Youden Index of I314 is 44.90
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.633285522460938, acc1 is 5.029296875, acc5 is 13.28125, cma_loss is 11.37447738647461, uma_loss is 0.25880807638168335
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.58s/it]
loss is 11.524171829223633, acc1 is 5.810546875, acc5 is 15.673828125, cma_loss is 11.269309997558594, uma_loss is 0.25486135482788086
loss is 11.714902877807617, acc1 is 5.37109375, acc5 is 13.37890625, cma_loss is 11.460559844970703, uma_loss is 0.2543434202671051
loss is 11.518819808959961, acc1 is 5.615234375, acc5 is 15.8203125, cma_loss is 11.263300895690918, uma_loss is 0.25551843643188477
loss is 11.455166816711426, acc1 is 6.640625, acc5 is 16.455078125, cma_loss is 11.215116500854492, uma_loss is 0.24005025625228882
loss is 11.856119155883789, acc1 is 4.58984375, acc5 is 13.134765625, cma_loss is 11.615375518798828, uma_loss is 0.24074381589889526
loss is 11.86108684539795, acc1 is 4.19921875, acc5 is 12.548828125, cma_loss is 11.602642059326172, uma_loss is 0.2584451138973236
loss is 11.545506477355957, acc1 is 5.810546875, acc5 is 15.673828125, cma_loss is 11.30023193359375, uma_loss is 0.24527420103549957
loss is 11.567591667175293, acc1 is 6.005859375, acc5 is 16.064453125, cma_loss is 11.317184448242188, uma_loss is 0.25040704011917114
loss is 11.714883804321289, acc1 is 5.17578125, acc5 is 13.8671875, cma_loss is 11.466350555419922, uma_loss is 0.24853304028511047
loss is 11.692715644836426, acc1 is 4.78515625, acc5 is 13.76953125, cma_loss is 11.433073043823242, uma_loss is 0.25964245200157166
loss is 11.708351135253906, acc1 is 4.6875, acc5 is 13.8671875, cma_loss is 11.456380844116211, uma_loss is 0.251970499753952
loss is 11.615694999694824, acc1 is 5.517578125, acc5 is 14.55078125, cma_loss is 11.373098373413086, uma_loss is 0.24259629845619202
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 76.39it/s]
35 epoch loss is 1.4419837770007906,                                    acc1 is 5.326021634615385, acc5 is 14.468149038461538
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.41it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                               | 36/51 [07:37<03:06, 12.42s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 38.0812
The AUROC of I313 is 60.30
The AUROC of I314 is 15.87
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 22.4541
The Specificity of I313 is 35.71
The Specificity of I314 is 9.19
-----------------------------------
The average Youden Index is 16.8985
The Youden Index of I313 is 24.60
The Youden Index of I314 is 9.19
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.51187515258789, acc1 is 6.201171875, acc5 is 14.599609375, cma_loss is 11.264169692993164, uma_loss is 0.24770523607730865
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 11.463504791259766, acc1 is 5.76171875, acc5 is 16.11328125, cma_loss is 11.212442398071289, uma_loss is 0.251062273979187
loss is 11.6644868850708, acc1 is 5.810546875, acc5 is 14.697265625, cma_loss is 11.409719467163086, uma_loss is 0.2547675669193268
loss is 11.485708236694336, acc1 is 4.98046875, acc5 is 14.84375, cma_loss is 11.242494583129883, uma_loss is 0.24321407079696655
loss is 11.370333671569824, acc1 is 6.34765625, acc5 is 16.064453125, cma_loss is 11.121650695800781, uma_loss is 0.24868270754814148
loss is 11.639124870300293, acc1 is 5.419921875, acc5 is 15.283203125, cma_loss is 11.399080276489258, uma_loss is 0.2400445193052292
loss is 11.565336227416992, acc1 is 6.93359375, acc5 is 16.552734375, cma_loss is 11.3098783493042, uma_loss is 0.25545772910118103
loss is 11.450091361999512, acc1 is 6.8359375, acc5 is 16.650390625, cma_loss is 11.19052505493164, uma_loss is 0.25956594944000244
loss is 11.549151420593262, acc1 is 6.4453125, acc5 is 16.162109375, cma_loss is 11.295234680175781, uma_loss is 0.25391680002212524
loss is 11.62204360961914, acc1 is 4.931640625, acc5 is 14.306640625, cma_loss is 11.369611740112305, uma_loss is 0.2524317502975464
loss is 11.470538139343262, acc1 is 6.201171875, acc5 is 15.13671875, cma_loss is 11.213455200195312, uma_loss is 0.2570829391479492
loss is 11.546181678771973, acc1 is 5.46875, acc5 is 15.0390625, cma_loss is 11.30676555633545, uma_loss is 0.23941653966903687
loss is 11.489588737487793, acc1 is 5.95703125, acc5 is 14.892578125, cma_loss is 11.230259895324707, uma_loss is 0.25932860374450684
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 79.40it/s]
36 epoch loss is 1.4269329979306176,                                    acc1 is 5.945763221153846, acc5 is 15.410907451923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.24it/s]
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                        | 37/51 [07:50<02:54, 12.46s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 41.2665
The AUROC of I313 is 69.93
The AUROC of I314 is 12.60
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 42.1200
The Specificity of I313 is 81.44
The Specificity of I314 is 2.80
-----------------------------------
The average Youden Index is 25.4534
The Youden Index of I313 is 48.11
The Youden Index of I314 is 2.80
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.388307571411133, acc1 is 6.640625, acc5 is 15.33203125, cma_loss is 11.173896789550781, uma_loss is 0.21441057324409485
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 11.410148620605469, acc1 is 6.005859375, acc5 is 17.138671875, cma_loss is 11.159570693969727, uma_loss is 0.2505776584148407
loss is 11.401896476745605, acc1 is 6.201171875, acc5 is 15.0390625, cma_loss is 11.167430877685547, uma_loss is 0.2344658374786377
loss is 11.213570594787598, acc1 is 6.396484375, acc5 is 18.310546875, cma_loss is 10.96718978881836, uma_loss is 0.24638094007968903
loss is 11.083672523498535, acc1 is 7.080078125, acc5 is 17.96875, cma_loss is 10.842308044433594, uma_loss is 0.24136415123939514
loss is 11.4391508102417, acc1 is 6.005859375, acc5 is 16.162109375, cma_loss is 11.200071334838867, uma_loss is 0.23907914757728577
loss is 11.535737037658691, acc1 is 5.6640625, acc5 is 14.990234375, cma_loss is 11.289113998413086, uma_loss is 0.24662326276302338
loss is 11.382185935974121, acc1 is 5.908203125, acc5 is 16.11328125, cma_loss is 11.126346588134766, uma_loss is 0.25583896040916443
loss is 11.129091262817383, acc1 is 7.71484375, acc5 is 17.96875, cma_loss is 10.893125534057617, uma_loss is 0.23596571385860443
loss is 11.31115436553955, acc1 is 6.884765625, acc5 is 16.943359375, cma_loss is 11.062649726867676, uma_loss is 0.24850495159626007
loss is 11.073131561279297, acc1 is 7.666015625, acc5 is 18.45703125, cma_loss is 10.822160720825195, uma_loss is 0.2509704828262329
loss is 11.0731201171875, acc1 is 6.787109375, acc5 is 17.578125, cma_loss is 10.817460060119629, uma_loss is 0.2556602358818054
loss is 11.212650299072266, acc1 is 7.32421875, acc5 is 18.310546875, cma_loss is 10.941362380981445, uma_loss is 0.2712874412536621
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 46.22it/s]
37 epoch loss is 1.396703020731608,                                    acc1 is 6.636868990384615, acc5 is 16.947115384615383
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.53it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                  | 38/51 [08:02<02:40, 12.38s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.3076
The AUROC of I313 is 74.33
The AUROC of I314 is 20.29
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 44.4213
The Specificity of I313 is 84.25
The Specificity of I314 is 4.60
-----------------------------------
The average Youden Index is 27.7546
The Youden Index of I313 is 50.91
The Youden Index of I314 is 4.60
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.026999473571777, acc1 is 7.470703125, acc5 is 18.896484375, cma_loss is 10.779086112976074, uma_loss is 0.24791337549686432
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 11.067220687866211, acc1 is 7.32421875, acc5 is 18.9453125, cma_loss is 10.818408966064453, uma_loss is 0.24881143867969513
loss is 11.19588565826416, acc1 is 7.373046875, acc5 is 17.48046875, cma_loss is 10.956666946411133, uma_loss is 0.23921826481819153
loss is 10.925736427307129, acc1 is 7.8125, acc5 is 19.677734375, cma_loss is 10.67173957824707, uma_loss is 0.25399643182754517
loss is 10.839323997497559, acc1 is 8.447265625, acc5 is 21.38671875, cma_loss is 10.58763313293457, uma_loss is 0.25169092416763306
loss is 11.13361644744873, acc1 is 7.71484375, acc5 is 18.994140625, cma_loss is 10.870923042297363, uma_loss is 0.2626931071281433
loss is 11.021194458007812, acc1 is 8.3984375, acc5 is 19.384765625, cma_loss is 10.781669616699219, uma_loss is 0.23952524363994598
loss is 11.027322769165039, acc1 is 7.8125, acc5 is 21.630859375, cma_loss is 10.752307891845703, uma_loss is 0.2750149965286255
loss is 10.948625564575195, acc1 is 8.447265625, acc5 is 19.921875, cma_loss is 10.701427459716797, uma_loss is 0.24719829857349396
loss is 11.179766654968262, acc1 is 7.080078125, acc5 is 17.96875, cma_loss is 10.92302131652832, uma_loss is 0.25674575567245483
loss is 10.86921215057373, acc1 is 7.958984375, acc5 is 20.3125, cma_loss is 10.612932205200195, uma_loss is 0.25627994537353516
loss is 10.909775733947754, acc1 is 7.51953125, acc5 is 20.703125, cma_loss is 10.66767406463623, uma_loss is 0.24210122227668762
loss is 10.861160278320312, acc1 is 7.03125, acc5 is 19.3359375, cma_loss is 10.601120948791504, uma_loss is 0.260039746761322
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 77.76it/s]
38 epoch loss is 1.3619603838239398,                                    acc1 is 7.722355769230769, acc5 is 19.58759014423077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.60it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                            | 39/51 [08:15<02:30, 12.53s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.1821
The AUROC of I313 is 66.76
The AUROC of I314 is 31.60
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 30.9698
The Specificity of I313 is 57.14
The Specificity of I314 is 4.80
-----------------------------------
The average Youden Index is 19.8587
The Youden Index of I313 is 34.92
The Youden Index of I314 is 4.80
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.964930534362793, acc1 is 7.6171875, acc5 is 19.091796875, cma_loss is 10.72304916381836, uma_loss is 0.24188092350959778
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.53s/it]
loss is 10.955009460449219, acc1 is 8.154296875, acc5 is 20.654296875, cma_loss is 10.70129108428955, uma_loss is 0.2537180483341217
loss is 11.0594482421875, acc1 is 7.275390625, acc5 is 19.3359375, cma_loss is 10.770055770874023, uma_loss is 0.28939247131347656
loss is 10.891312599182129, acc1 is 8.837890625, acc5 is 20.458984375, cma_loss is 10.652168273925781, uma_loss is 0.23914456367492676
loss is 11.006880760192871, acc1 is 8.69140625, acc5 is 19.921875, cma_loss is 10.72376537322998, uma_loss is 0.2831156253814697
loss is 10.94039249420166, acc1 is 7.373046875, acc5 is 20.703125, cma_loss is 10.669795989990234, uma_loss is 0.2705966830253601
loss is 10.86721134185791, acc1 is 8.59375, acc5 is 21.09375, cma_loss is 10.623204231262207, uma_loss is 0.24400684237480164
loss is 10.782861709594727, acc1 is 8.447265625, acc5 is 21.826171875, cma_loss is 10.522344589233398, uma_loss is 0.2605166733264923
loss is 10.693915367126465, acc1 is 9.326171875, acc5 is 21.533203125, cma_loss is 10.445829391479492, uma_loss is 0.24808615446090698
loss is 10.913293838500977, acc1 is 9.228515625, acc5 is 20.21484375, cma_loss is 10.653858184814453, uma_loss is 0.25943517684936523
loss is 10.955179214477539, acc1 is 7.12890625, acc5 is 19.53125, cma_loss is 10.69759750366211, uma_loss is 0.2575814127922058
loss is 10.868513107299805, acc1 is 8.30078125, acc5 is 21.240234375, cma_loss is 10.624574661254883, uma_loss is 0.2439386248588562
loss is 10.759273529052734, acc1 is 8.0078125, acc5 is 21.435546875, cma_loss is 10.51730728149414, uma_loss is 0.24196629226207733
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 86.05it/s]
39 epoch loss is 1.3491259256998698,                                    acc1 is 8.229417067307692, acc5 is 20.54161658653846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.43it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                     | 40/51 [08:27<02:16, 12.44s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.0821
The AUROC of I313 is 70.21
The AUROC of I314 is 21.95
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 40.1110
The Specificity of I313 is 71.09
The Specificity of I314 is 9.13
-----------------------------------
The average Youden Index is 23.4444
The Youden Index of I313 is 37.76
The Youden Index of I314 is 9.13
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.658326148986816, acc1 is 8.935546875, acc5 is 21.875, cma_loss is 10.423479080200195, uma_loss is 0.234847292304039
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 10.529178619384766, acc1 is 8.59375, acc5 is 23.6328125, cma_loss is 10.291553497314453, uma_loss is 0.23762528598308563
loss is 10.813165664672852, acc1 is 8.349609375, acc5 is 18.994140625, cma_loss is 10.56494140625, uma_loss is 0.24822404980659485
loss is 10.944052696228027, acc1 is 7.177734375, acc5 is 19.23828125, cma_loss is 10.704051971435547, uma_loss is 0.2400008738040924
loss is 10.708047866821289, acc1 is 10.05859375, acc5 is 21.826171875, cma_loss is 10.445457458496094, uma_loss is 0.2625904083251953
loss is 10.82362174987793, acc1 is 8.7890625, acc5 is 21.533203125, cma_loss is 10.585850715637207, uma_loss is 0.23777078092098236
loss is 10.713345527648926, acc1 is 8.984375, acc5 is 22.900390625, cma_loss is 10.459234237670898, uma_loss is 0.2541115880012512
loss is 10.826448440551758, acc1 is 8.10546875, acc5 is 21.58203125, cma_loss is 10.579360961914062, uma_loss is 0.247087299823761
loss is 10.616280555725098, acc1 is 8.837890625, acc5 is 22.900390625, cma_loss is 10.365039825439453, uma_loss is 0.2512405514717102
loss is 10.738069534301758, acc1 is 9.326171875, acc5 is 21.484375, cma_loss is 10.503684997558594, uma_loss is 0.23438477516174316
loss is 10.745434761047363, acc1 is 8.30078125, acc5 is 21.38671875, cma_loss is 10.501758575439453, uma_loss is 0.24367617070674896
loss is 10.559454917907715, acc1 is 9.27734375, acc5 is 24.462890625, cma_loss is 10.303558349609375, uma_loss is 0.2558962106704712
loss is 10.541386604309082, acc1 is 8.203125, acc5 is 22.265625, cma_loss is 10.30305290222168, uma_loss is 0.2383333444595337
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 83.74it/s]
40 epoch loss is 1.325874410356794,                                    acc1 is 8.687650240384615, acc5 is 21.852463942307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.51it/s]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 41/51 [08:39<02:04, 12.44s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.0870
The AUROC of I313 is 69.57
The AUROC of I314 is 22.61
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 40.6453
The Specificity of I313 is 72.36
The Specificity of I314 is 8.93
-----------------------------------
The average Youden Index is 23.9786
The Youden Index of I313 is 39.03
The Youden Index of I314 is 8.93
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.458183288574219, acc1 is 8.984375, acc5 is 22.16796875, cma_loss is 10.220525741577148, uma_loss is 0.2376573085784912
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 10.356999397277832, acc1 is 10.205078125, acc5 is 24.51171875, cma_loss is 10.131267547607422, uma_loss is 0.22573184967041016
loss is 10.486761093139648, acc1 is 10.3515625, acc5 is 23.681640625, cma_loss is 10.242670059204102, uma_loss is 0.24409130215644836
loss is 10.34813117980957, acc1 is 9.5703125, acc5 is 23.73046875, cma_loss is 10.122984886169434, uma_loss is 0.2251460701227188
loss is 10.447502136230469, acc1 is 10.546875, acc5 is 23.92578125, cma_loss is 10.220525741577148, uma_loss is 0.2269763946533203
loss is 10.50320816040039, acc1 is 9.47265625, acc5 is 23.6328125, cma_loss is 10.261290550231934, uma_loss is 0.24191802740097046
loss is 10.665270805358887, acc1 is 9.326171875, acc5 is 22.900390625, cma_loss is 10.44180679321289, uma_loss is 0.22346389293670654
loss is 10.371731758117676, acc1 is 9.27734375, acc5 is 25.830078125, cma_loss is 10.139476776123047, uma_loss is 0.23225460946559906
loss is 10.429417610168457, acc1 is 10.05859375, acc5 is 23.779296875, cma_loss is 10.208123207092285, uma_loss is 0.2212943732738495
loss is 10.648459434509277, acc1 is 9.47265625, acc5 is 21.97265625, cma_loss is 10.410707473754883, uma_loss is 0.2377515584230423
loss is 10.555923461914062, acc1 is 9.912109375, acc5 is 23.681640625, cma_loss is 10.335151672363281, uma_loss is 0.22077158093452454
loss is 10.397309303283691, acc1 is 10.302734375, acc5 is 24.0234375, cma_loss is 10.149381637573242, uma_loss is 0.24792805314064026
loss is 10.22265625, acc1 is 9.912109375, acc5 is 24.755859375, cma_loss is 9.99450397491455, uma_loss is 0.22815200686454773
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 94.63it/s]
41 epoch loss is 1.2942052750360398,                                    acc1 is 9.799429086538462, acc5 is 23.73798076923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.32it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 42/51 [08:52<01:51, 12.39s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 42.2175
The AUROC of I313 is 67.82
The AUROC of I314 is 16.61
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 27.1977
The Specificity of I313 is 49.20
The Specificity of I314 is 5.20
-----------------------------------
The average Youden Index is 21.6422
The Youden Index of I313 is 38.09
The Youden Index of I314 is 5.20
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.344890594482422, acc1 is 9.619140625, acc5 is 24.365234375, cma_loss is 10.10890007019043, uma_loss is 0.23599092662334442
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 10.351414680480957, acc1 is 10.3515625, acc5 is 24.90234375, cma_loss is 10.117815017700195, uma_loss is 0.23360000550746918
loss is 10.462944984436035, acc1 is 9.47265625, acc5 is 23.73046875, cma_loss is 10.238000869750977, uma_loss is 0.22494447231292725
loss is 10.20116138458252, acc1 is 10.595703125, acc5 is 26.7578125, cma_loss is 9.95732593536377, uma_loss is 0.24383540451526642
loss is 10.225589752197266, acc1 is 11.181640625, acc5 is 25.439453125, cma_loss is 10.010939598083496, uma_loss is 0.21465006470680237
loss is 10.449631690979004, acc1 is 9.716796875, acc5 is 24.12109375, cma_loss is 10.202383041381836, uma_loss is 0.24724896252155304
loss is 10.380929946899414, acc1 is 10.205078125, acc5 is 23.486328125, cma_loss is 10.172089576721191, uma_loss is 0.2088402509689331
loss is 10.183370590209961, acc1 is 11.474609375, acc5 is 27.734375, cma_loss is 9.966772079467773, uma_loss is 0.21659813821315765
loss is 10.131736755371094, acc1 is 12.01171875, acc5 is 25.390625, cma_loss is 9.906688690185547, uma_loss is 0.2250482141971588
loss is 10.355050086975098, acc1 is 11.23046875, acc5 is 24.755859375, cma_loss is 10.142515182495117, uma_loss is 0.21253477036952972
loss is 10.268263816833496, acc1 is 10.107421875, acc5 is 24.4140625, cma_loss is 10.044994354248047, uma_loss is 0.2232694923877716
loss is 10.297548294067383, acc1 is 10.791015625, acc5 is 24.90234375, cma_loss is 10.081535339355469, uma_loss is 0.2160128504037857
loss is 9.956846237182617, acc1 is 13.232421875, acc5 is 29.78515625, cma_loss is 9.742856979370117, uma_loss is 0.21398968994617462
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 76.68it/s]
42 epoch loss is 1.2724702744256882,                                    acc1 is 10.768479567307692, acc5 is 25.368088942307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.42it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 43/51 [09:04<01:38, 12.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 49.2720
The AUROC of I313 is 78.91
The AUROC of I314 is 19.63
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 32.0028
The Specificity of I313 is 57.48
The Specificity of I314 is 6.53
-----------------------------------
The average Youden Index is 32.0028
The Youden Index of I313 is 57.48
The Youden Index of I314 is 6.53
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.855616569519043, acc1 is 12.255859375, acc5 is 27.587890625, cma_loss is 9.65363883972168, uma_loss is 0.20197759568691254
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.50s/it]
loss is 9.818941116333008, acc1 is 11.474609375, acc5 is 27.685546875, cma_loss is 9.615751266479492, uma_loss is 0.2031898945569992
loss is 10.05893611907959, acc1 is 11.572265625, acc5 is 26.46484375, cma_loss is 9.828432083129883, uma_loss is 0.23050382733345032
loss is 10.166858673095703, acc1 is 11.181640625, acc5 is 27.1484375, cma_loss is 9.930896759033203, uma_loss is 0.23596163094043732
loss is 10.561736106872559, acc1 is 10.205078125, acc5 is 24.90234375, cma_loss is 10.330839157104492, uma_loss is 0.23089663684368134
loss is 10.13896656036377, acc1 is 10.888671875, acc5 is 26.318359375, cma_loss is 9.902726173400879, uma_loss is 0.23624035716056824
loss is 10.208720207214355, acc1 is 11.669921875, acc5 is 24.560546875, cma_loss is 9.986058235168457, uma_loss is 0.22266234457492828
loss is 10.16131591796875, acc1 is 11.5234375, acc5 is 27.392578125, cma_loss is 9.93968391418457, uma_loss is 0.2216317057609558
loss is 10.120233535766602, acc1 is 12.353515625, acc5 is 27.5390625, cma_loss is 9.873847007751465, uma_loss is 0.24638663232326508
loss is 10.353955268859863, acc1 is 9.814453125, acc5 is 23.53515625, cma_loss is 10.131851196289062, uma_loss is 0.2221037745475769
loss is 10.158344268798828, acc1 is 10.9375, acc5 is 26.123046875, cma_loss is 9.905902862548828, uma_loss is 0.2524409890174866
loss is 10.068639755249023, acc1 is 12.109375, acc5 is 27.587890625, cma_loss is 9.79874324798584, uma_loss is 0.2698964476585388
loss is 10.001152992248535, acc1 is 11.62109375, acc5 is 28.22265625, cma_loss is 9.751971244812012, uma_loss is 0.24918130040168762
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 80.51it/s]
43 epoch loss is 1.2540325437273299,                                    acc1 is 11.354417067307692, acc5 is 26.543719951923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.42it/s]
 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                            | 44/51 [09:16<01:26, 12.37s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 71.4808
The AUROC of I313 is 74.77
The AUROC of I314 is 68.19
-----------------------------------
The average Sensitivity is 75.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 50.00
-----------------------------------
The average Specificity is 72.1095
The Specificity of I313 is 57.61
The Specificity of I314 is 86.61
-----------------------------------
The average Youden Index is 47.1095
The Youden Index of I313 is 57.61
The Youden Index of I314 is 36.61
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.909869194030762, acc1 is 12.98828125, acc5 is 28.662109375, cma_loss is 9.657943725585938, uma_loss is 0.25192520022392273
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 9.890445709228516, acc1 is 12.646484375, acc5 is 29.1015625, cma_loss is 9.654060363769531, uma_loss is 0.23638534545898438
loss is 9.93105411529541, acc1 is 11.572265625, acc5 is 26.708984375, cma_loss is 9.70445442199707, uma_loss is 0.22659987211227417
loss is 9.522052764892578, acc1 is 12.59765625, acc5 is 31.884765625, cma_loss is 9.296677589416504, uma_loss is 0.2253754436969757
loss is 9.46092414855957, acc1 is 14.16015625, acc5 is 31.787109375, cma_loss is 9.235126495361328, uma_loss is 0.22579778730869293
loss is 10.121025085449219, acc1 is 11.181640625, acc5 is 26.806640625, cma_loss is 9.892984390258789, uma_loss is 0.22804033756256104
loss is 10.141510009765625, acc1 is 11.328125, acc5 is 27.685546875, cma_loss is 9.920022964477539, uma_loss is 0.22148746252059937
loss is 9.885404586791992, acc1 is 12.353515625, acc5 is 29.39453125, cma_loss is 9.657211303710938, uma_loss is 0.22819368541240692
loss is 10.059203147888184, acc1 is 13.0859375, acc5 is 28.759765625, cma_loss is 9.834524154663086, uma_loss is 0.22467881441116333
loss is 10.017233848571777, acc1 is 12.353515625, acc5 is 28.125, cma_loss is 9.796350479125977, uma_loss is 0.220883309841156
loss is 9.87608814239502, acc1 is 11.865234375, acc5 is 28.3203125, cma_loss is 9.639910697937012, uma_loss is 0.23617710173130035
loss is 9.67106819152832, acc1 is 13.37890625, acc5 is 31.0546875, cma_loss is 9.443382263183594, uma_loss is 0.22768551111221313
loss is 9.419724464416504, acc1 is 14.2578125, acc5 is 32.470703125, cma_loss is 9.193081855773926, uma_loss is 0.22664275765419006
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 78.18it/s]
44 epoch loss is 1.2181486038934617,                                    acc1 is 12.59765625, acc5 is 29.28936298076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.43it/s]
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 45/51 [09:29<01:14, 12.48s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 73.2194
The AUROC of I313 is 77.45
The AUROC of I314 is 68.99
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 60.0841
The Specificity of I313 is 57.48
The Specificity of I314 is 62.69
-----------------------------------
The average Youden Index is 51.7508
The Youden Index of I313 is 57.48
The Youden Index of I314 is 46.02
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.549355506896973, acc1 is 13.720703125, acc5 is 31.005859375, cma_loss is 9.31590747833252, uma_loss is 0.2334483116865158
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 9.341874122619629, acc1 is 16.015625, acc5 is 33.10546875, cma_loss is 9.12416934967041, uma_loss is 0.2177043855190277
loss is 9.608675956726074, acc1 is 13.671875, acc5 is 31.103515625, cma_loss is 9.359789848327637, uma_loss is 0.24888628721237183
loss is 9.118932723999023, acc1 is 14.794921875, acc5 is 35.64453125, cma_loss is 8.904783248901367, uma_loss is 0.21414963901042938
loss is 9.138162612915039, acc1 is 15.185546875, acc5 is 34.5703125, cma_loss is 8.910663604736328, uma_loss is 0.22749942541122437
loss is 9.075221061706543, acc1 is 15.673828125, acc5 is 36.23046875, cma_loss is 8.869094848632812, uma_loss is 0.20612627267837524
loss is 9.501336097717285, acc1 is 14.6484375, acc5 is 32.71484375, cma_loss is 9.294261932373047, uma_loss is 0.20707452297210693
loss is 9.198101997375488, acc1 is 15.478515625, acc5 is 35.546875, cma_loss is 8.981290817260742, uma_loss is 0.2168114185333252
loss is 9.081319808959961, acc1 is 17.431640625, acc5 is 36.181640625, cma_loss is 8.866857528686523, uma_loss is 0.2144620269536972
loss is 9.51307201385498, acc1 is 13.427734375, acc5 is 30.615234375, cma_loss is 9.300643920898438, uma_loss is 0.2124282866716385
loss is 9.60561752319336, acc1 is 12.255859375, acc5 is 29.58984375, cma_loss is 9.390617370605469, uma_loss is 0.2149999439716339
loss is 9.456815719604492, acc1 is 13.96484375, acc5 is 31.34765625, cma_loss is 9.227935791015625, uma_loss is 0.2288801521062851
loss is 9.29172134399414, acc1 is 13.57421875, acc5 is 33.69140625, cma_loss is 9.06628704071045, uma_loss is 0.22543403506278992
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 79.95it/s]
45 epoch loss is 1.1569543475196475,                                    acc1 is 14.603365384615385, acc5 is 33.18058894230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.31it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 46/51 [09:42<01:02, 12.48s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 51.1175
The AUROC of I313 is 81.20
The AUROC of I314 is 21.03
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 38.1776
The Specificity of I313 is 69.69
The Specificity of I314 is 6.66
-----------------------------------
The average Youden Index is 32.6220
The Youden Index of I313 is 58.58
The Youden Index of I314 is 6.66
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.391057968139648, acc1 is 14.697265625, acc5 is 33.203125, cma_loss is 9.17182731628418, uma_loss is 0.21923045814037323
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 9.010212898254395, acc1 is 16.650390625, acc5 is 37.20703125, cma_loss is 8.789974212646484, uma_loss is 0.22023862600326538
loss is 9.438249588012695, acc1 is 12.5, acc5 is 30.712890625, cma_loss is 9.21253776550293, uma_loss is 0.2257114052772522
loss is 8.934330940246582, acc1 is 16.30859375, acc5 is 35.9375, cma_loss is 8.727907180786133, uma_loss is 0.20642413198947906
loss is 8.9239501953125, acc1 is 16.650390625, acc5 is 36.328125, cma_loss is 8.707596778869629, uma_loss is 0.21635332703590393
loss is 9.129812240600586, acc1 is 15.185546875, acc5 is 34.9609375, cma_loss is 8.878280639648438, uma_loss is 0.2515316903591156
loss is 9.296333312988281, acc1 is 15.087890625, acc5 is 33.69140625, cma_loss is 9.085018157958984, uma_loss is 0.21131546795368195
loss is 9.11538028717041, acc1 is 15.966796875, acc5 is 36.62109375, cma_loss is 8.886575698852539, uma_loss is 0.2288043349981308
loss is 9.13454532623291, acc1 is 16.455078125, acc5 is 35.64453125, cma_loss is 8.90327262878418, uma_loss is 0.2312728315591812
loss is 9.224725723266602, acc1 is 15.4296875, acc5 is 34.423828125, cma_loss is 9.007345199584961, uma_loss is 0.21738041937351227
loss is 9.251457214355469, acc1 is 14.55078125, acc5 is 33.203125, cma_loss is 9.012955665588379, uma_loss is 0.23850193619728088
loss is 9.353588104248047, acc1 is 14.6484375, acc5 is 32.51953125, cma_loss is 9.107465744018555, uma_loss is 0.24612197279930115
loss is 9.089327812194824, acc1 is 17.138671875, acc5 is 36.279296875, cma_loss is 8.860620498657227, uma_loss is 0.22870777547359467
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 94.53it/s]
46 epoch loss is 1.1361235391525994,                                    acc1 is 15.482271634615385, acc5 is 34.67172475961539
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.26it/s]
 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 47/51 [09:54<00:50, 12.52s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 36.7659
The AUROC of I313 is 51.51
The AUROC of I314 is 22.02
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 54.4581
The Specificity of I313 is 94.39
The Specificity of I314 is 14.52
-----------------------------------
The average Youden Index is 15.5692
The Youden Index of I313 is 16.61
The Youden Index of I314 is 14.52
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.015603065490723, acc1 is 15.0390625, acc5 is 35.44921875, cma_loss is 8.811476707458496, uma_loss is 0.20412594079971313
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 8.958958625793457, acc1 is 17.3828125, acc5 is 35.791015625, cma_loss is 8.742158889770508, uma_loss is 0.21679940819740295
loss is 9.052490234375, acc1 is 16.162109375, acc5 is 35.302734375, cma_loss is 8.816051483154297, uma_loss is 0.23643900454044342
loss is 8.722301483154297, acc1 is 17.724609375, acc5 is 38.8671875, cma_loss is 8.505922317504883, uma_loss is 0.2163791060447693
loss is 8.794742584228516, acc1 is 17.529296875, acc5 is 39.2578125, cma_loss is 8.580697059631348, uma_loss is 0.21404527127742767
loss is 8.8601655960083, acc1 is 17.041015625, acc5 is 36.9140625, cma_loss is 8.636822700500488, uma_loss is 0.22334304451942444
loss is 9.111780166625977, acc1 is 15.91796875, acc5 is 35.9375, cma_loss is 8.886602401733398, uma_loss is 0.2251773178577423
loss is 9.0994291305542, acc1 is 15.087890625, acc5 is 35.83984375, cma_loss is 8.875556945800781, uma_loss is 0.22387246787548065
loss is 9.285161018371582, acc1 is 15.087890625, acc5 is 34.423828125, cma_loss is 9.054349899291992, uma_loss is 0.23081067204475403
loss is 9.109495162963867, acc1 is 16.259765625, acc5 is 35.3515625, cma_loss is 8.898381233215332, uma_loss is 0.21111351251602173
loss is 8.990840911865234, acc1 is 16.40625, acc5 is 36.572265625, cma_loss is 8.760435104370117, uma_loss is 0.23040549457073212
loss is 9.269004821777344, acc1 is 14.990234375, acc5 is 32.8125, cma_loss is 9.037364959716797, uma_loss is 0.23163996636867523
loss is 9.017847061157227, acc1 is 15.576171875, acc5 is 36.279296875, cma_loss is 8.774162292480469, uma_loss is 0.24368467926979065
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 108.73it/s]
47 epoch loss is 1.1170268558320544,                                    acc1 is 16.16962139423077, acc5 is 36.06144831730769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.35it/s]
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 48/51 [10:06<00:37, 12.46s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 31.9771
The AUROC of I313 is 40.98
The AUROC of I314 is 22.97
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 18.4473
The Specificity of I313 is 26.23
The Specificity of I314 is 10.66
-----------------------------------
The average Youden Index is 12.8917
The Youden Index of I313 is 15.12
The Youden Index of I314 is 10.66
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 8.893665313720703, acc1 is 16.845703125, acc5 is 35.7421875, cma_loss is 8.682411193847656, uma_loss is 0.21125419437885284
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.46s/it]
loss is 9.050168991088867, acc1 is 15.673828125, acc5 is 35.83984375, cma_loss is 8.836453437805176, uma_loss is 0.2137155830860138
loss is 8.968281745910645, acc1 is 15.72265625, acc5 is 37.20703125, cma_loss is 8.740375518798828, uma_loss is 0.22790642082691193
loss is 8.763551712036133, acc1 is 17.529296875, acc5 is 39.013671875, cma_loss is 8.541747093200684, uma_loss is 0.22180500626564026
loss is 8.492483139038086, acc1 is 19.189453125, acc5 is 41.69921875, cma_loss is 8.278585433959961, uma_loss is 0.213897243142128
loss is 8.623346328735352, acc1 is 17.529296875, acc5 is 39.94140625, cma_loss is 8.40748405456543, uma_loss is 0.21586188673973083
loss is 8.909523963928223, acc1 is 17.333984375, acc5 is 36.767578125, cma_loss is 8.682615280151367, uma_loss is 0.22690874338150024
loss is 8.723143577575684, acc1 is 17.333984375, acc5 is 40.72265625, cma_loss is 8.506326675415039, uma_loss is 0.2168169468641281
loss is 8.769683837890625, acc1 is 16.69921875, acc5 is 38.037109375, cma_loss is 8.533618927001953, uma_loss is 0.23606537282466888
loss is 8.99719524383545, acc1 is 16.015625, acc5 is 35.498046875, cma_loss is 8.768173217773438, uma_loss is 0.2290218472480774
loss is 8.818465232849121, acc1 is 17.87109375, acc5 is 37.548828125, cma_loss is 8.599357604980469, uma_loss is 0.21910716593265533
loss is 9.01168441772461, acc1 is 16.015625, acc5 is 35.15625, cma_loss is 8.782421112060547, uma_loss is 0.22926290333271027
loss is 8.682734489440918, acc1 is 16.89453125, acc5 is 39.306640625, cma_loss is 8.447494506835938, uma_loss is 0.2352403998374939
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 133.66it/s]
48 epoch loss is 1.0924183618454706,                                    acc1 is 16.973407451923077, acc5 is 37.88311298076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.37it/s]
 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 49/51 [10:19<00:24, 12.50s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 32.2204
The AUROC of I313 is 41.83
The AUROC of I314 is 22.61
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 23.9194
The Specificity of I313 is 35.31
The Specificity of I314 is 12.52
-----------------------------------
The average Youden Index is 12.8083
The Youden Index of I313 is 13.09
The Youden Index of I314 is 12.52
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 8.612895965576172, acc1 is 17.626953125, acc5 is 39.892578125, cma_loss is 8.394668579101562, uma_loss is 0.21822723746299744
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 8.701482772827148, acc1 is 18.26171875, acc5 is 40.13671875, cma_loss is 8.476073265075684, uma_loss is 0.22540971636772156
loss is 8.877535820007324, acc1 is 16.650390625, acc5 is 35.83984375, cma_loss is 8.633060455322266, uma_loss is 0.24447552859783173
loss is 8.815740585327148, acc1 is 16.357421875, acc5 is 37.548828125, cma_loss is 8.609720230102539, uma_loss is 0.2060200572013855
loss is 8.553725242614746, acc1 is 18.603515625, acc5 is 39.74609375, cma_loss is 8.317374229431152, uma_loss is 0.23635119199752808
loss is 8.656257629394531, acc1 is 17.333984375, acc5 is 40.33203125, cma_loss is 8.427206039428711, uma_loss is 0.2290513664484024
loss is 8.51511001586914, acc1 is 18.359375, acc5 is 39.111328125, cma_loss is 8.306804656982422, uma_loss is 0.20830555260181427
loss is 8.455177307128906, acc1 is 19.287109375, acc5 is 41.162109375, cma_loss is 8.208142280578613, uma_loss is 0.24703456461429596
loss is 8.308633804321289, acc1 is 19.384765625, acc5 is 42.08984375, cma_loss is 8.088499069213867, uma_loss is 0.22013519704341888
loss is 8.911211967468262, acc1 is 17.1875, acc5 is 39.453125, cma_loss is 8.682682037353516, uma_loss is 0.22853031754493713
loss is 8.541616439819336, acc1 is 18.84765625, acc5 is 40.576171875, cma_loss is 8.304447174072266, uma_loss is 0.23716945946216583
loss is 8.602907180786133, acc1 is 18.115234375, acc5 is 40.185546875, cma_loss is 8.385093688964844, uma_loss is 0.21781335771083832
loss is 8.52180290222168, acc1 is 17.7734375, acc5 is 39.94140625, cma_loss is 8.267345428466797, uma_loss is 0.25445783138275146
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 71.42it/s]
49 epoch loss is 1.0673723584129697,                                    acc1 is 17.98377403846154, acc5 is 39.69350961538461
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.53it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 50/51 [10:32<00:12, 12.55s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.0047
The AUROC of I313 is 57.46
The AUROC of I314 is 28.55
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 37.3111
The Specificity of I313 is 69.29
The Specificity of I314 is 5.33
-----------------------------------
The average Youden Index is 15.0889
The Youden Index of I313 is 24.85
The Youden Index of I314 is 5.33
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 8.197946548461914, acc1 is 22.36328125, acc5 is 43.359375, cma_loss is 7.977272987365723, uma_loss is 0.22067378461360931
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
loss is 8.143203735351562, acc1 is 20.3125, acc5 is 44.287109375, cma_loss is 7.920572280883789, uma_loss is 0.22263167798519135
loss is 8.298267364501953, acc1 is 19.82421875, acc5 is 42.626953125, cma_loss is 8.070047378540039, uma_loss is 0.22822041809558868
loss is 8.066853523254395, acc1 is 20.41015625, acc5 is 45.263671875, cma_loss is 7.82700252532959, uma_loss is 0.23985114693641663
loss is 8.247923851013184, acc1 is 20.3125, acc5 is 43.310546875, cma_loss is 8.022643089294434, uma_loss is 0.2252807915210724
loss is 8.199275970458984, acc1 is 20.01953125, acc5 is 44.921875, cma_loss is 7.965448379516602, uma_loss is 0.23382745683193207
loss is 8.240817070007324, acc1 is 20.1171875, acc5 is 43.408203125, cma_loss is 8.029969215393066, uma_loss is 0.21084797382354736
loss is 8.273712158203125, acc1 is 19.873046875, acc5 is 43.5546875, cma_loss is 8.057846069335938, uma_loss is 0.21586576104164124
loss is 7.95335054397583, acc1 is 21.484375, acc5 is 46.533203125, cma_loss is 7.726844787597656, uma_loss is 0.2265056073665619
loss is 8.464445114135742, acc1 is 19.482421875, acc5 is 41.357421875, cma_loss is 8.250860214233398, uma_loss is 0.21358443796634674
loss is 8.198036193847656, acc1 is 19.53125, acc5 is 43.1640625, cma_loss is 7.979131698608398, uma_loss is 0.21890489757061005
loss is 8.420351028442383, acc1 is 19.384765625, acc5 is 41.50390625, cma_loss is 8.192975997924805, uma_loss is 0.2273746132850647
loss is 8.217391967773438, acc1 is 19.775390625, acc5 is 43.408203125, cma_loss is 7.990395545959473, uma_loss is 0.22699642181396484
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 150.22it/s]
50 epoch loss is 1.0183007149469285,                                    acc1 is 20.22235576923077, acc5 is 43.59224759615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.32it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [10:45<00:00, 12.66s/it]
-----------------------------------
The average AUROC is 38.3042
The AUROC of I313 is 55.71
The AUROC of I314 is 20.90
-----------------------------------
The average Sensitivity is 66.6667
The Sensitivity of I313 is 33.33
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 50.5277
The Specificity of I313 is 94.73
The Specificity of I314 is 6.33
-----------------------------------
The average Youden Index is 17.1944
The Youden Index of I313 is 28.06
The Youden Index of I314 is 6.33
***********************************
