directory "../checkpoints/" existing for save checkpoint!
#########################################
Be patient..., checking checkpoint now...
Start training from 0 epoch
#########################################
training start!
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:91: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
  0%|                                                                                                                                                                                                                                                                                                                                            | 0/51 [00:00<?, ?it/s]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 27.88440704345703, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.926029205322266, uma_loss is 13.958377838134766
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:09<00:00,  1.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.68s/it]
loss is 28.06584358215332, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.490900039672852, uma_loss is 13.574943542480469
loss is 26.359594345092773, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 14.190521240234375, uma_loss is 12.169073104858398
loss is 25.55645179748535, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.853862762451172, uma_loss is 10.70258903503418
loss is 23.333768844604492, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.905052185058594, uma_loss is 9.428716659545898
loss is 22.32832908630371, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.90225601196289, uma_loss is 8.42607307434082
loss is 21.948501586914062, acc1 is 0.1953125, acc5 is 0.537109375, cma_loss is 13.94308853149414, uma_loss is 8.005413055419922
loss is 21.555435180664062, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.917129516601562, uma_loss is 7.6383056640625
loss is 21.16165542602539, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.885047912597656, uma_loss is 7.276608467102051
loss is 20.842960357666016, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.87274169921875, uma_loss is 6.970219612121582
loss is 20.36796760559082, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.871829986572266, uma_loss is 6.496137619018555
loss is 19.922420501708984, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.871589660644531, uma_loss is 6.0508317947387695
loss is 19.708805084228516, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.874717712402344, uma_loss is 5.834088325500488
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 113.96it/s]
0 epoch loss is 2.8479632423037575,                                    acc1 is 0.11268028846153846, acc5 is 0.5483774038461539
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 165.66it/s]
-----------------------------------
The average AUROC is 68.8807
The AUROC of I313 is 56.28
The AUROC of I314 is 81.48
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 55.1711
The Specificity of I313 is 41.26
The Specificity of I314 is 69.09
-----------------------------------
The average Youden Index is 49.6156
The Youden Index of I313 is 30.14
The Youden Index of I314 is 69.09
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.38it/s]
  2%|██████▎                                                                                                                                                                                                                                                                                                                             | 1/51 [00:34<28:52, 34.65s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 38.6189
The AUROC of I27 is 44.34
The AUROC of I34 is 43.57
The AUROC of I35 is 45.09
The AUROC of I36 is 21.47
-----------------------------------
The average Sensitivity is 55.4074
The Sensitivity of I27 is 3.05
The Sensitivity of I34 is 18.58
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 46.7540
The Specificity of I27 is 98.63
The Specificity of I34 is 87.16
The Specificity of I35 is 0.15
The Specificity of I36 is 1.08
-----------------------------------
The average Youden Index is 2.1614
The Youden Index of I27 is 1.67
The Youden Index of I34 is 5.74
The Youden Index of I35 is 0.15
The Youden Index of I36 is 1.08
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 19.447429656982422, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.87576675415039, uma_loss is 5.571662902832031
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  2.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.79s/it]
loss is 19.08771514892578, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.87838363647461, uma_loss is 5.209331512451172
loss is 18.89688491821289, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.87546157836914, uma_loss is 5.021424293518066
loss is 18.787372589111328, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.870109558105469, uma_loss is 4.917262077331543
loss is 18.74871063232422, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.867450714111328, uma_loss is 4.881259918212891
loss is 18.5423641204834, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.868141174316406, uma_loss is 4.674222469329834
loss is 18.46429443359375, acc1 is 0.1953125, acc5 is 0.48828125, cma_loss is 13.861705780029297, uma_loss is 4.602588653564453
loss is 18.26279067993164, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.860610961914062, uma_loss is 4.402179718017578
loss is 18.049327850341797, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.86214828491211, uma_loss is 4.187179088592529
loss is 17.844249725341797, acc1 is 0.146484375, acc5 is 0.390625, cma_loss is 13.869121551513672, uma_loss is 3.975127696990967
loss is 17.77956771850586, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.876506805419922, uma_loss is 3.9030604362487793
loss is 17.6933650970459, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.872589111328125, uma_loss is 3.8207755088806152
loss is 17.53132438659668, acc1 is 0.1953125, acc5 is 0.439453125, cma_loss is 13.864433288574219, uma_loss is 3.666890859603882
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 105.47it/s]
1 epoch loss is 2.277479971022833,                                    acc1 is 0.11643629807692307, acc5 is 0.5183293269230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 123.48it/s]
-----------------------------------
The average AUROC is 39.5831
The AUROC of I313 is 15.06
The AUROC of I314 is 64.10
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 29.0175
The Specificity of I313 is 3.47
The Specificity of I314 is 54.56
-----------------------------------
The average Youden Index is 20.6841
The Youden Index of I313 is 3.47
The Youden Index of I314 is 37.90
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.07it/s]
  4%|████████████▋                                                                                                                                                                                                                                                                                                                       | 2/51 [01:00<23:49, 29.18s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.7308
The AUROC of I27 is 48.53
The AUROC of I34 is 54.35
The AUROC of I35 is 52.86
The AUROC of I36 is 39.19
-----------------------------------
The average Sensitivity is 64.6216
The Sensitivity of I27 is 57.36
The Sensitivity of I34 is 52.21
The Sensitivity of I35 is 60.45
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 43.7589
The Specificity of I27 is 45.73
The Specificity of I34 is 58.82
The Specificity of I35 is 48.95
The Specificity of I36 is 21.54
-----------------------------------
The average Youden Index is 8.3805
The Youden Index of I27 is 3.09
The Youden Index of I34 is 11.04
The Youden Index of I35 is 9.40
The Youden Index of I36 is 10.00
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 17.365039825439453, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.859493255615234, uma_loss is 3.505547046661377
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.78s/it]
loss is 17.230270385742188, acc1 is 0.09765625, acc5 is 0.390625, cma_loss is 13.864368438720703, uma_loss is 3.3659026622772217
loss is 17.17926597595215, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.860260009765625, uma_loss is 3.3190054893493652
loss is 17.059640884399414, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.855045318603516, uma_loss is 3.2045955657958984
loss is 17.04340362548828, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.856559753417969, uma_loss is 3.186844825744629
loss is 16.97677993774414, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.856910705566406, uma_loss is 3.119868278503418
loss is 16.92622184753418, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.859600067138672, uma_loss is 3.0666213035583496
loss is 16.909244537353516, acc1 is 0.0, acc5 is 0.537109375, cma_loss is 13.857166290283203, uma_loss is 3.0520777702331543
loss is 16.887813568115234, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.861133575439453, uma_loss is 3.0266804695129395
loss is 16.83936309814453, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.858699798583984, uma_loss is 2.980663299560547
loss is 16.792583465576172, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.85904312133789, uma_loss is 2.9335408210754395
loss is 16.80872344970703, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.855907440185547, uma_loss is 2.952815532684326
loss is 16.783721923828125, acc1 is 0.1953125, acc5 is 0.68359375, cma_loss is 13.850692749023438, uma_loss is 2.9330291748046875
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 122.32it/s]
2 epoch loss is 2.1028768811907086,                                    acc1 is 0.10516826923076923, acc5 is 0.5295973557692307
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 78.90it/s]
-----------------------------------
The average AUROC is 68.6000
The AUROC of I313 is 60.58
The AUROC of I314 is 76.62
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 46.9956
The Specificity of I313 is 26.97
The Specificity of I314 is 67.02
-----------------------------------
The average Youden Index is 38.6623
The Youden Index of I313 is 26.97
The Youden Index of I314 is 50.36
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.59it/s]
  6%|███████████████████                                                                                                                                                                                                                                                                                                                 | 3/51 [01:22<21:01, 26.28s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.1683
The AUROC of I27 is 41.76
The AUROC of I34 is 52.77
The AUROC of I35 is 45.33
The AUROC of I36 is 40.81
-----------------------------------
The average Sensitivity is 93.1830
The Sensitivity of I27 is 98.48
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 94.92
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 13.0639
The Specificity of I27 is 2.37
The Specificity of I34 is 25.90
The Specificity of I35 is 6.84
The Specificity of I36 is 17.15
-----------------------------------
The average Youden Index is 6.2470
The Youden Index of I27 is 0.84
The Youden Index of I34 is 9.08
The Youden Index of I35 is 1.76
The Youden Index of I36 is 13.30
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.720272064208984, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.851478576660156, uma_loss is 2.8687939643859863
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  2.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.93s/it]
loss is 16.717750549316406, acc1 is 0.244140625, acc5 is 0.830078125, cma_loss is 13.860733032226562, uma_loss is 2.8570175170898438
loss is 16.65239906311035, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.856067657470703, uma_loss is 2.796330690383911
loss is 16.600730895996094, acc1 is 0.146484375, acc5 is 0.68359375, cma_loss is 13.849067687988281, uma_loss is 2.7516636848449707
loss is 16.46715545654297, acc1 is 0.146484375, acc5 is 0.68359375, cma_loss is 13.854793548583984, uma_loss is 2.6123621463775635
loss is 16.3909912109375, acc1 is 0.1953125, acc5 is 0.927734375, cma_loss is 13.850227355957031, uma_loss is 2.540764808654785
loss is 16.31625747680664, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.85457992553711, uma_loss is 2.461677312850952
loss is 16.20782470703125, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.852943420410156, uma_loss is 2.354881525039673
loss is 16.221569061279297, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.85213851928711, uma_loss is 2.369431257247925
loss is 16.260631561279297, acc1 is 0.1953125, acc5 is 0.439453125, cma_loss is 13.852901458740234, uma_loss is 2.407731056213379
loss is 16.171985626220703, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.85244369506836, uma_loss is 2.3195419311523438
loss is 16.150129318237305, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.846927642822266, uma_loss is 2.3032021522521973
loss is 16.107112884521484, acc1 is 0.048828125, acc5 is 0.341796875, cma_loss is 13.836933135986328, uma_loss is 2.270179510116577
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 85.52it/s]
3 epoch loss is 2.028426760718936,                                    acc1 is 0.12770432692307693, acc5 is 0.5934495192307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 170.17it/s]
-----------------------------------
The average AUROC is 70.7895
The AUROC of I313 is 55.21
The AUROC of I314 is 86.36
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 62.5763
The Specificity of I313 is 51.34
The Specificity of I314 is 73.82
-----------------------------------
The average Youden Index is 51.4652
The Youden Index of I313 is 29.11
The Youden Index of I314 is 73.82
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.93it/s]
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/zeroshot_val.py:189: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
-----------------------------------
The average AUROC is 42.0158
The AUROC of I27 is 40.86
The AUROC of I34 is 48.83
The AUROC of I35 is 42.13
The AUROC of I36 is 36.24
-----------------------------------
The average Sensitivity is 86.2696
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 72.57
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 73.08
-----------------------------------
The average Specificity is 16.1129
The Specificity of I27 is 0.08
The Specificity of I34 is 32.57
The Specificity of I35 is 2.03
The Specificity of I36 is 29.78
-----------------------------------
The average Youden Index is 2.3825
The Youden Index of I27 is 0.08
The Youden Index of I34 is 5.13
The Youden Index of I35 is 1.47
The Youden Index of I36 is 2.85
***********************************
  8%|█████████████████████████▍                                                                                                                                                                                                                                                                                                          | 4/51 [01:45<19:19, 24.67s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.081016540527344, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.835147857666016, uma_loss is 2.2458696365356445
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  1.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.73s/it]
loss is 16.089717864990234, acc1 is 0.0, acc5 is 0.48828125, cma_loss is 13.845829010009766, uma_loss is 2.243889808654785
loss is 16.066003799438477, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.84530258178711, uma_loss is 2.2207016944885254
loss is 16.047029495239258, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.815719604492188, uma_loss is 2.2313098907470703
loss is 15.99952220916748, acc1 is 0.1953125, acc5 is 0.537109375, cma_loss is 13.835803985595703, uma_loss is 2.1637184619903564
loss is 15.944917678833008, acc1 is 0.1953125, acc5 is 0.68359375, cma_loss is 13.829639434814453, uma_loss is 2.115278720855713
loss is 15.874076843261719, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.821586608886719, uma_loss is 2.052490234375
loss is 15.851314544677734, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.819110870361328, uma_loss is 2.0322041511535645
loss is 15.766447067260742, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.803543090820312, uma_loss is 1.9629042148590088
loss is 15.732726097106934, acc1 is 0.0, acc5 is 0.341796875, cma_loss is 13.82094955444336, uma_loss is 1.9117767810821533
loss is 15.74776840209961, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.818195343017578, uma_loss is 1.9295735359191895
loss is 15.659031867980957, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.803531646728516, uma_loss is 1.8554999828338623
loss is 15.685745239257812, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.819149017333984, uma_loss is 1.866595983505249
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 142.50it/s]
4 epoch loss is 1.967098263331822,                                    acc1 is 0.1201923076923077, acc5 is 0.6310096153846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.09it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 85.64it/s]
-----------------------------------
The average AUROC is 28.7673
The AUROC of I313 is 40.16
The AUROC of I314 is 17.38
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 8.8416
The Specificity of I313 is 14.15
The Specificity of I314 is 3.53
-----------------------------------
The average Youden Index is 8.8416
The Youden Index of I313 is 14.15
The Youden Index of I314 is 3.53
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.69it/s]
 10%|███████████████████████████████▊                                                                                                                                                                                                                                                                                                    | 5/51 [02:06<18:02, 23.54s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 56.0144
The AUROC of I27 is 59.80
The AUROC of I34 is 48.48
The AUROC of I35 is 56.40
The AUROC of I36 is 59.38
-----------------------------------
The average Sensitivity is 62.2272
The Sensitivity of I27 is 42.13
The Sensitivity of I34 is 68.14
The Sensitivity of I35 is 46.33
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 53.9395
The Specificity of I27 is 75.57
The Specificity of I34 is 39.74
The Specificity of I35 is 65.94
The Specificity of I36 is 34.50
-----------------------------------
The average Youden Index is 16.1667
The Youden Index of I27 is 17.70
The Youden Index of I34 is 7.88
The Youden Index of I35 is 12.27
The Youden Index of I36 is 26.81
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.60627555847168, acc1 is 0.09765625, acc5 is 0.830078125, cma_loss is 13.794437408447266, uma_loss is 1.8118376731872559
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 15.660524368286133, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.81521224975586, uma_loss is 1.8453125953674316
loss is 15.59627628326416, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.812019348144531, uma_loss is 1.7842568159103394
loss is 15.523143768310547, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.759960174560547, uma_loss is 1.763183832168579
loss is 15.589390754699707, acc1 is 0.244140625, acc5 is 0.732421875, cma_loss is 13.804054260253906, uma_loss is 1.7853364944458008
loss is 15.593918800354004, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.797428131103516, uma_loss is 1.7964904308319092
loss is 15.505545616149902, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.799640655517578, uma_loss is 1.7059049606323242
loss is 15.503863334655762, acc1 is 0.390625, acc5 is 0.927734375, cma_loss is 13.758312225341797, uma_loss is 1.745551347732544
loss is 15.453569412231445, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.754592895507812, uma_loss is 1.6989765167236328
loss is 15.44110107421875, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.738082885742188, uma_loss is 1.703018307685852
loss is 15.414308547973633, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.780475616455078, uma_loss is 1.6338324546813965
loss is 15.308646202087402, acc1 is 0.244140625, acc5 is 0.830078125, cma_loss is 13.733352661132812, uma_loss is 1.575293779373169
loss is 15.292308807373047, acc1 is 0.146484375, acc5 is 0.830078125, cma_loss is 13.738327026367188, uma_loss is 1.5539813041687012
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 112.83it/s]
5 epoch loss is 1.918941643124535,                                    acc1 is 0.15775240384615385, acc5 is 0.7512019230769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 156.40it/s]
-----------------------------------
The average AUROC is 27.8225
The AUROC of I313 is 39.22
The AUROC of I314 is 16.42
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 10.7093
The Specificity of I313 is 16.49
The Specificity of I314 is 4.93
-----------------------------------
The average Youden Index is 10.7093
The Youden Index of I313 is 16.49
The Youden Index of I314 is 4.93
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.41it/s]
 12%|██████████████████████████████████████                                                                                                                                                                                                                                                                                              | 6/51 [02:25<16:23, 21.85s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 54.5628
The AUROC of I27 is 59.63
The AUROC of I34 is 48.48
The AUROC of I35 is 57.09
The AUROC of I36 is 53.05
-----------------------------------
The average Sensitivity is 60.5990
The Sensitivity of I27 is 43.15
The Sensitivity of I34 is 66.37
The Sensitivity of I35 is 36.72
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 54.8348
The Specificity of I27 is 75.19
The Specificity of I34 is 41.97
The Specificity of I35 is 75.71
The Specificity of I36 is 26.47
-----------------------------------
The average Youden Index is 15.4338
The Youden Index of I27 is 18.34
The Youden Index of I34 is 8.34
The Youden Index of I35 is 12.44
The Youden Index of I36 is 22.62
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.21126651763916, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.711978912353516, uma_loss is 1.499287724494934
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 15.176692962646484, acc1 is 0.09765625, acc5 is 0.830078125, cma_loss is 13.716148376464844, uma_loss is 1.4605449438095093
loss is 15.187575340270996, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.729969024658203, uma_loss is 1.4576059579849243
loss is 15.078930854797363, acc1 is 0.09765625, acc5 is 1.07421875, cma_loss is 13.650337219238281, uma_loss is 1.428593397140503
loss is 15.161036491394043, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.698841094970703, uma_loss is 1.4621952772140503
loss is 15.116331100463867, acc1 is 0.0, acc5 is 0.68359375, cma_loss is 13.70303726196289, uma_loss is 1.4132941961288452
loss is 15.061086654663086, acc1 is 0.048828125, acc5 is 0.732421875, cma_loss is 13.678813934326172, uma_loss is 1.3822728395462036
loss is 15.050065040588379, acc1 is 0.29296875, acc5 is 1.123046875, cma_loss is 13.680179595947266, uma_loss is 1.369885802268982
loss is 15.142640113830566, acc1 is 0.29296875, acc5 is 0.634765625, cma_loss is 13.785110473632812, uma_loss is 1.3575297594070435
loss is 15.063139915466309, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.742225646972656, uma_loss is 1.320914626121521
loss is 15.027831077575684, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.695415496826172, uma_loss is 1.3324153423309326
loss is 14.974525451660156, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.67879867553711, uma_loss is 1.295727252960205
loss is 14.990681648254395, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.711776733398438, uma_loss is 1.2789051532745361
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 115.79it/s]
6 epoch loss is 1.8689695539928617,                                    acc1 is 0.1502403846153846, acc5 is 0.8075420673076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 184.00it/s]
-----------------------------------
The average AUROC is 27.6416
The AUROC of I313 is 37.85
The AUROC of I314 is 17.43
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.5407
The Specificity of I313 is 15.02
The Specificity of I314 is 8.06
-----------------------------------
The average Youden Index is 11.5407
The Youden Index of I313 is 15.02
The Youden Index of I314 is 8.06
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.75it/s]
 14%|████████████████████████████████████████████▍                                                                                                                                                                                                                                                                                       | 7/51 [02:42<14:58, 20.43s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 53.3912
The AUROC of I27 is 58.54
The AUROC of I34 is 49.40
The AUROC of I35 is 57.16
The AUROC of I36 is 48.47
-----------------------------------
The average Sensitivity is 63.4924
The Sensitivity of I27 is 45.18
The Sensitivity of I34 is 69.03
The Sensitivity of I35 is 47.46
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 52.0830
The Specificity of I27 is 72.21
The Specificity of I34 is 41.54
The Specificity of I35 is 65.41
The Specificity of I36 is 29.17
-----------------------------------
The average Youden Index is 15.5754
The Youden Index of I27 is 17.39
The Youden Index of I34 is 10.56
The Youden Index of I35 is 12.87
The Youden Index of I36 is 21.48
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.837956428527832, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.657852172851562, uma_loss is 1.18010413646698
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 14.869340896606445, acc1 is 0.09765625, acc5 is 0.634765625, cma_loss is 13.678531646728516, uma_loss is 1.190809726715088
loss is 14.857516288757324, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.673702239990234, uma_loss is 1.1838140487670898
loss is 14.74467658996582, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.626510620117188, uma_loss is 1.1181663274765015
loss is 14.833168983459473, acc1 is 0.29296875, acc5 is 0.87890625, cma_loss is 13.65005111694336, uma_loss is 1.183118224143982
loss is 14.806893348693848, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.705158233642578, uma_loss is 1.101735234260559
loss is 14.727656364440918, acc1 is 0.09765625, acc5 is 0.9765625, cma_loss is 13.619316101074219, uma_loss is 1.1083405017852783
loss is 14.7333984375, acc1 is 0.244140625, acc5 is 1.171875, cma_loss is 13.634910583496094, uma_loss is 1.0984878540039062
loss is 14.677450180053711, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.638103485107422, uma_loss is 1.0393471717834473
loss is 14.657632827758789, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.644229888916016, uma_loss is 1.0134025812149048
loss is 14.58607292175293, acc1 is 0.341796875, acc5 is 1.220703125, cma_loss is 13.560783386230469, uma_loss is 1.0252890586853027
loss is 14.564129829406738, acc1 is 0.048828125, acc5 is 0.927734375, cma_loss is 13.587963104248047, uma_loss is 0.9761667251586914
loss is 14.567316055297852, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.606082916259766, uma_loss is 0.961233377456665
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 146.26it/s]
7 epoch loss is 1.8234591347830635,                                    acc1 is 0.18028846153846154, acc5 is 0.9465144230769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 140.19it/s]
-----------------------------------
The average AUROC is 30.7476
The AUROC of I313 is 40.32
The AUROC of I314 is 21.17
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 14.5118
The Specificity of I313 is 21.43
The Specificity of I314 is 7.59
-----------------------------------
The average Youden Index is 14.5118
The Youden Index of I313 is 21.43
The Youden Index of I314 is 7.59
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.60it/s]
 16%|██████████████████████████████████████████████████▊                                                                                                                                                                                                                                                                                 | 8/51 [03:00<14:08, 19.72s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.4740
The AUROC of I27 is 58.45
The AUROC of I34 is 46.87
The AUROC of I35 is 50.29
The AUROC of I36 is 38.29
-----------------------------------
The average Sensitivity is 70.5920
The Sensitivity of I27 is 44.16
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 62.71
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 38.4907
The Specificity of I27 is 72.98
The Specificity of I34 is 20.88
The Specificity of I35 is 41.88
The Specificity of I36 is 18.23
-----------------------------------
The average Youden Index is 9.0827
The Youden Index of I27 is 17.14
The Youden Index of I34 is 4.06
The Youden Index of I35 is 4.59
The Youden Index of I36 is 10.54
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.546513557434082, acc1 is 0.146484375, acc5 is 1.220703125, cma_loss is 13.579559326171875, uma_loss is 0.9669542908668518
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.47s/it]
loss is 14.522563934326172, acc1 is 0.1953125, acc5 is 0.927734375, cma_loss is 13.56808853149414, uma_loss is 0.9544750452041626
loss is 14.555185317993164, acc1 is 0.439453125, acc5 is 1.171875, cma_loss is 13.584915161132812, uma_loss is 0.9702696800231934
loss is 14.478765487670898, acc1 is 0.341796875, acc5 is 1.416015625, cma_loss is 13.53253173828125, uma_loss is 0.9462333917617798
loss is 14.496252059936523, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.55422592163086, uma_loss is 0.942025899887085
loss is 14.534624099731445, acc1 is 0.48828125, acc5 is 1.220703125, cma_loss is 13.582958221435547, uma_loss is 0.9516659379005432
loss is 14.498689651489258, acc1 is 0.1953125, acc5 is 1.26953125, cma_loss is 13.548892974853516, uma_loss is 0.9497969150543213
loss is 14.50622844696045, acc1 is 0.146484375, acc5 is 1.318359375, cma_loss is 13.535717010498047, uma_loss is 0.9705110788345337
loss is 14.445812225341797, acc1 is 0.146484375, acc5 is 1.26953125, cma_loss is 13.53177261352539, uma_loss is 0.9140399098396301
loss is 14.448921203613281, acc1 is 0.244140625, acc5 is 1.220703125, cma_loss is 13.539722442626953, uma_loss is 0.9091989398002625
loss is 14.366074562072754, acc1 is 0.390625, acc5 is 1.46484375, cma_loss is 13.499246597290039, uma_loss is 0.866827666759491
loss is 14.434112548828125, acc1 is 0.146484375, acc5 is 0.927734375, cma_loss is 13.533241271972656, uma_loss is 0.9008711576461792
loss is 14.434430122375488, acc1 is 0.146484375, acc5 is 1.025390625, cma_loss is 13.552421569824219, uma_loss is 0.8820087909698486
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 137.77it/s]
8 epoch loss is 1.7930302211216518,                                    acc1 is 0.244140625, acc5 is 1.1868990384615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 162.18it/s]
-----------------------------------
The average AUROC is 29.3913
The AUROC of I313 is 40.55
The AUROC of I314 is 18.23
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.5433
The Specificity of I313 is 17.69
The Specificity of I314 is 5.40
-----------------------------------
The average Youden Index is 11.5433
The Youden Index of I313 is 17.69
The Youden Index of I314 is 5.40
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.45it/s]
 18%|█████████████████████████████████████████████████████████▏                                                                                                                                                                                                                                                                          | 9/51 [03:18<13:25, 19.18s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.1973
The AUROC of I27 is 50.28
The AUROC of I34 is 49.83
The AUROC of I35 is 42.96
The AUROC of I36 is 41.72
-----------------------------------
The average Sensitivity is 73.5013
The Sensitivity of I27 is 17.26
The Sensitivity of I34 is 77.88
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 35.3703
The Specificity of I27 is 91.83
The Specificity of I34 is 29.20
The Specificity of I35 is 3.91
The Specificity of I36 is 16.54
-----------------------------------
The average Youden Index is 8.8716
The Youden Index of I27 is 9.09
The Youden Index of I34 is 7.07
The Youden Index of I35 is 2.78
The Youden Index of I36 is 16.54
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.439001083374023, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.543037414550781, uma_loss is 0.8959637880325317
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.54s/it]
loss is 14.396489143371582, acc1 is 0.146484375, acc5 is 1.611328125, cma_loss is 13.50408935546875, uma_loss is 0.8923994898796082
loss is 14.406311988830566, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.534500122070312, uma_loss is 0.8718115091323853
loss is 14.363099098205566, acc1 is 0.244140625, acc5 is 1.611328125, cma_loss is 13.52438735961914, uma_loss is 0.838711678981781
loss is 14.344282150268555, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.501070022583008, uma_loss is 0.8432120084762573
loss is 14.298797607421875, acc1 is 0.1953125, acc5 is 1.708984375, cma_loss is 13.513130187988281, uma_loss is 0.7856675982475281
loss is 14.296219825744629, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.497055053710938, uma_loss is 0.7991645932197571
loss is 14.271515846252441, acc1 is 0.1953125, acc5 is 1.123046875, cma_loss is 13.46811294555664, uma_loss is 0.8034030795097351
loss is 14.322765350341797, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.513692855834961, uma_loss is 0.8090720772743225
loss is 14.303730010986328, acc1 is 0.1953125, acc5 is 1.220703125, cma_loss is 13.50385856628418, uma_loss is 0.7998718023300171
loss is 14.207931518554688, acc1 is 0.390625, acc5 is 1.85546875, cma_loss is 13.420867919921875, uma_loss is 0.7870632410049438
loss is 14.254066467285156, acc1 is 0.341796875, acc5 is 1.025390625, cma_loss is 13.469463348388672, uma_loss is 0.7846032381057739
loss is 14.230623245239258, acc1 is 0.341796875, acc5 is 1.26953125, cma_loss is 13.480907440185547, uma_loss is 0.7497153878211975
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 119.57it/s]
9 epoch loss is 1.7727126984369188,                                    acc1 is 0.23662860576923078, acc5 is 1.2469951923076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 153.66it/s]
-----------------------------------
The average AUROC is 29.1247
The AUROC of I313 is 40.37
The AUROC of I314 is 17.88
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.8110
The Specificity of I313 is 19.56
The Specificity of I314 is 6.06
-----------------------------------
The average Youden Index is 12.8110
The Youden Index of I313 is 19.56
The Youden Index of I314 is 6.06
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
 20%|███████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                                   | 10/51 [03:37<13:00, 19.04s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.5258
The AUROC of I27 is 39.78
The AUROC of I34 is 50.16
The AUROC of I35 is 42.91
The AUROC of I36 is 45.26
-----------------------------------
The average Sensitivity is 71.5402
The Sensitivity of I27 is 0.00
The Sensitivity of I34 is 86.73
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 35.0779
The Specificity of I27 is 100.00
The Specificity of I34 is 20.09
The Specificity of I35 is 3.01
The Specificity of I36 is 17.22
-----------------------------------
The average Youden Index is 6.6181
The Youden Index of I27 is 0.00
The Youden Index of I34 is 6.81
The Youden Index of I35 is 2.44
The Youden Index of I36 is 17.22
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.225272178649902, acc1 is 0.146484375, acc5 is 1.220703125, cma_loss is 13.514335632324219, uma_loss is 0.7109367847442627
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 14.188200950622559, acc1 is 0.244140625, acc5 is 1.708984375, cma_loss is 13.437446594238281, uma_loss is 0.750754714012146
loss is 14.214807510375977, acc1 is 0.29296875, acc5 is 1.3671875, cma_loss is 13.476837158203125, uma_loss is 0.7379706501960754
loss is 14.13859748840332, acc1 is 0.48828125, acc5 is 1.85546875, cma_loss is 13.437057495117188, uma_loss is 0.701539933681488
loss is 14.15885066986084, acc1 is 0.390625, acc5 is 1.3671875, cma_loss is 13.450939178466797, uma_loss is 0.707911491394043
loss is 14.168834686279297, acc1 is 0.1953125, acc5 is 1.3671875, cma_loss is 13.473388671875, uma_loss is 0.6954459547996521
loss is 14.150235176086426, acc1 is 0.1953125, acc5 is 1.171875, cma_loss is 13.46463394165039, uma_loss is 0.6856011748313904
loss is 14.202568054199219, acc1 is 0.29296875, acc5 is 1.318359375, cma_loss is 13.492424011230469, uma_loss is 0.7101445198059082
loss is 14.158149719238281, acc1 is 0.244140625, acc5 is 0.9765625, cma_loss is 13.466869354248047, uma_loss is 0.6912806630134583
loss is 14.146652221679688, acc1 is 0.439453125, acc5 is 1.611328125, cma_loss is 13.43442153930664, uma_loss is 0.7122302651405334
loss is 14.123819351196289, acc1 is 0.439453125, acc5 is 1.5625, cma_loss is 13.410175323486328, uma_loss is 0.7136443853378296
loss is 14.085260391235352, acc1 is 0.244140625, acc5 is 1.66015625, cma_loss is 13.396865844726562, uma_loss is 0.68839430809021
loss is 14.025630950927734, acc1 is 0.1953125, acc5 is 1.171875, cma_loss is 13.357242584228516, uma_loss is 0.6683885455131531
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 118.84it/s]
10 epoch loss is 1.7522559937976656,                                    acc1 is 0.29296875, acc5 is 1.4122596153846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 160.03it/s]
-----------------------------------
The average AUROC is 28.8451
The AUROC of I313 is 38.44
The AUROC of I314 is 19.25
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.4427
The Specificity of I313 is 17.62
The Specificity of I314 is 7.26
-----------------------------------
The average Youden Index is 12.4427
The Youden Index of I313 is 17.62
The Youden Index of I314 is 7.26
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.20it/s]
 22%|█████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                                             | 11/51 [03:55<12:27, 18.69s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.9023
The AUROC of I27 is 40.38
The AUROC of I34 is 48.85
The AUROC of I35 is 43.08
The AUROC of I36 is 51.30
-----------------------------------
The average Sensitivity is 69.9149
The Sensitivity of I27 is 0.00
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 37.9927
The Specificity of I27 is 100.00
The Specificity of I34 is 23.03
The Specificity of I35 is 3.08
The Specificity of I36 is 25.86
-----------------------------------
The average Youden Index is 7.9076
The Youden Index of I27 is 0.00
The Youden Index of I34 is 7.10
The Youden Index of I35 is 2.52
The Youden Index of I36 is 22.01
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.127782821655273, acc1 is 0.390625, acc5 is 1.5625, cma_loss is 13.461650848388672, uma_loss is 0.6661316156387329
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 14.096059799194336, acc1 is 0.537109375, acc5 is 1.7578125, cma_loss is 13.44696044921875, uma_loss is 0.6490991115570068
loss is 14.095060348510742, acc1 is 0.341796875, acc5 is 1.806640625, cma_loss is 13.433731079101562, uma_loss is 0.6613296866416931
loss is 14.039371490478516, acc1 is 0.48828125, acc5 is 1.611328125, cma_loss is 13.369739532470703, uma_loss is 0.669632077217102
loss is 13.972269058227539, acc1 is 0.341796875, acc5 is 1.5625, cma_loss is 13.332107543945312, uma_loss is 0.6401613354682922
loss is 14.050787925720215, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.392080307006836, uma_loss is 0.6587076783180237
loss is 14.030750274658203, acc1 is 0.244140625, acc5 is 1.7578125, cma_loss is 13.39809799194336, uma_loss is 0.6326523423194885
loss is 14.062726974487305, acc1 is 0.439453125, acc5 is 1.708984375, cma_loss is 13.400104522705078, uma_loss is 0.66262286901474
loss is 14.060567855834961, acc1 is 0.390625, acc5 is 1.5625, cma_loss is 13.393486022949219, uma_loss is 0.6670817136764526
loss is 14.010485649108887, acc1 is 0.390625, acc5 is 1.46484375, cma_loss is 13.348007202148438, uma_loss is 0.6624783873558044
loss is 13.973376274108887, acc1 is 0.48828125, acc5 is 2.05078125, cma_loss is 13.337478637695312, uma_loss is 0.6358977556228638
loss is 13.965950965881348, acc1 is 0.09765625, acc5 is 1.26953125, cma_loss is 13.343067169189453, uma_loss is 0.6228837966918945
loss is 13.985261917114258, acc1 is 0.390625, acc5 is 1.806640625, cma_loss is 13.336433410644531, uma_loss is 0.6488280892372131
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 83.39it/s]
11 epoch loss is 1.7378138224283854,                                    acc1 is 0.37560096153846156, acc5 is 1.6225961538461537
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 149.51it/s]
-----------------------------------
The average AUROC is 28.0253
The AUROC of I313 is 38.38
The AUROC of I314 is 17.67
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.7447
The Specificity of I313 is 19.89
The Specificity of I314 is 5.60
-----------------------------------
The average Youden Index is 12.7447
The Youden Index of I313 is 19.89
The Youden Index of I314 is 5.60
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.27it/s]
 24%|████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                                       | 12/51 [04:13<12:05, 18.59s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.8696
The AUROC of I27 is 40.47
The AUROC of I34 is 49.40
The AUROC of I35 is 43.48
The AUROC of I36 is 42.13
-----------------------------------
The average Sensitivity is 67.7030
The Sensitivity of I27 is 2.03
The Sensitivity of I34 is 69.91
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 38.7645
The Specificity of I27 is 98.40
The Specificity of I34 is 37.59
The Specificity of I35 is 3.61
The Specificity of I36 is 15.46
-----------------------------------
The average Youden Index is 6.4675
The Youden Index of I27 is 0.43
The Youden Index of I34 is 7.50
The Youden Index of I35 is 2.48
The Youden Index of I36 is 15.46
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.961435317993164, acc1 is 0.48828125, acc5 is 1.5625, cma_loss is 13.342548370361328, uma_loss is 0.6188873648643494
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.52s/it]
loss is 13.904899597167969, acc1 is 0.537109375, acc5 is 2.05078125, cma_loss is 13.282028198242188, uma_loss is 0.6228718757629395
loss is 14.014448165893555, acc1 is 0.48828125, acc5 is 1.85546875, cma_loss is 13.386512756347656, uma_loss is 0.6279357671737671
loss is 13.926742553710938, acc1 is 0.537109375, acc5 is 1.7578125, cma_loss is 13.2889404296875, uma_loss is 0.6378016471862793
loss is 13.869437217712402, acc1 is 0.390625, acc5 is 1.904296875, cma_loss is 13.267234802246094, uma_loss is 0.602202832698822
loss is 13.92780876159668, acc1 is 0.1953125, acc5 is 1.806640625, cma_loss is 13.329261779785156, uma_loss is 0.598547101020813
loss is 13.871729850769043, acc1 is 0.439453125, acc5 is 1.953125, cma_loss is 13.293888092041016, uma_loss is 0.5778417587280273
loss is 13.91599178314209, acc1 is 0.537109375, acc5 is 1.806640625, cma_loss is 13.323562622070312, uma_loss is 0.592429518699646
loss is 13.923629760742188, acc1 is 0.732421875, acc5 is 1.708984375, cma_loss is 13.343460083007812, uma_loss is 0.5801695585250854
loss is 13.881383895874023, acc1 is 0.5859375, acc5 is 2.001953125, cma_loss is 13.310962677001953, uma_loss is 0.5704207420349121
loss is 13.802165031433105, acc1 is 0.537109375, acc5 is 2.24609375, cma_loss is 13.245223999023438, uma_loss is 0.5569409728050232
loss is 13.855764389038086, acc1 is 0.390625, acc5 is 2.001953125, cma_loss is 13.287696838378906, uma_loss is 0.5680674910545349
loss is 13.863617897033691, acc1 is 0.48828125, acc5 is 1.953125, cma_loss is 13.306873321533203, uma_loss is 0.5567444562911987
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 110.88it/s]
12 epoch loss is 1.7211338497343518,                                    acc1 is 0.48828125, acc5 is 1.8930288461538463
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 152.54it/s]
-----------------------------------
The average AUROC is 27.7668
The AUROC of I313 is 37.15
The AUROC of I314 is 18.39
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 7.3404
The Specificity of I313 is 11.95
The Specificity of I314 is 2.73
-----------------------------------
The average Youden Index is 7.3404
The Youden Index of I313 is 11.95
The Youden Index of I314 is 2.73
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.50it/s]
 25%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                | 13/51 [04:31<11:39, 18.40s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.3445
The AUROC of I27 is 40.39
The AUROC of I34 is 47.66
The AUROC of I35 is 44.41
The AUROC of I36 is 40.92
-----------------------------------
The average Sensitivity is 72.4611
The Sensitivity of I27 is 4.57
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 33.5428
The Specificity of I27 is 95.80
The Specificity of I34 is 21.88
The Specificity of I35 is 3.46
The Specificity of I36 is 13.03
-----------------------------------
The average Youden Index is 6.0039
The Youden Index of I27 is 0.37
The Youden Index of I34 is 7.72
The Youden Index of I35 is 2.89
The Youden Index of I36 is 13.03
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.920129776000977, acc1 is 0.341796875, acc5 is 1.66015625, cma_loss is 13.386905670166016, uma_loss is 0.5332236289978027
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.58s/it]
loss is 13.91208267211914, acc1 is 0.634765625, acc5 is 1.3671875, cma_loss is 13.363117218017578, uma_loss is 0.548965334892273
loss is 13.89198112487793, acc1 is 0.537109375, acc5 is 2.490234375, cma_loss is 13.33041763305664, uma_loss is 0.5615637302398682
loss is 13.868855476379395, acc1 is 0.390625, acc5 is 2.1484375, cma_loss is 13.302143096923828, uma_loss is 0.5667125582695007
loss is 13.872923851013184, acc1 is 0.927734375, acc5 is 2.1484375, cma_loss is 13.312646865844727, uma_loss is 0.5602767467498779
loss is 13.870593070983887, acc1 is 0.146484375, acc5 is 1.46484375, cma_loss is 13.30620002746582, uma_loss is 0.5643929243087769
loss is 13.804679870605469, acc1 is 0.146484375, acc5 is 2.294921875, cma_loss is 13.247840881347656, uma_loss is 0.5568394660949707
loss is 13.766131401062012, acc1 is 0.537109375, acc5 is 2.294921875, cma_loss is 13.217107772827148, uma_loss is 0.5490235090255737
loss is 13.893848419189453, acc1 is 0.390625, acc5 is 1.46484375, cma_loss is 13.331619262695312, uma_loss is 0.5622289180755615
loss is 13.808924674987793, acc1 is 0.439453125, acc5 is 1.806640625, cma_loss is 13.261615753173828, uma_loss is 0.547308623790741
loss is 13.769423484802246, acc1 is 0.634765625, acc5 is 2.24609375, cma_loss is 13.234939575195312, uma_loss is 0.5344834923744202
loss is 13.755816459655762, acc1 is 0.5859375, acc5 is 2.63671875, cma_loss is 13.205284118652344, uma_loss is 0.5505324602127075
loss is 13.755358695983887, acc1 is 0.634765625, acc5 is 2.197265625, cma_loss is 13.20907211303711, uma_loss is 0.5462865233421326
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 113.33it/s]
13 epoch loss is 1.7132452283586774,                                    acc1 is 0.48828125, acc5 is 2.0169771634615383
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 175.51it/s]
-----------------------------------
The average AUROC is 26.2997
The AUROC of I313 is 35.72
The AUROC of I314 is 16.88
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.2036
The Specificity of I313 is 9.75
The Specificity of I314 is 8.66
-----------------------------------
The average Youden Index is 9.2036
The Youden Index of I313 is 9.75
The Youden Index of I314 is 8.66
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.24it/s]
 27%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                          | 14/51 [04:49<11:17, 18.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.6576
The AUROC of I27 is 39.88
The AUROC of I34 is 48.71
The AUROC of I35 is 43.67
The AUROC of I36 is 46.36
-----------------------------------
The average Sensitivity is 73.2843
The Sensitivity of I27 is 6.09
The Sensitivity of I34 is 87.61
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 33.1262
The Specificity of I27 is 95.27
The Specificity of I34 is 21.52
The Specificity of I35 is 3.16
The Specificity of I36 is 12.56
-----------------------------------
The average Youden Index is 6.4105
The Youden Index of I27 is 1.36
The Youden Index of I34 is 9.13
The Youden Index of I35 is 2.59
The Youden Index of I36 is 12.56
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.727465629577637, acc1 is 0.537109375, acc5 is 2.34375, cma_loss is 13.20864486694336, uma_loss is 0.5188207626342773
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 13.829832077026367, acc1 is 0.244140625, acc5 is 2.24609375, cma_loss is 13.276405334472656, uma_loss is 0.5534264445304871
loss is 13.804301261901855, acc1 is 0.5859375, acc5 is 2.24609375, cma_loss is 13.266674041748047, uma_loss is 0.5376270413398743
loss is 13.673219680786133, acc1 is 0.5859375, acc5 is 2.490234375, cma_loss is 13.157022476196289, uma_loss is 0.5161973834037781
loss is 13.724105834960938, acc1 is 0.5859375, acc5 is 2.5390625, cma_loss is 13.194816589355469, uma_loss is 0.5292891263961792
loss is 13.767557144165039, acc1 is 0.341796875, acc5 is 1.953125, cma_loss is 13.260509490966797, uma_loss is 0.5070478320121765
loss is 13.791183471679688, acc1 is 0.390625, acc5 is 2.294921875, cma_loss is 13.257869720458984, uma_loss is 0.5333136916160583
loss is 13.70854377746582, acc1 is 0.537109375, acc5 is 2.63671875, cma_loss is 13.184307098388672, uma_loss is 0.5242369174957275
loss is 13.798173904418945, acc1 is 0.1953125, acc5 is 1.513671875, cma_loss is 13.299200057983398, uma_loss is 0.4989736080169678
loss is 13.786589622497559, acc1 is 0.68359375, acc5 is 1.904296875, cma_loss is 13.250646591186523, uma_loss is 0.5359430909156799
loss is 13.673458099365234, acc1 is 0.634765625, acc5 is 2.294921875, cma_loss is 13.174346923828125, uma_loss is 0.4991116225719452
loss is 13.70064640045166, acc1 is 0.439453125, acc5 is 2.197265625, cma_loss is 13.195714950561523, uma_loss is 0.5049314498901367
loss is 13.654622077941895, acc1 is 0.5859375, acc5 is 2.63671875, cma_loss is 13.172140121459961, uma_loss is 0.48248159885406494
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 121.78it/s]
14 epoch loss is 1.7013304664975122,                                    acc1 is 0.48828125, acc5 is 2.253605769230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 155.43it/s]
-----------------------------------
The average AUROC is 31.5228
The AUROC of I313 is 34.52
The AUROC of I314 is 28.53
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 13.9782
The Specificity of I313 is 20.83
The Specificity of I314 is 7.13
-----------------------------------
The average Youden Index is 8.4226
The Youden Index of I313 is 9.72
The Youden Index of I314 is 7.13
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.31it/s]
 29%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                    | 15/51 [05:08<10:58, 18.28s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.2405
The AUROC of I27 is 41.03
The AUROC of I34 is 51.11
The AUROC of I35 is 43.32
The AUROC of I36 is 37.50
-----------------------------------
The average Sensitivity is 71.5766
The Sensitivity of I27 is 3.05
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 98.31
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 34.2022
The Specificity of I27 is 97.25
The Specificity of I34 is 22.02
The Specificity of I35 is 3.76
The Specificity of I36 is 13.77
-----------------------------------
The average Youden Index is 5.7788
The Youden Index of I27 is 0.30
The Youden Index of I34 is 6.98
The Youden Index of I35 is 2.06
The Youden Index of I36 is 13.77
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.65847396850586, acc1 is 0.634765625, acc5 is 2.734375, cma_loss is 13.184398651123047, uma_loss is 0.4740753769874573
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.51s/it]
loss is 13.592498779296875, acc1 is 0.78125, acc5 is 2.83203125, cma_loss is 13.104736328125, uma_loss is 0.4877622425556183
loss is 13.697577476501465, acc1 is 0.5859375, acc5 is 1.904296875, cma_loss is 13.22348403930664, uma_loss is 0.47409379482269287
loss is 13.63442325592041, acc1 is 0.78125, acc5 is 2.83203125, cma_loss is 13.160955429077148, uma_loss is 0.4734673798084259
loss is 13.60860538482666, acc1 is 0.634765625, acc5 is 2.44140625, cma_loss is 13.128355026245117, uma_loss is 0.4802500307559967
loss is 13.636154174804688, acc1 is 0.537109375, acc5 is 2.685546875, cma_loss is 13.171239852905273, uma_loss is 0.4649147689342499
loss is 13.62834644317627, acc1 is 0.390625, acc5 is 2.734375, cma_loss is 13.168521881103516, uma_loss is 0.4598248600959778
loss is 13.592068672180176, acc1 is 0.439453125, acc5 is 2.44140625, cma_loss is 13.133796691894531, uma_loss is 0.4582717716693878
loss is 13.664055824279785, acc1 is 0.29296875, acc5 is 1.66015625, cma_loss is 13.195941925048828, uma_loss is 0.4681141674518585
loss is 13.63050365447998, acc1 is 0.732421875, acc5 is 2.197265625, cma_loss is 13.171432495117188, uma_loss is 0.4590708315372467
loss is 13.553342819213867, acc1 is 0.68359375, acc5 is 3.02734375, cma_loss is 13.116218566894531, uma_loss is 0.43712469935417175
loss is 13.563342094421387, acc1 is 0.732421875, acc5 is 2.9296875, cma_loss is 13.11825942993164, uma_loss is 0.44508224725723267
loss is 13.567192077636719, acc1 is 0.732421875, acc5 is 2.734375, cma_loss is 13.130584716796875, uma_loss is 0.43660759925842285
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 124.52it/s]
15 epoch loss is 1.6859674726213727,                                    acc1 is 0.6122295673076923, acc5 is 2.5503305288461537
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 179.05it/s]
-----------------------------------
The average AUROC is 30.9569
The AUROC of I313 is 36.77
The AUROC of I314 is 25.14
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 9.9066
The Specificity of I313 is 13.22
The Specificity of I314 is 6.60
-----------------------------------
The average Youden Index is 9.9066
The Youden Index of I313 is 13.22
The Youden Index of I314 is 6.60
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.31it/s]
 31%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                             | 16/51 [05:25<10:34, 18.12s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 42.8498
The AUROC of I27 is 39.18
The AUROC of I34 is 50.46
The AUROC of I35 is 42.48
The AUROC of I36 is 39.28
-----------------------------------
The average Sensitivity is 46.5579
The Sensitivity of I27 is 3.05
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 0.00
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 59.9055
The Specificity of I27 is 97.71
The Specificity of I34 is 26.11
The Specificity of I35 is 100.00
The Specificity of I36 is 15.80
-----------------------------------
The average Youden Index is 6.4634
The Youden Index of I27 is 0.76
The Youden Index of I34 is 9.30
The Youden Index of I35 is 0.00
The Youden Index of I36 is 15.80
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.511691093444824, acc1 is 0.78125, acc5 is 3.173828125, cma_loss is 13.100076675415039, uma_loss is 0.41161441802978516
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 13.485517501831055, acc1 is 0.87890625, acc5 is 2.685546875, cma_loss is 13.057844161987305, uma_loss is 0.4276728630065918
loss is 13.50224781036377, acc1 is 0.5859375, acc5 is 2.880859375, cma_loss is 13.089061737060547, uma_loss is 0.4131864905357361
loss is 13.421310424804688, acc1 is 0.830078125, acc5 is 3.662109375, cma_loss is 13.00112533569336, uma_loss is 0.4201847016811371
loss is 13.52380084991455, acc1 is 0.68359375, acc5 is 3.369140625, cma_loss is 13.108089447021484, uma_loss is 0.4157117009162903
loss is 13.60921573638916, acc1 is 0.537109375, acc5 is 2.294921875, cma_loss is 13.190967559814453, uma_loss is 0.4182479977607727
loss is 13.588592529296875, acc1 is 0.830078125, acc5 is 2.734375, cma_loss is 13.163204193115234, uma_loss is 0.42538881301879883
loss is 13.535920143127441, acc1 is 0.9765625, acc5 is 3.076171875, cma_loss is 13.12038803100586, uma_loss is 0.41553181409835815
loss is 13.60757064819336, acc1 is 0.537109375, acc5 is 2.5390625, cma_loss is 13.176876068115234, uma_loss is 0.4306949973106384
loss is 13.507773399353027, acc1 is 0.87890625, acc5 is 3.02734375, cma_loss is 13.078496932983398, uma_loss is 0.42927631735801697
loss is 13.57005500793457, acc1 is 1.123046875, acc5 is 3.22265625, cma_loss is 13.147737503051758, uma_loss is 0.4223175346851349
loss is 13.528190612792969, acc1 is 0.732421875, acc5 is 2.392578125, cma_loss is 13.10527229309082, uma_loss is 0.4229183793067932
loss is 13.456171035766602, acc1 is 0.78125, acc5 is 2.587890625, cma_loss is 13.039714813232422, uma_loss is 0.41645634174346924
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 112.81it/s]
16 epoch loss is 1.674743398030599,                                    acc1 is 0.78125, acc5 is 2.8958834134615383
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 152.96it/s]
-----------------------------------
The average AUROC is 32.3513
The AUROC of I313 is 41.42
The AUROC of I314 is 23.28
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 8.5403
The Specificity of I313 is 12.62
The Specificity of I314 is 4.46
-----------------------------------
The average Youden Index is 8.5403
The Youden Index of I313 is 12.62
The Youden Index of I314 is 4.46
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.06it/s]
 33%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                       | 17/51 [05:44<10:23, 18.35s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.3184
The AUROC of I27 is 39.92
The AUROC of I34 is 51.35
The AUROC of I35 is 41.79
The AUROC of I36 is 40.22
-----------------------------------
The average Sensitivity is 71.3692
The Sensitivity of I27 is 4.06
The Sensitivity of I34 is 81.42
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 35.3101
The Specificity of I27 is 97.25
The Specificity of I34 is 27.47
The Specificity of I35 is 0.38
The Specificity of I36 is 16.14
-----------------------------------
The average Youden Index is 6.6793
The Youden Index of I27 is 1.31
The Youden Index of I34 is 8.89
The Youden Index of I35 is 0.38
The Youden Index of I36 is 16.14
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.4693603515625, acc1 is 0.927734375, acc5 is 3.125, cma_loss is 13.060859680175781, uma_loss is 0.40850090980529785
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.55s/it]
loss is 13.44927978515625, acc1 is 1.07421875, acc5 is 3.271484375, cma_loss is 13.014730453491211, uma_loss is 0.43454933166503906
loss is 13.520359992980957, acc1 is 0.439453125, acc5 is 2.587890625, cma_loss is 13.102088928222656, uma_loss is 0.4182708263397217
loss is 13.369072914123535, acc1 is 0.732421875, acc5 is 3.41796875, cma_loss is 12.964733123779297, uma_loss is 0.4043402373790741
loss is 13.39496898651123, acc1 is 0.78125, acc5 is 2.978515625, cma_loss is 12.990169525146484, uma_loss is 0.4047999083995819
loss is 13.498543739318848, acc1 is 0.830078125, acc5 is 2.880859375, cma_loss is 13.10301399230957, uma_loss is 0.3955293595790863
loss is 13.556798934936523, acc1 is 0.341796875, acc5 is 2.294921875, cma_loss is 13.1470947265625, uma_loss is 0.4097040593624115
loss is 13.6226224899292, acc1 is 0.634765625, acc5 is 2.9296875, cma_loss is 13.208805084228516, uma_loss is 0.41381770372390747
loss is 13.544685363769531, acc1 is 0.68359375, acc5 is 2.880859375, cma_loss is 13.130598068237305, uma_loss is 0.4140871465206146
loss is 13.557490348815918, acc1 is 0.537109375, acc5 is 2.685546875, cma_loss is 13.136737823486328, uma_loss is 0.4207521677017212
loss is 13.412470817565918, acc1 is 0.68359375, acc5 is 3.515625, cma_loss is 13.009281158447266, uma_loss is 0.4031898081302643
loss is 13.460387229919434, acc1 is 1.07421875, acc5 is 3.515625, cma_loss is 13.041254043579102, uma_loss is 0.41913318634033203
loss is 13.453907012939453, acc1 is 0.68359375, acc5 is 3.076171875, cma_loss is 13.040243148803711, uma_loss is 0.41366371512413025
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 119.93it/s]
17 epoch loss is 1.6696185520717075,                                    acc1 is 0.7249098557692307, acc5 is 3.0123197115384617
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 178.44it/s]
-----------------------------------
The average AUROC is 27.9456
The AUROC of I313 is 38.26
The AUROC of I314 is 17.63
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 8.8729
The Specificity of I313 is 12.15
The Specificity of I314 is 5.60
-----------------------------------
The average Youden Index is 8.8729
The Youden Index of I313 is 12.15
The Youden Index of I314 is 5.60
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.29it/s]
 35%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                 | 18/51 [06:02<10:03, 18.28s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.3111
The AUROC of I27 is 39.75
The AUROC of I34 is 51.03
The AUROC of I35 is 42.59
The AUROC of I36 is 43.88
-----------------------------------
The average Sensitivity is 46.3797
The Sensitivity of I27 is 1.52
The Sensitivity of I34 is 82.30
The Sensitivity of I35 is 1.69
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 60.7786
The Specificity of I27 is 99.31
The Specificity of I34 is 27.76
The Specificity of I35 is 99.70
The Specificity of I36 is 16.34
-----------------------------------
The average Youden Index is 7.1583
The Youden Index of I27 is 0.84
The Youden Index of I34 is 10.06
The Youden Index of I35 is 1.39
The Youden Index of I36 is 16.34
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.420610427856445, acc1 is 1.171875, acc5 is 3.80859375, cma_loss is 13.017135620117188, uma_loss is 0.4034745693206787
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.61s/it]
loss is 13.342878341674805, acc1 is 1.220703125, acc5 is 3.515625, cma_loss is 12.92803955078125, uma_loss is 0.41483914852142334
loss is 13.428522109985352, acc1 is 0.48828125, acc5 is 2.685546875, cma_loss is 12.997787475585938, uma_loss is 0.4307348430156708
loss is 13.395608901977539, acc1 is 0.830078125, acc5 is 3.125, cma_loss is 12.979047775268555, uma_loss is 0.4165607690811157
loss is 13.346240997314453, acc1 is 1.025390625, acc5 is 4.150390625, cma_loss is 12.91180419921875, uma_loss is 0.43443724513053894
loss is 13.434163093566895, acc1 is 0.732421875, acc5 is 3.759765625, cma_loss is 13.026067733764648, uma_loss is 0.4080955684185028
loss is 13.44409465789795, acc1 is 0.5859375, acc5 is 3.369140625, cma_loss is 13.001996994018555, uma_loss is 0.4420974850654602
loss is 13.425712585449219, acc1 is 1.07421875, acc5 is 3.3203125, cma_loss is 13.016021728515625, uma_loss is 0.4096909463405609
loss is 13.411649703979492, acc1 is 0.87890625, acc5 is 3.271484375, cma_loss is 13.000417709350586, uma_loss is 0.4112318158149719
loss is 13.34570598602295, acc1 is 0.68359375, acc5 is 2.978515625, cma_loss is 12.933032989501953, uma_loss is 0.41267311573028564
loss is 13.301629066467285, acc1 is 1.220703125, acc5 is 3.759765625, cma_loss is 12.886341094970703, uma_loss is 0.4152882397174835
loss is 13.472149848937988, acc1 is 0.927734375, acc5 is 3.125, cma_loss is 13.055623054504395, uma_loss is 0.41652658581733704
loss is 13.474995613098145, acc1 is 0.78125, acc5 is 2.5390625, cma_loss is 13.064811706542969, uma_loss is 0.4101836085319519
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 122.88it/s]
18 epoch loss is 1.659466298421224,                                    acc1 is 0.8939302884615384, acc5 is 3.339092548076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 157.39it/s]
-----------------------------------
The average AUROC is 37.9486
The AUROC of I313 is 44.30
The AUROC of I314 is 31.60
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 24.6238
The Specificity of I313 is 40.25
The Specificity of I314 is 8.99
-----------------------------------
The average Youden Index is 13.5127
The Youden Index of I313 is 18.03
The Youden Index of I314 is 8.99
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.19it/s]
 37%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                          | 19/51 [06:21<09:46, 18.33s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.2659
The AUROC of I27 is 38.94
The AUROC of I34 is 51.39
The AUROC of I35 is 43.11
The AUROC of I36 is 43.61
-----------------------------------
The average Sensitivity is 71.7351
The Sensitivity of I27 is 4.06
The Sensitivity of I34 is 86.73
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 35.1772
The Specificity of I27 is 97.25
The Specificity of I34 is 22.24
The Specificity of I35 is 0.83
The Specificity of I36 is 20.39
-----------------------------------
The average Youden Index is 6.9123
The Youden Index of I27 is 1.31
The Youden Index of I34 is 8.96
The Youden Index of I35 is 0.83
The Youden Index of I36 is 16.55
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.412467956542969, acc1 is 0.927734375, acc5 is 3.759765625, cma_loss is 13.01307487487793, uma_loss is 0.39939266443252563
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.61s/it]
loss is 13.324470520019531, acc1 is 1.318359375, acc5 is 4.052734375, cma_loss is 12.91897964477539, uma_loss is 0.40549126267433167
loss is 13.41037654876709, acc1 is 0.68359375, acc5 is 3.3203125, cma_loss is 13.003816604614258, uma_loss is 0.4065595269203186
loss is 13.248668670654297, acc1 is 1.025390625, acc5 is 4.150390625, cma_loss is 12.829479217529297, uma_loss is 0.4191897511482239
loss is 13.388442993164062, acc1 is 0.87890625, acc5 is 3.7109375, cma_loss is 12.987932205200195, uma_loss is 0.40051114559173584
loss is 13.4398775100708, acc1 is 0.732421875, acc5 is 3.466796875, cma_loss is 13.039424896240234, uma_loss is 0.4004528820514679
loss is 13.411638259887695, acc1 is 0.732421875, acc5 is 3.466796875, cma_loss is 13.001655578613281, uma_loss is 0.40998226404190063
loss is 13.370129585266113, acc1 is 0.927734375, acc5 is 4.00390625, cma_loss is 12.961555480957031, uma_loss is 0.4085736870765686
loss is 13.368145942687988, acc1 is 0.5859375, acc5 is 3.7109375, cma_loss is 12.967309951782227, uma_loss is 0.4008355438709259
loss is 13.293656349182129, acc1 is 1.26953125, acc5 is 3.759765625, cma_loss is 12.881417274475098, uma_loss is 0.41223862767219543
loss is 13.256169319152832, acc1 is 0.927734375, acc5 is 4.052734375, cma_loss is 12.851325988769531, uma_loss is 0.40484359860420227
loss is 13.315814971923828, acc1 is 1.171875, acc5 is 3.515625, cma_loss is 12.913128852844238, uma_loss is 0.40268582105636597
loss is 13.356066703796387, acc1 is 0.9765625, acc5 is 3.564453125, cma_loss is 12.955142974853516, uma_loss is 0.4009232819080353
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 123.84it/s]
19 epoch loss is 1.6532945269630068,                                    acc1 is 0.9352463942307693, acc5 is 3.7334735576923075
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 177.80it/s]
-----------------------------------
The average AUROC is 37.9636
The AUROC of I313 is 48.19
The AUROC of I314 is 27.74
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 14.7487
The Specificity of I313 is 25.17
The Specificity of I314 is 4.33
-----------------------------------
The average Youden Index is 9.1931
The Youden Index of I313 is 14.06
The Youden Index of I314 is 4.33
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.54it/s]
 39%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                    | 20/51 [06:39<09:23, 18.18s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 42.8437
The AUROC of I27 is 38.82
The AUROC of I34 is 51.18
The AUROC of I35 is 43.15
The AUROC of I36 is 38.22
-----------------------------------
The average Sensitivity is 72.1781
The Sensitivity of I27 is 6.09
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 34.5670
The Specificity of I27 is 94.73
The Specificity of I34 is 26.76
The Specificity of I35 is 0.98
The Specificity of I36 is 15.80
-----------------------------------
The average Youden Index is 6.7450
The Youden Index of I27 is 0.82
The Youden Index of I34 is 9.94
The Youden Index of I35 is 0.41
The Youden Index of I36 is 15.80
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.287199020385742, acc1 is 1.171875, acc5 is 4.052734375, cma_loss is 12.90449333190918, uma_loss is 0.38270533084869385
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.98it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.60s/it]
loss is 13.244208335876465, acc1 is 1.025390625, acc5 is 4.1015625, cma_loss is 12.86880874633789, uma_loss is 0.3753998279571533
loss is 13.228127479553223, acc1 is 0.9765625, acc5 is 3.662109375, cma_loss is 12.85488510131836, uma_loss is 0.3732427656650543
loss is 13.14413833618164, acc1 is 0.927734375, acc5 is 4.296875, cma_loss is 12.759256362915039, uma_loss is 0.38488149642944336
loss is 13.262685775756836, acc1 is 1.220703125, acc5 is 4.19921875, cma_loss is 12.876537322998047, uma_loss is 0.3861483931541443
loss is 13.304678916931152, acc1 is 0.78125, acc5 is 3.515625, cma_loss is 12.940496444702148, uma_loss is 0.36418265104293823
loss is 13.260053634643555, acc1 is 0.634765625, acc5 is 3.173828125, cma_loss is 12.88536262512207, uma_loss is 0.37469130754470825
loss is 13.18005084991455, acc1 is 1.26953125, acc5 is 4.296875, cma_loss is 12.797494888305664, uma_loss is 0.3825562000274658
loss is 13.281752586364746, acc1 is 1.123046875, acc5 is 4.1015625, cma_loss is 12.906169891357422, uma_loss is 0.37558242678642273
loss is 13.17422103881836, acc1 is 1.07421875, acc5 is 3.955078125, cma_loss is 12.79831314086914, uma_loss is 0.3759075403213501
loss is 13.18736457824707, acc1 is 1.025390625, acc5 is 3.90625, cma_loss is 12.813727378845215, uma_loss is 0.37363725900650024
loss is 13.26913833618164, acc1 is 1.318359375, acc5 is 4.58984375, cma_loss is 12.88034725189209, uma_loss is 0.38879072666168213
loss is 13.244271278381348, acc1 is 0.927734375, acc5 is 4.19921875, cma_loss is 12.874872207641602, uma_loss is 0.369398832321167
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 120.78it/s]
20 epoch loss is 1.6387418111165364,                                    acc1 is 1.0366586538461537, acc5 is 4.00390625
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 158.07it/s]
-----------------------------------
The average AUROC is 40.3865
The AUROC of I313 is 50.50
The AUROC of I314 is 30.27
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 19.0178
The Specificity of I313 is 30.44
The Specificity of I314 is 7.59
-----------------------------------
The average Youden Index is 13.4622
The Youden Index of I313 is 19.33
The Youden Index of I314 is 7.59
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.18it/s]
 41%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                              | 21/51 [06:57<09:07, 18.24s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.5037
The AUROC of I27 is 38.76
The AUROC of I34 is 51.56
The AUROC of I35 is 42.50
The AUROC of I36 is 41.20
-----------------------------------
The average Sensitivity is 70.2536
The Sensitivity of I27 is 3.55
The Sensitivity of I34 is 81.42
The Sensitivity of I35 is 96.05
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 36.4256
The Specificity of I27 is 97.02
The Specificity of I34 is 27.19
The Specificity of I35 is 5.49
The Specificity of I36 is 16.00
-----------------------------------
The average Youden Index is 6.6792
The Youden Index of I27 is 0.58
The Youden Index of I34 is 8.60
The Youden Index of I35 is 1.53
The Youden Index of I36 is 16.00
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.188082695007324, acc1 is 1.513671875, acc5 is 3.90625, cma_loss is 12.818742752075195, uma_loss is 0.36934027075767517
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 13.215165138244629, acc1 is 0.9765625, acc5 is 3.466796875, cma_loss is 12.867513656616211, uma_loss is 0.3476516902446747
loss is 13.303566932678223, acc1 is 0.9765625, acc5 is 3.369140625, cma_loss is 12.939168930053711, uma_loss is 0.3643980920314789
loss is 13.086690902709961, acc1 is 1.513671875, acc5 is 5.859375, cma_loss is 12.715615272521973, uma_loss is 0.37107521295547485
loss is 13.239604949951172, acc1 is 1.318359375, acc5 is 4.345703125, cma_loss is 12.873421669006348, uma_loss is 0.3661831319332123
loss is 13.27514934539795, acc1 is 0.9765625, acc5 is 4.1015625, cma_loss is 12.921280860900879, uma_loss is 0.3538683354854584
loss is 13.234658241271973, acc1 is 0.927734375, acc5 is 3.857421875, cma_loss is 12.892599105834961, uma_loss is 0.3420591950416565
loss is 13.19880199432373, acc1 is 0.732421875, acc5 is 3.564453125, cma_loss is 12.840839385986328, uma_loss is 0.35796260833740234
loss is 13.224512100219727, acc1 is 1.416015625, acc5 is 4.296875, cma_loss is 12.872897148132324, uma_loss is 0.35161539912223816
loss is 13.166686058044434, acc1 is 1.123046875, acc5 is 3.61328125, cma_loss is 12.80167007446289, uma_loss is 0.3650163412094116
loss is 13.094154357910156, acc1 is 1.171875, acc5 is 4.1015625, cma_loss is 12.744714736938477, uma_loss is 0.3494398593902588
loss is 13.220913887023926, acc1 is 1.123046875, acc5 is 3.80859375, cma_loss is 12.85605239868164, uma_loss is 0.36486193537712097
loss is 13.08615779876709, acc1 is 1.318359375, acc5 is 4.345703125, cma_loss is 12.736642837524414, uma_loss is 0.34951451420783997
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 95.06it/s]
21 epoch loss is 1.6336585181100027,                                    acc1 is 1.1606069711538463, acc5 is 4.048978365384615
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 177.26it/s]
-----------------------------------
The average AUROC is 27.2815
The AUROC of I313 is 36.75
The AUROC of I314 is 17.81
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 11.6735
The Specificity of I313 is 14.62
The Specificity of I314 is 8.73
-----------------------------------
The average Youden Index is 6.1179
The Youden Index of I313 is 3.51
The Youden Index of I314 is 8.73
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.21it/s]
 43%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                       | 22/51 [07:15<08:44, 18.09s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.1726
The AUROC of I27 is 38.60
The AUROC of I34 is 52.07
The AUROC of I35 is 42.24
The AUROC of I36 is 39.78
-----------------------------------
The average Sensitivity is 70.6409
The Sensitivity of I27 is 0.51
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 36.7254
The Specificity of I27 is 99.92
The Specificity of I34 is 25.97
The Specificity of I35 is 4.74
The Specificity of I36 is 16.27
-----------------------------------
The average Youden Index is 7.3663
The Youden Index of I27 is 0.43
The Youden Index of I34 is 9.15
The Youden Index of I35 is 3.61
The Youden Index of I36 is 16.27
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.108914375305176, acc1 is 1.5625, acc5 is 5.46875, cma_loss is 12.755605697631836, uma_loss is 0.35330823063850403
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.62s/it]
loss is 12.980735778808594, acc1 is 1.46484375, acc5 is 4.541015625, cma_loss is 12.654682159423828, uma_loss is 0.3260534405708313
loss is 13.09626293182373, acc1 is 1.025390625, acc5 is 4.58984375, cma_loss is 12.76552963256836, uma_loss is 0.33073312044143677
loss is 13.010139465332031, acc1 is 1.46484375, acc5 is 5.224609375, cma_loss is 12.66769790649414, uma_loss is 0.342441588640213
loss is 12.961094856262207, acc1 is 1.416015625, acc5 is 4.98046875, cma_loss is 12.623077392578125, uma_loss is 0.3380172848701477
loss is 13.088423728942871, acc1 is 1.3671875, acc5 is 4.833984375, cma_loss is 12.761747360229492, uma_loss is 0.32667598128318787
loss is 13.09115982055664, acc1 is 1.318359375, acc5 is 4.443359375, cma_loss is 12.765898704528809, uma_loss is 0.3252611458301544
loss is 13.02340316772461, acc1 is 1.025390625, acc5 is 4.39453125, cma_loss is 12.688082695007324, uma_loss is 0.3353206217288971
loss is 13.045475959777832, acc1 is 1.318359375, acc5 is 4.98046875, cma_loss is 12.710553169250488, uma_loss is 0.3349224627017975
loss is 13.01146411895752, acc1 is 1.66015625, acc5 is 4.541015625, cma_loss is 12.688762664794922, uma_loss is 0.32270127534866333
loss is 13.002464294433594, acc1 is 1.46484375, acc5 is 5.224609375, cma_loss is 12.6737060546875, uma_loss is 0.32875800132751465
loss is 13.182308197021484, acc1 is 1.07421875, acc5 is 4.541015625, cma_loss is 12.840346336364746, uma_loss is 0.3419613838195801
loss is 13.05196762084961, acc1 is 1.318359375, acc5 is 4.296875, cma_loss is 12.721173286437988, uma_loss is 0.3307947516441345
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 121.39it/s]
22 epoch loss is 1.6157506125313894,                                    acc1 is 1.3446514423076923, acc5 is 4.773888221153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 171.37it/s]
-----------------------------------
The average AUROC is 31.7374
The AUROC of I313 is 36.38
The AUROC of I314 is 27.09
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.8409
The Specificity of I313 is 16.09
The Specificity of I314 is 9.59
-----------------------------------
The average Youden Index is 7.2853
The Youden Index of I313 is 4.98
The Youden Index of I314 is 9.59
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.21it/s]
 45%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                 | 23/51 [07:33<08:25, 18.04s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.0339
The AUROC of I27 is 39.37
The AUROC of I34 is 51.55
The AUROC of I35 is 42.51
The AUROC of I36 is 38.71
-----------------------------------
The average Sensitivity is 70.7094
The Sensitivity of I27 is 2.54
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 98.31
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 36.8366
The Specificity of I27 is 98.24
The Specificity of I34 is 23.67
The Specificity of I35 is 5.04
The Specificity of I36 is 20.39
-----------------------------------
The average Youden Index is 7.5460
The Youden Index of I27 is 0.78
The Youden Index of I34 is 9.51
The Youden Index of I35 is 3.34
The Youden Index of I36 is 16.55
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.924077987670898, acc1 is 1.7578125, acc5 is 5.46875, cma_loss is 12.61698055267334, uma_loss is 0.3070978820323944
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.59s/it]
loss is 13.09890079498291, acc1 is 1.611328125, acc5 is 5.712890625, cma_loss is 12.763799667358398, uma_loss is 0.3351013660430908
loss is 13.006080627441406, acc1 is 1.5625, acc5 is 5.908203125, cma_loss is 12.672906875610352, uma_loss is 0.3331736922264099
loss is 13.021390914916992, acc1 is 1.953125, acc5 is 5.322265625, cma_loss is 12.699630737304688, uma_loss is 0.3217606246471405
loss is 12.87814998626709, acc1 is 1.611328125, acc5 is 5.712890625, cma_loss is 12.553465843200684, uma_loss is 0.3246839642524719
loss is 13.144242286682129, acc1 is 1.66015625, acc5 is 5.126953125, cma_loss is 12.827548027038574, uma_loss is 0.3166946470737457
loss is 13.130087852478027, acc1 is 1.46484375, acc5 is 4.931640625, cma_loss is 12.791250228881836, uma_loss is 0.33883780241012573
loss is 13.066225051879883, acc1 is 1.26953125, acc5 is 4.6875, cma_loss is 12.736397743225098, uma_loss is 0.32982754707336426
loss is 12.983806610107422, acc1 is 1.611328125, acc5 is 5.908203125, cma_loss is 12.66299819946289, uma_loss is 0.3208085298538208
loss is 12.90467643737793, acc1 is 1.708984375, acc5 is 6.396484375, cma_loss is 12.590941429138184, uma_loss is 0.3137352466583252
loss is 12.988155364990234, acc1 is 1.26953125, acc5 is 5.615234375, cma_loss is 12.658672332763672, uma_loss is 0.32948318123817444
loss is 13.02231502532959, acc1 is 1.708984375, acc5 is 5.76171875, cma_loss is 12.705546379089355, uma_loss is 0.3167685866355896
loss is 13.066996574401855, acc1 is 1.7578125, acc5 is 5.46875, cma_loss is 12.747106552124023, uma_loss is 0.3198899030685425
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 114.57it/s]
23 epoch loss is 1.611762909662156,                                    acc1 is 1.611328125, acc5 is 5.5401141826923075
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 174.33it/s]
-----------------------------------
The average AUROC is 34.1058
The AUROC of I313 is 41.53
The AUROC of I314 is 26.68
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 19.4159
The Specificity of I313 is 28.84
The Specificity of I314 is 9.99
-----------------------------------
The average Youden Index is 8.3048
The Youden Index of I313 is 6.62
The Youden Index of I314 is 9.99
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.36it/s]
 47%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                           | 24/51 [07:51<08:07, 18.06s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.1266
The AUROC of I27 is 40.40
The AUROC of I34 is 51.84
The AUROC of I35 is 42.38
The AUROC of I36 is 41.89
-----------------------------------
The average Sensitivity is 70.4605
The Sensitivity of I27 is 4.06
The Sensitivity of I34 is 82.30
The Sensitivity of I35 is 95.48
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 36.0603
The Specificity of I27 is 97.33
The Specificity of I34 is 26.11
The Specificity of I35 is 5.34
The Specificity of I36 is 15.46
-----------------------------------
The average Youden Index is 6.5208
The Youden Index of I27 is 1.39
The Youden Index of I34 is 8.41
The Youden Index of I35 is 0.82
The Youden Index of I36 is 15.46
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.876837730407715, acc1 is 2.001953125, acc5 is 5.859375, cma_loss is 12.573413848876953, uma_loss is 0.30342352390289307
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 12.96129035949707, acc1 is 2.001953125, acc5 is 6.298828125, cma_loss is 12.6432523727417, uma_loss is 0.31803831458091736
loss is 12.86146354675293, acc1 is 1.7578125, acc5 is 5.76171875, cma_loss is 12.547750473022461, uma_loss is 0.3137131333351135
loss is 12.76085090637207, acc1 is 2.197265625, acc5 is 6.689453125, cma_loss is 12.444297790527344, uma_loss is 0.3165528178215027
loss is 12.678729057312012, acc1 is 1.806640625, acc5 is 6.884765625, cma_loss is 12.36636734008789, uma_loss is 0.31236180663108826
loss is 12.885790824890137, acc1 is 2.1484375, acc5 is 6.25, cma_loss is 12.563096046447754, uma_loss is 0.32269519567489624
loss is 12.9450044631958, acc1 is 1.904296875, acc5 is 5.810546875, cma_loss is 12.619669914245605, uma_loss is 0.3253346383571625
loss is 12.849292755126953, acc1 is 1.904296875, acc5 is 6.15234375, cma_loss is 12.5292329788208, uma_loss is 0.32005998492240906
loss is 12.847512245178223, acc1 is 2.24609375, acc5 is 6.494140625, cma_loss is 12.532268524169922, uma_loss is 0.31524327397346497
loss is 12.841094017028809, acc1 is 1.85546875, acc5 is 6.4453125, cma_loss is 12.524227142333984, uma_loss is 0.31686723232269287
loss is 12.745243072509766, acc1 is 2.001953125, acc5 is 6.103515625, cma_loss is 12.446581840515137, uma_loss is 0.2986612617969513
loss is 12.889680862426758, acc1 is 1.66015625, acc5 is 5.517578125, cma_loss is 12.580217361450195, uma_loss is 0.3094639480113983
loss is 12.845877647399902, acc1 is 2.001953125, acc5 is 6.396484375, cma_loss is 12.529613494873047, uma_loss is 0.3162643611431122
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 121.90it/s]
24 epoch loss is 1.590368261791411,                                    acc1 is 1.9606370192307692, acc5 is 6.204927884615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 166.88it/s]
-----------------------------------
The average AUROC is 45.2304
The AUROC of I313 is 62.40
The AUROC of I314 is 28.06
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 30.8937
The Specificity of I313 is 47.60
The Specificity of I314 is 14.19
-----------------------------------
The average Youden Index is 25.3381
The Youden Index of I313 is 36.49
The Youden Index of I314 is 14.19
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
 49%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                    | 25/51 [08:09<07:51, 18.15s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.6974
The AUROC of I27 is 39.84
The AUROC of I34 is 52.10
The AUROC of I35 is 43.18
The AUROC of I36 is 43.66
-----------------------------------
The average Sensitivity is 71.8531
The Sensitivity of I27 is 6.09
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 95.48
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 34.9657
The Specificity of I27 is 95.11
The Specificity of I34 is 22.81
The Specificity of I35 is 6.54
The Specificity of I36 is 15.40
-----------------------------------
The average Youden Index is 6.8188
The Youden Index of I27 is 1.21
The Youden Index of I34 is 8.65
The Youden Index of I35 is 2.02
The Youden Index of I36 is 15.40
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.767068862915039, acc1 is 1.85546875, acc5 is 7.275390625, cma_loss is 12.44953441619873, uma_loss is 0.31753480434417725
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.57s/it]
loss is 12.877569198608398, acc1 is 1.85546875, acc5 is 6.396484375, cma_loss is 12.564095497131348, uma_loss is 0.31347396969795227
loss is 12.947754859924316, acc1 is 1.66015625, acc5 is 5.712890625, cma_loss is 12.637279510498047, uma_loss is 0.31047576665878296
loss is 12.707311630249023, acc1 is 2.392578125, acc5 is 7.91015625, cma_loss is 12.389646530151367, uma_loss is 0.3176654875278473
loss is 12.894632339477539, acc1 is 1.66015625, acc5 is 5.908203125, cma_loss is 12.584486961364746, uma_loss is 0.3101455569267273
loss is 13.01846694946289, acc1 is 1.904296875, acc5 is 5.517578125, cma_loss is 12.702142715454102, uma_loss is 0.31632447242736816
loss is 12.994684219360352, acc1 is 1.7578125, acc5 is 5.224609375, cma_loss is 12.685222625732422, uma_loss is 0.3094611167907715
loss is 12.898082733154297, acc1 is 2.05078125, acc5 is 6.15234375, cma_loss is 12.573559761047363, uma_loss is 0.3245231807231903
loss is 12.973358154296875, acc1 is 1.708984375, acc5 is 5.859375, cma_loss is 12.637401580810547, uma_loss is 0.33595630526542664
loss is 12.828022956848145, acc1 is 2.099609375, acc5 is 5.908203125, cma_loss is 12.506904602050781, uma_loss is 0.3211185932159424
loss is 12.735051155090332, acc1 is 1.7578125, acc5 is 6.103515625, cma_loss is 12.40701675415039, uma_loss is 0.32803431153297424
loss is 12.979313850402832, acc1 is 1.46484375, acc5 is 5.859375, cma_loss is 12.654736518859863, uma_loss is 0.3245773911476135
loss is 12.844934463500977, acc1 is 2.001953125, acc5 is 6.640625, cma_loss is 12.533327102661133, uma_loss is 0.3116070628166199
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 80.83it/s]
25 epoch loss is 1.5949166797456287,                                    acc1 is 1.8592247596153846, acc5 is 6.189903846153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 149.76it/s]
-----------------------------------
The average AUROC is 64.2867
The AUROC of I313 is 66.57
The AUROC of I314 is 62.00
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 44.1631
The Specificity of I313 is 59.21
The Specificity of I314 is 29.11
-----------------------------------
The average Youden Index is 33.0520
The Youden Index of I313 is 36.99
The Youden Index of I314 is 29.11
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.18it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                              | 26/51 [08:28<07:40, 18.42s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.9200
The AUROC of I27 is 41.45
The AUROC of I34 is 52.46
The AUROC of I35 is 42.32
The AUROC of I36 is 43.45
-----------------------------------
The average Sensitivity is 93.3628
The Sensitivity of I27 is 100.00
The Sensitivity of I34 is 73.45
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 12.9014
The Specificity of I27 is 0.31
The Specificity of I34 is 34.65
The Specificity of I35 is 1.73
The Specificity of I36 is 14.92
-----------------------------------
The average Youden Index is 6.2642
The Youden Index of I27 is 0.31
The Youden Index of I34 is 8.10
The Youden Index of I35 is 1.73
The Youden Index of I36 is 14.92
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.71517276763916, acc1 is 2.197265625, acc5 is 6.93359375, cma_loss is 12.39891242980957, uma_loss is 0.3162607252597809
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.03s/it]
loss is 12.822380065917969, acc1 is 2.1484375, acc5 is 6.787109375, cma_loss is 12.504858016967773, uma_loss is 0.3175220489501953
loss is 12.802871704101562, acc1 is 1.953125, acc5 is 6.982421875, cma_loss is 12.476003646850586, uma_loss is 0.3268683850765228
loss is 12.65304183959961, acc1 is 1.7578125, acc5 is 6.884765625, cma_loss is 12.319181442260742, uma_loss is 0.333859920501709
loss is 12.472945213317871, acc1 is 2.392578125, acc5 is 7.666015625, cma_loss is 12.161844253540039, uma_loss is 0.3111006021499634
loss is 12.728055000305176, acc1 is 2.44140625, acc5 is 7.03125, cma_loss is 12.433286666870117, uma_loss is 0.29476797580718994
loss is 12.847280502319336, acc1 is 1.3671875, acc5 is 6.0546875, cma_loss is 12.545905113220215, uma_loss is 0.3013755977153778
loss is 12.70577621459961, acc1 is 2.587890625, acc5 is 7.861328125, cma_loss is 12.380088806152344, uma_loss is 0.32568758726119995
loss is 12.667947769165039, acc1 is 2.392578125, acc5 is 8.10546875, cma_loss is 12.344402313232422, uma_loss is 0.3235454559326172
loss is 12.601643562316895, acc1 is 2.880859375, acc5 is 7.51953125, cma_loss is 12.290107727050781, uma_loss is 0.3115358054637909
loss is 12.554627418518066, acc1 is 2.63671875, acc5 is 8.69140625, cma_loss is 12.236837387084961, uma_loss is 0.3177903890609741
loss is 12.61292839050293, acc1 is 2.34375, acc5 is 8.447265625, cma_loss is 12.316333770751953, uma_loss is 0.2965943217277527
loss is 12.637686729431152, acc1 is 2.44140625, acc5 is 7.6171875, cma_loss is 12.341670989990234, uma_loss is 0.29601603746414185
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 84.09it/s]
26 epoch loss is 1.5697367350260416,                                    acc1 is 2.2723858173076925, acc5 is 7.429387019230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 91.30it/s]
-----------------------------------
The average AUROC is 58.4955
The AUROC of I313 is 69.72
The AUROC of I314 is 47.27
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 42.0383
The Specificity of I313 is 66.29
The Specificity of I314 is 17.79
-----------------------------------
The average Youden Index is 30.9272
The Youden Index of I313 is 44.07
The Youden Index of I314 is 17.79
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.77it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                        | 27/51 [08:53<08:04, 20.21s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.9933
The AUROC of I27 is 45.69
The AUROC of I34 is 51.45
The AUROC of I35 is 43.55
The AUROC of I36 is 39.28
-----------------------------------
The average Sensitivity is 93.7373
The Sensitivity of I27 is 92.89
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 13.8124
The Specificity of I27 is 12.90
The Specificity of I34 is 24.75
The Specificity of I35 is 3.08
The Specificity of I36 is 14.52
-----------------------------------
The average Youden Index is 7.5497
The Youden Index of I27 is 5.79
The Youden Index of I34 is 7.93
The Youden Index of I35 is 1.95
The Youden Index of I36 is 14.52
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.561033248901367, acc1 is 2.685546875, acc5 is 7.958984375, cma_loss is 12.287708282470703, uma_loss is 0.27332448959350586
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.84s/it]
loss is 12.675606727600098, acc1 is 2.1484375, acc5 is 7.080078125, cma_loss is 12.376382827758789, uma_loss is 0.2992236018180847
loss is 12.67212200164795, acc1 is 2.34375, acc5 is 7.91015625, cma_loss is 12.355710983276367, uma_loss is 0.3164106011390686
loss is 12.468339920043945, acc1 is 2.685546875, acc5 is 7.861328125, cma_loss is 12.165006637573242, uma_loss is 0.3033331036567688
loss is 12.450230598449707, acc1 is 2.24609375, acc5 is 8.740234375, cma_loss is 12.149456977844238, uma_loss is 0.3007732331752777
loss is 12.519179344177246, acc1 is 2.783203125, acc5 is 8.837890625, cma_loss is 12.24862289428711, uma_loss is 0.2705564498901367
loss is 12.544622421264648, acc1 is 2.5390625, acc5 is 8.88671875, cma_loss is 12.26416301727295, uma_loss is 0.2804589867591858
loss is 12.65561294555664, acc1 is 2.63671875, acc5 is 7.6171875, cma_loss is 12.36505126953125, uma_loss is 0.2905619442462921
loss is 12.626163482666016, acc1 is 2.734375, acc5 is 8.0078125, cma_loss is 12.32295036315918, uma_loss is 0.3032133877277374
loss is 12.54285717010498, acc1 is 2.34375, acc5 is 8.154296875, cma_loss is 12.237899780273438, uma_loss is 0.30495762825012207
loss is 12.490579605102539, acc1 is 2.587890625, acc5 is 7.763671875, cma_loss is 12.1795654296875, uma_loss is 0.31101399660110474
loss is 12.57906723022461, acc1 is 2.24609375, acc5 is 8.056640625, cma_loss is 12.270915985107422, uma_loss is 0.3081516623497009
loss is 12.457003593444824, acc1 is 2.783203125, acc5 is 8.349609375, cma_loss is 12.175710678100586, uma_loss is 0.281293123960495
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 96.27it/s]
27 epoch loss is 1.554689697992234,                                    acc1 is 2.520282451923077, acc5 is 8.094200721153847
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 149.28it/s]
-----------------------------------
The average AUROC is 60.2678
The AUROC of I313 is 67.28
The AUROC of I314 is 53.25
-----------------------------------
The average Sensitivity is 50.0000
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 33.33
-----------------------------------
The average Specificity is 77.4488
The Specificity of I313 is 67.09
The Specificity of I314 is 87.81
-----------------------------------
The average Youden Index is 27.4488
The Youden Index of I313 is 33.76
The Youden Index of I314 is 21.14
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
 55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                 | 28/51 [09:13<07:46, 20.29s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.3412
The AUROC of I27 is 54.45
The AUROC of I34 is 50.29
The AUROC of I35 is 43.34
The AUROC of I36 is 41.28
-----------------------------------
The average Sensitivity is 91.1159
The Sensitivity of I27 is 79.19
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 18.1108
The Specificity of I27 is 30.53
The Specificity of I34 is 23.53
The Specificity of I35 is 2.78
The Specificity of I36 is 15.60
-----------------------------------
The average Youden Index is 9.2267
The Youden Index of I27 is 9.72
The Youden Index of I34 is 9.37
The Youden Index of I35 is 2.22
The Youden Index of I36 is 15.60
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.419486999511719, acc1 is 2.83203125, acc5 is 8.30078125, cma_loss is 12.140735626220703, uma_loss is 0.27875110507011414
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.76s/it]
loss is 12.63159465789795, acc1 is 2.587890625, acc5 is 7.958984375, cma_loss is 12.34736442565918, uma_loss is 0.2842303514480591
loss is 12.490327835083008, acc1 is 2.685546875, acc5 is 7.91015625, cma_loss is 12.213617324829102, uma_loss is 0.2767102122306824
loss is 12.386919021606445, acc1 is 3.076171875, acc5 is 9.08203125, cma_loss is 12.106895446777344, uma_loss is 0.2800237238407135
loss is 12.334169387817383, acc1 is 2.5390625, acc5 is 9.619140625, cma_loss is 12.050620079040527, uma_loss is 0.2835496962070465
loss is 12.32757568359375, acc1 is 3.857421875, acc5 is 10.205078125, cma_loss is 12.04520320892334, uma_loss is 0.28237247467041016
loss is 12.56276798248291, acc1 is 3.02734375, acc5 is 9.375, cma_loss is 12.273603439331055, uma_loss is 0.2891645133495331
loss is 12.455119132995605, acc1 is 3.515625, acc5 is 8.69140625, cma_loss is 12.17673110961914, uma_loss is 0.27838802337646484
loss is 12.40737247467041, acc1 is 2.978515625, acc5 is 9.716796875, cma_loss is 12.130395889282227, uma_loss is 0.27697646617889404
loss is 12.432734489440918, acc1 is 3.125, acc5 is 8.251953125, cma_loss is 12.137580871582031, uma_loss is 0.29515326023101807
loss is 12.290472984313965, acc1 is 2.44140625, acc5 is 8.740234375, cma_loss is 12.001428604125977, uma_loss is 0.28904402256011963
loss is 12.337457656860352, acc1 is 3.369140625, acc5 is 9.228515625, cma_loss is 12.044944763183594, uma_loss is 0.2925124168395996
loss is 12.341194152832031, acc1 is 3.564453125, acc5 is 9.765625, cma_loss is 12.06643295288086, uma_loss is 0.27476102113723755
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 111.05it/s]
28 epoch loss is 1.5373065948486329,                                    acc1 is 3.046123798076923, acc5 is 8.988131009615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 137.86it/s]
-----------------------------------
The average AUROC is 59.2355
The AUROC of I313 is 78.68
The AUROC of I314 is 39.80
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 33.33
-----------------------------------
The average Specificity is 73.9477
The Specificity of I313 is 63.62
The Specificity of I314 is 84.28
-----------------------------------
The average Youden Index is 35.0588
The Youden Index of I313 is 52.51
The Youden Index of I314 is 17.61
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.72it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                           | 29/51 [09:32<07:18, 19.92s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.5620
The AUROC of I27 is 49.32
The AUROC of I34 is 50.20
The AUROC of I35 is 45.76
The AUROC of I36 is 40.97
-----------------------------------
The average Sensitivity is 90.3049
The Sensitivity of I27 is 82.23
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 94.92
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 19.6186
The Specificity of I27 is 27.02
The Specificity of I34 is 25.54
The Specificity of I35 is 10.45
The Specificity of I36 is 15.46
-----------------------------------
The average Youden Index is 9.9235
The Youden Index of I27 is 9.26
The Youden Index of I34 is 9.61
The Youden Index of I35 is 5.37
The Youden Index of I36 is 15.46
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.398126602172852, acc1 is 2.783203125, acc5 is 9.814453125, cma_loss is 12.124181747436523, uma_loss is 0.2739447355270386
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.67s/it]
loss is 12.488325119018555, acc1 is 2.9296875, acc5 is 8.88671875, cma_loss is 12.213435173034668, uma_loss is 0.2748900055885315
loss is 12.570332527160645, acc1 is 2.783203125, acc5 is 8.740234375, cma_loss is 12.264822959899902, uma_loss is 0.3055093288421631
loss is 12.270219802856445, acc1 is 3.22265625, acc5 is 9.521484375, cma_loss is 11.986013412475586, uma_loss is 0.2842063307762146
loss is 12.251285552978516, acc1 is 3.125, acc5 is 9.27734375, cma_loss is 11.944023132324219, uma_loss is 0.3072627782821655
loss is 12.351312637329102, acc1 is 3.759765625, acc5 is 9.619140625, cma_loss is 12.075661659240723, uma_loss is 0.27565136551856995
loss is 12.383923530578613, acc1 is 3.173828125, acc5 is 10.7421875, cma_loss is 12.08305549621582, uma_loss is 0.3008684813976288
loss is 12.225485801696777, acc1 is 3.90625, acc5 is 10.009765625, cma_loss is 11.947769165039062, uma_loss is 0.2777170240879059
loss is 12.249590873718262, acc1 is 3.41796875, acc5 is 10.15625, cma_loss is 11.958620071411133, uma_loss is 0.29097095131874084
loss is 12.196513175964355, acc1 is 3.02734375, acc5 is 9.08203125, cma_loss is 11.90422248840332, uma_loss is 0.29229074716567993
loss is 12.185829162597656, acc1 is 3.22265625, acc5 is 10.009765625, cma_loss is 11.888742446899414, uma_loss is 0.29708659648895264
loss is 12.24605941772461, acc1 is 3.02734375, acc5 is 10.7421875, cma_loss is 11.955070495605469, uma_loss is 0.2909887731075287
loss is 12.210248947143555, acc1 is 3.173828125, acc5 is 9.27734375, cma_loss is 11.938488006591797, uma_loss is 0.27176082134246826
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 107.77it/s]
29 epoch loss is 1.5240690776279995,                                    acc1 is 3.1963641826923075, acc5 is 9.682992788461538
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 160.57it/s]
-----------------------------------
The average AUROC is 69.4392
The AUROC of I313 is 68.83
The AUROC of I314 is 70.05
-----------------------------------
The average Sensitivity is 86.1111
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 56.0170
The Specificity of I313 is 54.34
The Specificity of I314 is 57.69
-----------------------------------
The average Youden Index is 42.1281
The Youden Index of I313 is 43.23
The Youden Index of I314 is 41.03
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.79it/s]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                     | 30/51 [09:54<07:07, 20.36s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.8579
The AUROC of I27 is 56.17
The AUROC of I34 is 52.09
The AUROC of I35 is 42.56
The AUROC of I36 is 40.61
-----------------------------------
The average Sensitivity is 84.0012
The Sensitivity of I27 is 56.35
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 26.3025
The Specificity of I27 is 57.40
The Specificity of I34 is 25.39
The Specificity of I35 is 3.91
The Specificity of I36 is 18.50
-----------------------------------
The average Youden Index is 10.3037
The Youden Index of I27 is 13.75
The Youden Index of I34 is 9.47
The Youden Index of I35 is 3.34
The Youden Index of I36 is 14.65
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.217731475830078, acc1 is 3.515625, acc5 is 9.66796875, cma_loss is 11.924101829528809, uma_loss is 0.29362916946411133
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.74s/it]
loss is 12.220259666442871, acc1 is 3.61328125, acc5 is 10.64453125, cma_loss is 11.946847915649414, uma_loss is 0.27341192960739136
loss is 12.382407188415527, acc1 is 3.41796875, acc5 is 8.935546875, cma_loss is 12.101127624511719, uma_loss is 0.28127968311309814
loss is 12.238898277282715, acc1 is 3.22265625, acc5 is 10.107421875, cma_loss is 11.974865913391113, uma_loss is 0.26403260231018066
loss is 12.052935600280762, acc1 is 3.564453125, acc5 is 10.3515625, cma_loss is 11.781525611877441, uma_loss is 0.2714103162288666
loss is 12.153582572937012, acc1 is 3.271484375, acc5 is 10.205078125, cma_loss is 11.884105682373047, uma_loss is 0.2694764733314514
loss is 12.426241874694824, acc1 is 3.41796875, acc5 is 9.47265625, cma_loss is 12.161515235900879, uma_loss is 0.26472657918930054
loss is 12.432339668273926, acc1 is 4.150390625, acc5 is 9.86328125, cma_loss is 12.150028228759766, uma_loss is 0.28231149911880493
loss is 12.357138633728027, acc1 is 3.515625, acc5 is 9.08203125, cma_loss is 12.094614028930664, uma_loss is 0.26252445578575134
loss is 12.370514869689941, acc1 is 2.783203125, acc5 is 9.66796875, cma_loss is 12.086894989013672, uma_loss is 0.28361988067626953
loss is 12.25662899017334, acc1 is 3.125, acc5 is 10.205078125, cma_loss is 11.99726676940918, uma_loss is 0.25936180353164673
loss is 12.301042556762695, acc1 is 2.978515625, acc5 is 9.716796875, cma_loss is 12.022104263305664, uma_loss is 0.2789387106895447
loss is 12.273375511169434, acc1 is 3.22265625, acc5 is 9.716796875, cma_loss is 11.996726036071777, uma_loss is 0.2766498625278473
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 105.46it/s]
30 epoch loss is 1.5207913989112491,                                    acc1 is 3.369140625, acc5 is 9.818209134615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 133.47it/s]
-----------------------------------
The average AUROC is 52.3955
The AUROC of I313 is 63.75
The AUROC of I314 is 41.04
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 31.2195
The Specificity of I313 is 40.32
The Specificity of I314 is 22.12
-----------------------------------
The average Youden Index is 25.6640
The Youden Index of I313 is 29.21
The Youden Index of I314 is 22.12
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.69it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                              | 31/51 [10:13<06:40, 20.02s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.2634
The AUROC of I27 is 57.02
The AUROC of I34 is 51.29
The AUROC of I35 is 42.30
The AUROC of I36 is 42.44
-----------------------------------
The average Sensitivity is 79.8168
The Sensitivity of I27 is 43.15
The Sensitivity of I34 is 80.53
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 30.5989
The Specificity of I27 is 70.92
The Specificity of I34 is 28.69
The Specificity of I35 is 3.61
The Specificity of I36 is 19.18
-----------------------------------
The average Youden Index is 10.4157
The Youden Index of I27 is 14.06
The Youden Index of I34 is 9.23
The Youden Index of I35 is 3.04
The Youden Index of I36 is 15.33
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 12.105472564697266, acc1 is 3.857421875, acc5 is 10.791015625, cma_loss is 11.839437484741211, uma_loss is 0.2660348117351532
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.87s/it]
loss is 12.276612281799316, acc1 is 3.41796875, acc5 is 11.03515625, cma_loss is 12.008811950683594, uma_loss is 0.2678004801273346
loss is 12.29468059539795, acc1 is 3.271484375, acc5 is 9.423828125, cma_loss is 12.017181396484375, uma_loss is 0.27749931812286377
loss is 12.034379959106445, acc1 is 4.248046875, acc5 is 12.01171875, cma_loss is 11.770153045654297, uma_loss is 0.2642272412776947
loss is 12.06352424621582, acc1 is 4.296875, acc5 is 11.669921875, cma_loss is 11.80826473236084, uma_loss is 0.2552596926689148
loss is 12.108135223388672, acc1 is 3.80859375, acc5 is 11.376953125, cma_loss is 11.835222244262695, uma_loss is 0.27291345596313477
loss is 12.283736228942871, acc1 is 4.150390625, acc5 is 9.47265625, cma_loss is 12.02713394165039, uma_loss is 0.25660261511802673
loss is 12.09439468383789, acc1 is 4.345703125, acc5 is 11.279296875, cma_loss is 11.826333999633789, uma_loss is 0.2680605947971344
loss is 12.040412902832031, acc1 is 5.2734375, acc5 is 13.037109375, cma_loss is 11.766514778137207, uma_loss is 0.27389854192733765
loss is 12.074516296386719, acc1 is 4.00390625, acc5 is 10.9375, cma_loss is 11.80290412902832, uma_loss is 0.2716124951839447
loss is 12.048906326293945, acc1 is 4.541015625, acc5 is 11.9140625, cma_loss is 11.779268264770508, uma_loss is 0.2696384787559509
loss is 11.913320541381836, acc1 is 4.638671875, acc5 is 12.060546875, cma_loss is 11.63624382019043, uma_loss is 0.27707692980766296
loss is 11.89893913269043, acc1 is 4.833984375, acc5 is 12.646484375, cma_loss is 11.625909805297852, uma_loss is 0.27302971482276917
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 109.73it/s]
31 epoch loss is 1.4974955331711541,                                    acc1 is 4.206730769230769, acc5 is 11.358173076923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 117.90it/s]
-----------------------------------
The average AUROC is 51.1418
The AUROC of I313 is 77.76
The AUROC of I314 is 24.53
-----------------------------------
The average Sensitivity is 83.3333
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 41.6859
The Specificity of I313 is 80.37
The Specificity of I314 is 3.00
-----------------------------------
The average Youden Index is 25.0192
The Youden Index of I313 is 47.04
The Youden Index of I314 is 3.00
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.70it/s]
 63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                        | 32/51 [10:32<06:17, 19.89s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.5533
The AUROC of I27 is 52.39
The AUROC of I34 is 50.67
The AUROC of I35 is 45.99
The AUROC of I36 is 25.16
-----------------------------------
The average Sensitivity is 71.4507
The Sensitivity of I27 is 89.85
The Sensitivity of I34 is 77.88
The Sensitivity of I35 is 18.08
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 34.3290
The Specificity of I27 is 18.24
The Specificity of I34 is 31.06
The Specificity of I35 is 85.71
The Specificity of I36 is 2.30
-----------------------------------
The average Youden Index is 5.7797
The Youden Index of I27 is 8.09
The Youden Index of I34 is 8.94
The Youden Index of I35 is 3.79
The Youden Index of I36 is 2.30
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.968338012695312, acc1 is 3.857421875, acc5 is 12.939453125, cma_loss is 11.707183837890625, uma_loss is 0.26115456223487854
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.83s/it]
loss is 11.954551696777344, acc1 is 4.638671875, acc5 is 12.890625, cma_loss is 11.675529479980469, uma_loss is 0.2790226936340332
loss is 11.962523460388184, acc1 is 4.58984375, acc5 is 11.962890625, cma_loss is 11.70767879486084, uma_loss is 0.2548443675041199
loss is 11.948371887207031, acc1 is 3.857421875, acc5 is 13.525390625, cma_loss is 11.674856185913086, uma_loss is 0.27351611852645874
loss is 11.73596477508545, acc1 is 5.322265625, acc5 is 13.28125, cma_loss is 11.479169845581055, uma_loss is 0.2567947208881378
loss is 11.91646671295166, acc1 is 4.248046875, acc5 is 12.744140625, cma_loss is 11.655763626098633, uma_loss is 0.2607026994228363
loss is 11.826067924499512, acc1 is 5.419921875, acc5 is 12.744140625, cma_loss is 11.564626693725586, uma_loss is 0.26144129037857056
loss is 11.861001968383789, acc1 is 4.4921875, acc5 is 13.18359375, cma_loss is 11.600903511047363, uma_loss is 0.2600981593132019
loss is 12.046679496765137, acc1 is 4.39453125, acc5 is 12.353515625, cma_loss is 11.780826568603516, uma_loss is 0.2658529281616211
loss is 11.965348243713379, acc1 is 4.833984375, acc5 is 12.79296875, cma_loss is 11.695638656616211, uma_loss is 0.26970982551574707
loss is 11.949795722961426, acc1 is 4.98046875, acc5 is 11.767578125, cma_loss is 11.664051055908203, uma_loss is 0.2857450246810913
loss is 11.85830307006836, acc1 is 5.2734375, acc5 is 13.0859375, cma_loss is 11.575289726257324, uma_loss is 0.28301292657852173
loss is 11.842519760131836, acc1 is 5.029296875, acc5 is 12.744140625, cma_loss is 11.577947616577148, uma_loss is 0.2645718455314636
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 128.41it/s]
32 epoch loss is 1.4746279307774135,                                    acc1 is 4.6875, acc5 is 12.770432692307692
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 154.45it/s]
-----------------------------------
The average AUROC is 41.5340
The AUROC of I313 is 63.58
The AUROC of I314 is 19.49
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 41.7192
The Specificity of I313 is 80.37
The Specificity of I314 is 3.06
-----------------------------------
The average Youden Index is 19.4970
The Youden Index of I313 is 35.93
The Youden Index of I314 is 3.06
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.62it/s]
 65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                  | 33/51 [10:51<05:53, 19.65s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.8208
The AUROC of I27 is 44.25
The AUROC of I34 is 50.47
The AUROC of I35 is 44.46
The AUROC of I36 is 40.11
-----------------------------------
The average Sensitivity is 92.5159
The Sensitivity of I27 is 94.92
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 94.92
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 15.1175
The Specificity of I27 is 11.30
The Specificity of I34 is 24.82
The Specificity of I35 is 9.70
The Specificity of I36 is 14.65
-----------------------------------
The average Youden Index is 7.6334
The Youden Index of I27 is 6.22
The Youden Index of I34 is 8.89
The Youden Index of I35 is 4.61
The Youden Index of I36 is 10.81
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.624537467956543, acc1 is 4.6875, acc5 is 14.111328125, cma_loss is 11.386297225952148, uma_loss is 0.23824036121368408
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.88s/it]
loss is 11.75602912902832, acc1 is 5.17578125, acc5 is 14.2578125, cma_loss is 11.500606536865234, uma_loss is 0.2554229199886322
loss is 12.152371406555176, acc1 is 4.00390625, acc5 is 11.279296875, cma_loss is 11.891691207885742, uma_loss is 0.2606803774833679
loss is 11.983699798583984, acc1 is 3.564453125, acc5 is 11.62109375, cma_loss is 11.715493202209473, uma_loss is 0.26820698380470276
loss is 11.881487846374512, acc1 is 4.98046875, acc5 is 12.939453125, cma_loss is 11.612847328186035, uma_loss is 0.26864051818847656
loss is 11.732888221740723, acc1 is 5.517578125, acc5 is 14.599609375, cma_loss is 11.468132972717285, uma_loss is 0.2647554278373718
loss is 11.751474380493164, acc1 is 5.2734375, acc5 is 13.232421875, cma_loss is 11.495765686035156, uma_loss is 0.2557082176208496
loss is 11.684393882751465, acc1 is 5.224609375, acc5 is 14.599609375, cma_loss is 11.437615394592285, uma_loss is 0.24677860736846924
loss is 11.767889022827148, acc1 is 5.2734375, acc5 is 14.697265625, cma_loss is 11.504369735717773, uma_loss is 0.26351916790008545
loss is 11.761934280395508, acc1 is 5.2734375, acc5 is 13.76953125, cma_loss is 11.48576831817627, uma_loss is 0.27616602182388306
loss is 11.737672805786133, acc1 is 4.931640625, acc5 is 13.623046875, cma_loss is 11.462835311889648, uma_loss is 0.2748379111289978
loss is 11.785744667053223, acc1 is 5.17578125, acc5 is 13.8671875, cma_loss is 11.504312515258789, uma_loss is 0.28143200278282166
loss is 11.628265380859375, acc1 is 5.322265625, acc5 is 13.57421875, cma_loss is 11.36920166015625, uma_loss is 0.2590635120868683
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 97.84it/s]
33 epoch loss is 1.4595084599086217,                                    acc1 is 4.9541766826923075, acc5 is 13.551682692307692
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 150.66it/s]
-----------------------------------
The average AUROC is 41.2959
The AUROC of I313 is 73.45
The AUROC of I314 is 9.14
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 24.1300
The Specificity of I313 is 46.06
The Specificity of I314 is 2.20
-----------------------------------
The average Youden Index is 24.1300
The Youden Index of I313 is 46.06
The Youden Index of I314 is 2.20
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.60it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                           | 34/51 [11:11<05:34, 19.65s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.7902
The AUROC of I27 is 47.99
The AUROC of I34 is 51.30
The AUROC of I35 is 50.79
The AUROC of I36 is 45.08
-----------------------------------
The average Sensitivity is 76.8550
The Sensitivity of I27 is 80.20
The Sensitivity of I34 is 62.83
The Sensitivity of I35 is 83.62
The Sensitivity of I36 is 80.77
-----------------------------------
The average Specificity is 32.1559
The Specificity of I27 is 26.03
The Specificity of I34 is 45.41
The Specificity of I35 is 24.44
The Specificity of I36 is 32.75
-----------------------------------
The average Youden Index is 9.0109
The Youden Index of I27 is 6.23
The Youden Index of I34 is 8.24
The Youden Index of I35 is 8.05
The Youden Index of I36 is 13.52
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.404674530029297, acc1 is 4.931640625, acc5 is 14.794921875, cma_loss is 11.15290355682373, uma_loss is 0.251770555973053
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.77s/it]
loss is 11.509819030761719, acc1 is 4.931640625, acc5 is 14.892578125, cma_loss is 11.254291534423828, uma_loss is 0.25552791357040405
loss is 11.67972183227539, acc1 is 4.931640625, acc5 is 13.525390625, cma_loss is 11.411800384521484, uma_loss is 0.26792141795158386
loss is 11.688329696655273, acc1 is 5.810546875, acc5 is 15.087890625, cma_loss is 11.428914070129395, uma_loss is 0.25941526889801025
loss is 11.64442253112793, acc1 is 5.322265625, acc5 is 14.55078125, cma_loss is 11.368444442749023, uma_loss is 0.2759785056114197
loss is 11.693004608154297, acc1 is 5.56640625, acc5 is 14.990234375, cma_loss is 11.428651809692383, uma_loss is 0.2643527090549469
loss is 11.655255317687988, acc1 is 4.58984375, acc5 is 13.8671875, cma_loss is 11.374221801757812, uma_loss is 0.28103315830230713
loss is 11.592312812805176, acc1 is 6.103515625, acc5 is 15.625, cma_loss is 11.326099395751953, uma_loss is 0.26621371507644653
loss is 11.623783111572266, acc1 is 7.12890625, acc5 is 15.91796875, cma_loss is 11.37564468383789, uma_loss is 0.24813848733901978
loss is 11.91859245300293, acc1 is 4.39453125, acc5 is 11.865234375, cma_loss is 11.643434524536133, uma_loss is 0.27515777945518494
loss is 11.579448699951172, acc1 is 5.56640625, acc5 is 14.2578125, cma_loss is 11.302587509155273, uma_loss is 0.2768613398075104
loss is 11.806279182434082, acc1 is 4.78515625, acc5 is 12.744140625, cma_loss is 11.517311096191406, uma_loss is 0.28896838426589966
loss is 11.65027141571045, acc1 is 4.8828125, acc5 is 14.35546875, cma_loss is 11.375350952148438, uma_loss is 0.27492091059684753
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 105.66it/s]
34 epoch loss is 1.442342049734933,                                    acc1 is 5.303485576923077, acc5 is 14.344200721153847
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 152.05it/s]
-----------------------------------
The average AUROC is 45.1049
The AUROC of I313 is 75.69
The AUROC of I314 is 14.52
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 29.7682
The Specificity of I313 is 54.67
The Specificity of I314 is 4.86
-----------------------------------
The average Youden Index is 29.7682
The Youden Index of I313 is 54.67
The Youden Index of I314 is 4.86
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.68it/s]
 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                     | 35/51 [11:31<05:14, 19.66s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.3418
The AUROC of I27 is 45.50
The AUROC of I34 is 52.75
The AUROC of I35 is 45.33
The AUROC of I36 is 41.78
-----------------------------------
The average Sensitivity is 85.2250
The Sensitivity of I27 is 90.36
The Sensitivity of I34 is 61.06
The Sensitivity of I35 is 97.18
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 22.0501
The Specificity of I27 is 13.97
The Specificity of I34 is 46.20
The Specificity of I35 is 8.72
The Specificity of I36 is 19.31
-----------------------------------
The average Youden Index is 7.2752
The Youden Index of I27 is 4.32
The Youden Index of I34 is 7.26
The Youden Index of I35 is 5.90
The Youden Index of I36 is 11.62
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.678412437438965, acc1 is 4.78515625, acc5 is 13.37890625, cma_loss is 11.410850524902344, uma_loss is 0.26756179332733154
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.92s/it]
loss is 11.61989974975586, acc1 is 5.517578125, acc5 is 14.990234375, cma_loss is 11.367140769958496, uma_loss is 0.2527587115764618
loss is 11.707389831542969, acc1 is 5.56640625, acc5 is 14.84375, cma_loss is 11.438533782958984, uma_loss is 0.2688565254211426
loss is 11.656912803649902, acc1 is 5.615234375, acc5 is 15.380859375, cma_loss is 11.397455215454102, uma_loss is 0.2594572901725769
loss is 11.45942211151123, acc1 is 5.810546875, acc5 is 15.72265625, cma_loss is 11.205501556396484, uma_loss is 0.2539207339286804
loss is 11.655538558959961, acc1 is 6.640625, acc5 is 16.162109375, cma_loss is 11.395421981811523, uma_loss is 0.2601170241832733
loss is 11.884044647216797, acc1 is 5.37109375, acc5 is 13.134765625, cma_loss is 11.62878131866455, uma_loss is 0.25526297092437744
loss is 11.679609298706055, acc1 is 6.73828125, acc5 is 16.2109375, cma_loss is 11.410524368286133, uma_loss is 0.2690851092338562
loss is 11.452629089355469, acc1 is 6.640625, acc5 is 16.650390625, cma_loss is 11.206701278686523, uma_loss is 0.24592794477939606
loss is 11.500737190246582, acc1 is 6.396484375, acc5 is 16.6015625, cma_loss is 11.257306098937988, uma_loss is 0.24343091249465942
loss is 11.498364448547363, acc1 is 6.591796875, acc5 is 16.455078125, cma_loss is 11.227530479431152, uma_loss is 0.27083390951156616
loss is 11.54005241394043, acc1 is 6.201171875, acc5 is 16.2109375, cma_loss is 11.271780967712402, uma_loss is 0.2682715356349945
loss is 11.409385681152344, acc1 is 5.76171875, acc5 is 16.40625, cma_loss is 11.137096405029297, uma_loss is 0.2722897231578827
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 114.61it/s]
35 epoch loss is 1.4356418882097517,                                    acc1 is 5.972055288461538, acc5 is 15.549879807692308
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 152.96it/s]
-----------------------------------
The average AUROC is 42.8377
The AUROC of I313 is 60.70
The AUROC of I314 is 24.97
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 58.8166
The Specificity of I313 is 22.43
The Specificity of I314 is 95.20
-----------------------------------
The average Youden Index is 17.1499
The Youden Index of I313 is 22.43
The Youden Index of I314 is 11.87
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                               | 36/51 [11:50<04:53, 19.58s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.8561
The AUROC of I27 is 46.04
The AUROC of I34 is 52.05
The AUROC of I35 is 48.57
The AUROC of I36 is 40.77
-----------------------------------
The average Sensitivity is 93.4311
The Sensitivity of I27 is 92.89
The Sensitivity of I34 is 87.61
The Sensitivity of I35 is 93.22
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 16.0774
The Specificity of I27 is 11.30
The Specificity of I34 is 23.31
The Specificity of I35 is 11.80
The Specificity of I36 is 17.89
-----------------------------------
The average Youden Index is 9.5085
The Youden Index of I27 is 4.19
The Youden Index of I34 is 10.92
The Youden Index of I35 is 5.02
The Youden Index of I36 is 17.89
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.364311218261719, acc1 is 7.861328125, acc5 is 17.041015625, cma_loss is 11.09674072265625, uma_loss is 0.26757025718688965
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.81s/it]
loss is 11.21572494506836, acc1 is 7.421875, acc5 is 17.529296875, cma_loss is 10.959362030029297, uma_loss is 0.2563630938529968
loss is 11.437921524047852, acc1 is 5.859375, acc5 is 15.72265625, cma_loss is 11.18388557434082, uma_loss is 0.2540363371372223
loss is 11.376392364501953, acc1 is 5.6640625, acc5 is 16.69921875, cma_loss is 11.123075485229492, uma_loss is 0.2533164918422699
loss is 11.162444114685059, acc1 is 7.275390625, acc5 is 18.1640625, cma_loss is 10.905400276184082, uma_loss is 0.2570436894893646
loss is 11.073891639709473, acc1 is 7.373046875, acc5 is 18.75, cma_loss is 10.819515228271484, uma_loss is 0.2543768584728241
loss is 11.385137557983398, acc1 is 6.93359375, acc5 is 16.845703125, cma_loss is 11.128445625305176, uma_loss is 0.25669217109680176
loss is 11.3010835647583, acc1 is 7.080078125, acc5 is 18.603515625, cma_loss is 11.054696083068848, uma_loss is 0.24638758599758148
loss is 11.313661575317383, acc1 is 6.689453125, acc5 is 17.1875, cma_loss is 11.056252479553223, uma_loss is 0.25740957260131836
loss is 11.47471809387207, acc1 is 6.396484375, acc5 is 16.015625, cma_loss is 11.222702980041504, uma_loss is 0.2520153522491455
loss is 11.324767112731934, acc1 is 6.8359375, acc5 is 16.89453125, cma_loss is 11.08342456817627, uma_loss is 0.24134214222431183
loss is 11.313447952270508, acc1 is 6.25, acc5 is 17.041015625, cma_loss is 11.067361831665039, uma_loss is 0.24608635902404785
loss is 11.19084358215332, acc1 is 7.03125, acc5 is 17.919921875, cma_loss is 10.968832015991211, uma_loss is 0.22201114892959595
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 116.80it/s]
36 epoch loss is 1.3993747166224888,                                    acc1 is 6.820913461538462, acc5 is 17.262620192307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 147.29it/s]
-----------------------------------
The average AUROC is 31.7972
The AUROC of I313 is 51.71
The AUROC of I314 is 11.88
-----------------------------------
The average Sensitivity is 66.6667
The Sensitivity of I313 is 33.33
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 46.1230
The Specificity of I313 is 87.05
The Specificity of I314 is 5.20
-----------------------------------
The average Youden Index is 12.7896
The Youden Index of I313 is 20.38
The Youden Index of I314 is 5.20
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.74it/s]
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                        | 37/51 [12:10<04:33, 19.55s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.2903
The AUROC of I27 is 41.53
The AUROC of I34 is 51.72
The AUROC of I35 is 42.02
The AUROC of I36 is 53.89
-----------------------------------
The average Sensitivity is 91.1894
The Sensitivity of I27 is 95.43
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 84.62
-----------------------------------
The average Specificity is 17.7726
The Specificity of I27 is 6.34
The Specificity of I34 is 23.74
The Specificity of I35 is 4.21
The Specificity of I36 is 36.80
-----------------------------------
The average Youden Index is 8.9620
The Youden Index of I27 is 1.77
The Youden Index of I34 is 9.59
The Youden Index of I35 is 3.08
The Youden Index of I36 is 21.41
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 11.060761451721191, acc1 is 7.6171875, acc5 is 19.3359375, cma_loss is 10.833457946777344, uma_loss is 0.22730319201946259
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.87s/it]
loss is 11.111884117126465, acc1 is 7.421875, acc5 is 19.3359375, cma_loss is 10.871675491333008, uma_loss is 0.2402089387178421
loss is 11.364541053771973, acc1 is 6.689453125, acc5 is 17.529296875, cma_loss is 11.133646011352539, uma_loss is 0.23089511692523956
loss is 11.2326021194458, acc1 is 5.908203125, acc5 is 16.89453125, cma_loss is 10.97503662109375, uma_loss is 0.25756531953811646
loss is 11.037879943847656, acc1 is 7.861328125, acc5 is 19.7265625, cma_loss is 10.778711318969727, uma_loss is 0.25916826725006104
loss is 10.962635040283203, acc1 is 7.177734375, acc5 is 20.01953125, cma_loss is 10.714178085327148, uma_loss is 0.24845682084560394
loss is 11.08484935760498, acc1 is 7.03125, acc5 is 18.06640625, cma_loss is 10.84108829498291, uma_loss is 0.2437611222267151
loss is 10.942728042602539, acc1 is 8.30078125, acc5 is 21.826171875, cma_loss is 10.66891860961914, uma_loss is 0.2738097012042999
loss is 10.96817398071289, acc1 is 7.71484375, acc5 is 19.189453125, cma_loss is 10.720398902893066, uma_loss is 0.24777495861053467
loss is 11.024515151977539, acc1 is 7.958984375, acc5 is 19.482421875, cma_loss is 10.771150588989258, uma_loss is 0.2533644437789917
loss is 11.006149291992188, acc1 is 7.763671875, acc5 is 18.994140625, cma_loss is 10.763296127319336, uma_loss is 0.24285350739955902
loss is 11.16586685180664, acc1 is 7.177734375, acc5 is 18.1640625, cma_loss is 10.896028518676758, uma_loss is 0.2698386311531067
loss is 10.928023338317871, acc1 is 7.861328125, acc5 is 20.60546875, cma_loss is 10.666662216186523, uma_loss is 0.26136094331741333
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 117.77it/s]
37 epoch loss is 1.3703867594401042,                                    acc1 is 7.421875, acc5 is 19.166917067307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 159.54it/s]
-----------------------------------
The average AUROC is 32.5477
The AUROC of I313 is 54.57
The AUROC of I314 is 10.53
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 22.4264
The Specificity of I313 is 41.32
The Specificity of I314 is 3.53
-----------------------------------
The average Youden Index is 11.3153
The Youden Index of I313 is 19.10
The Youden Index of I314 is 3.53
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.37it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                  | 38/51 [12:29<04:13, 19.54s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.5513
The AUROC of I27 is 43.14
The AUROC of I34 is 51.16
The AUROC of I35 is 44.60
The AUROC of I36 is 47.30
-----------------------------------
The average Sensitivity is 91.4916
The Sensitivity of I27 is 95.94
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 96.61
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 15.7231
The Specificity of I27 is 5.88
The Specificity of I34 is 25.32
The Specificity of I35 is 7.52
The Specificity of I36 is 24.17
-----------------------------------
The average Youden Index is 7.2147
The Youden Index of I27 is 1.82
The Youden Index of I34 is 10.28
The Youden Index of I35 is 4.13
The Youden Index of I36 is 12.63
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.876030921936035, acc1 is 7.91015625, acc5 is 19.62890625, cma_loss is 10.643062591552734, uma_loss is 0.23296824097633362
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.78s/it]
loss is 10.83801555633545, acc1 is 9.1796875, acc5 is 22.216796875, cma_loss is 10.579887390136719, uma_loss is 0.25812822580337524
loss is 10.873575210571289, acc1 is 8.447265625, acc5 is 20.3125, cma_loss is 10.633172988891602, uma_loss is 0.24040229618549347
loss is 10.83066177368164, acc1 is 8.984375, acc5 is 20.8984375, cma_loss is 10.585467338562012, uma_loss is 0.2451944202184677
loss is 10.945173263549805, acc1 is 7.568359375, acc5 is 20.068359375, cma_loss is 10.702329635620117, uma_loss is 0.24284343421459198
loss is 10.925622940063477, acc1 is 7.373046875, acc5 is 19.82421875, cma_loss is 10.684978485107422, uma_loss is 0.24064424633979797
loss is 11.014081954956055, acc1 is 7.568359375, acc5 is 19.04296875, cma_loss is 10.767911911010742, uma_loss is 0.24617017805576324
loss is 10.86870288848877, acc1 is 9.47265625, acc5 is 22.412109375, cma_loss is 10.617460250854492, uma_loss is 0.2512427568435669
loss is 10.892393112182617, acc1 is 8.10546875, acc5 is 20.01953125, cma_loss is 10.637433052062988, uma_loss is 0.25496000051498413
loss is 10.817920684814453, acc1 is 8.59375, acc5 is 21.142578125, cma_loss is 10.5660400390625, uma_loss is 0.2518805265426636
loss is 10.949230194091797, acc1 is 8.0078125, acc5 is 20.01953125, cma_loss is 10.700575828552246, uma_loss is 0.2486545294523239
loss is 10.891317367553711, acc1 is 8.30078125, acc5 is 21.875, cma_loss is 10.633184432983398, uma_loss is 0.2581328749656677
loss is 10.8058443069458, acc1 is 8.49609375, acc5 is 20.361328125, cma_loss is 10.560672760009766, uma_loss is 0.24517178535461426
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 104.14it/s]
38 epoch loss is 1.3478911445254371,                                    acc1 is 8.30829326923077, acc5 is 20.601712740384617
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 158.29it/s]
-----------------------------------
The average AUROC is 28.3307
The AUROC of I313 is 42.20
The AUROC of I314 is 14.46
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 7.5696
The Specificity of I313 is 8.01
The Specificity of I314 is 7.13
-----------------------------------
The average Youden Index is 7.5696
The Youden Index of I313 is 8.01
The Youden Index of I314 is 7.13
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.00it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                            | 39/51 [12:49<03:54, 19.55s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.7820
The AUROC of I27 is 41.47
The AUROC of I34 is 50.00
The AUROC of I35 is 45.72
The AUROC of I36 is 37.94
-----------------------------------
The average Sensitivity is 70.0931
The Sensitivity of I27 is 1.52
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 97.74
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 33.6070
The Specificity of I27 is 99.39
The Specificity of I34 is 24.61
The Specificity of I35 is 5.64
The Specificity of I36 is 4.79
-----------------------------------
The average Youden Index is 3.7001
The Youden Index of I27 is 0.91
The Youden Index of I34 is 9.56
The Youden Index of I35 is 3.38
The Youden Index of I36 is 0.95
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.625065803527832, acc1 is 9.765625, acc5 is 22.412109375, cma_loss is 10.375154495239258, uma_loss is 0.24991145730018616
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.72s/it]
loss is 10.615729331970215, acc1 is 10.400390625, acc5 is 23.53515625, cma_loss is 10.349996566772461, uma_loss is 0.26573291420936584
loss is 10.72183609008789, acc1 is 10.546875, acc5 is 23.095703125, cma_loss is 10.453258514404297, uma_loss is 0.2685771882534027
loss is 10.72335433959961, acc1 is 8.7890625, acc5 is 22.36328125, cma_loss is 10.475631713867188, uma_loss is 0.24772301316261292
loss is 10.61919116973877, acc1 is 9.130859375, acc5 is 22.705078125, cma_loss is 10.360946655273438, uma_loss is 0.25824469327926636
loss is 10.678130149841309, acc1 is 9.1796875, acc5 is 22.509765625, cma_loss is 10.431076049804688, uma_loss is 0.24705412983894348
loss is 10.707576751708984, acc1 is 9.375, acc5 is 22.021484375, cma_loss is 10.470613479614258, uma_loss is 0.23696300387382507
loss is 10.493988037109375, acc1 is 9.130859375, acc5 is 24.90234375, cma_loss is 10.241728782653809, uma_loss is 0.25225919485092163
loss is 10.775548934936523, acc1 is 10.107421875, acc5 is 22.8515625, cma_loss is 10.529813766479492, uma_loss is 0.24573488533496857
loss is 10.678838729858398, acc1 is 9.423828125, acc5 is 23.681640625, cma_loss is 10.413103103637695, uma_loss is 0.2657354176044464
loss is 10.698887825012207, acc1 is 8.88671875, acc5 is 20.99609375, cma_loss is 10.4376220703125, uma_loss is 0.2612656354904175
loss is 10.702543258666992, acc1 is 10.15625, acc5 is 23.828125, cma_loss is 10.430041313171387, uma_loss is 0.2725016474723816
loss is 10.502786636352539, acc1 is 9.716796875, acc5 is 24.4140625, cma_loss is 10.250099182128906, uma_loss is 0.2526869773864746
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 90.87it/s]
39 epoch loss is 1.3194616862705775,                                    acc1 is 9.585336538461538, acc5 is 23.024338942307693
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 159.83it/s]
-----------------------------------
The average AUROC is 38.3683
The AUROC of I313 is 40.22
The AUROC of I314 is 36.52
-----------------------------------
The average Sensitivity is 52.7778
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 62.1189
The Specificity of I313 is 26.97
The Specificity of I314 is 97.27
-----------------------------------
The average Youden Index is 14.8967
The Youden Index of I313 is 15.86
The Youden Index of I314 is 13.94
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.89it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                     | 40/51 [13:07<03:32, 19.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.4862
The AUROC of I27 is 41.27
The AUROC of I34 is 50.91
The AUROC of I35 is 49.98
The AUROC of I36 is 31.79
-----------------------------------
The average Sensitivity is 90.2372
The Sensitivity of I27 is 97.46
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 78.53
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 14.4051
The Specificity of I27 is 3.28
The Specificity of I34 is 24.68
The Specificity of I35 is 29.32
The Specificity of I36 is 0.34
-----------------------------------
The average Youden Index is 4.6423
The Youden Index of I27 is 0.74
The Youden Index of I34 is 9.63
The Youden Index of I35 is 7.85
The Youden Index of I36 is 0.34
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.643488883972168, acc1 is 8.7890625, acc5 is 22.412109375, cma_loss is 10.3880615234375, uma_loss is 0.2554274797439575
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.66s/it]
loss is 10.631782531738281, acc1 is 9.228515625, acc5 is 22.94921875, cma_loss is 10.385738372802734, uma_loss is 0.24604405462741852
loss is 10.649622917175293, acc1 is 9.912109375, acc5 is 22.4609375, cma_loss is 10.388153076171875, uma_loss is 0.26147007942199707
loss is 10.756166458129883, acc1 is 8.69140625, acc5 is 22.119140625, cma_loss is 10.482402801513672, uma_loss is 0.2737637162208557
loss is 10.85389232635498, acc1 is 8.59375, acc5 is 20.458984375, cma_loss is 10.585533142089844, uma_loss is 0.26835906505584717
loss is 10.751788139343262, acc1 is 9.08203125, acc5 is 21.6796875, cma_loss is 10.478395462036133, uma_loss is 0.27339255809783936
loss is 10.620710372924805, acc1 is 9.326171875, acc5 is 22.607421875, cma_loss is 10.373214721679688, uma_loss is 0.2474961131811142
loss is 10.669625282287598, acc1 is 8.544921875, acc5 is 22.265625, cma_loss is 10.416378021240234, uma_loss is 0.2532472014427185
loss is 10.678516387939453, acc1 is 9.27734375, acc5 is 21.923828125, cma_loss is 10.427627563476562, uma_loss is 0.2508888244628906
loss is 10.724952697753906, acc1 is 9.1796875, acc5 is 21.77734375, cma_loss is 10.477252006530762, uma_loss is 0.24770106375217438
loss is 10.799506187438965, acc1 is 8.837890625, acc5 is 21.38671875, cma_loss is 10.521892547607422, uma_loss is 0.2776135206222534
loss is 10.573151588439941, acc1 is 10.302734375, acc5 is 23.583984375, cma_loss is 10.302713394165039, uma_loss is 0.2704380750656128
loss is 10.52031135559082, acc1 is 9.912109375, acc5 is 23.388671875, cma_loss is 10.281078338623047, uma_loss is 0.23923324048519135
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 109.24it/s]
40 epoch loss is 1.3226049059913272,                                    acc1 is 9.205979567307692, acc5 is 22.23182091346154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 133.52it/s]
-----------------------------------
The average AUROC is 54.3977
The AUROC of I313 is 72.83
The AUROC of I314 is 35.96
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 73.6345
The Specificity of I313 is 50.27
The Specificity of I314 is 97.00
-----------------------------------
The average Youden Index is 31.9678
The Youden Index of I313 is 50.27
The Youden Index of I314 is 13.67
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.65it/s]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 41/51 [13:26<03:12, 19.23s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.6948
The AUROC of I27 is 45.23
The AUROC of I34 is 52.09
The AUROC of I35 is 50.74
The AUROC of I36 is 34.72
-----------------------------------
The average Sensitivity is 53.4644
The Sensitivity of I27 is 3.55
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 27.12
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 51.4429
The Specificity of I27 is 98.63
The Specificity of I34 is 27.98
The Specificity of I35 is 77.14
The Specificity of I36 is 2.03
-----------------------------------
The average Youden Index is 4.9073
The Youden Index of I27 is 2.18
The Youden Index of I34 is 11.16
The Youden Index of I35 is 4.26
The Youden Index of I36 is 2.03
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.55264663696289, acc1 is 9.47265625, acc5 is 23.2421875, cma_loss is 10.279800415039062, uma_loss is 0.27284613251686096
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.74s/it]
loss is 10.3876953125, acc1 is 11.03515625, acc5 is 25.09765625, cma_loss is 10.126997947692871, uma_loss is 0.260697603225708
loss is 10.542860984802246, acc1 is 8.935546875, acc5 is 23.681640625, cma_loss is 10.282047271728516, uma_loss is 0.2608138918876648
loss is 10.439021110534668, acc1 is 9.912109375, acc5 is 24.90234375, cma_loss is 10.171623229980469, uma_loss is 0.26739808917045593
loss is 10.293854713439941, acc1 is 11.03515625, acc5 is 25.48828125, cma_loss is 10.040327072143555, uma_loss is 0.25352805852890015
loss is 10.184706687927246, acc1 is 12.060546875, acc5 is 27.392578125, cma_loss is 9.90243911743164, uma_loss is 0.2822677791118622
loss is 10.398885726928711, acc1 is 11.572265625, acc5 is 24.70703125, cma_loss is 10.124673843383789, uma_loss is 0.2742118835449219
loss is 10.119441032409668, acc1 is 11.23046875, acc5 is 27.587890625, cma_loss is 9.861639022827148, uma_loss is 0.25780215859413147
loss is 10.256641387939453, acc1 is 11.376953125, acc5 is 26.66015625, cma_loss is 10.00460433959961, uma_loss is 0.2520367503166199
loss is 10.530996322631836, acc1 is 8.88671875, acc5 is 23.583984375, cma_loss is 10.273921966552734, uma_loss is 0.25707438588142395
loss is 10.413337707519531, acc1 is 10.546875, acc5 is 24.072265625, cma_loss is 10.179292678833008, uma_loss is 0.2340448498725891
loss is 10.250170707702637, acc1 is 10.44921875, acc5 is 25.732421875, cma_loss is 10.000614166259766, uma_loss is 0.24955636262893677
loss is 10.043405532836914, acc1 is 12.158203125, acc5 is 28.125, cma_loss is 9.799257278442383, uma_loss is 0.24414795637130737
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 115.82it/s]
41 epoch loss is 1.280130132039388,                                    acc1 is 10.667067307692308, acc5 is 25.40564903846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 152.80it/s]
-----------------------------------
The average AUROC is 36.2036
The AUROC of I313 is 51.77
The AUROC of I314 is 20.64
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 60.1177
The Specificity of I313 is 24.43
The Specificity of I314 is 95.80
-----------------------------------
The average Youden Index is 18.4510
The Youden Index of I313 is 24.43
The Youden Index of I314 is 12.47
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.12it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 42/51 [13:45<02:52, 19.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.2875
The AUROC of I27 is 48.92
The AUROC of I34 is 50.73
The AUROC of I35 is 48.52
The AUROC of I36 is 40.99
-----------------------------------
The average Sensitivity is 74.1254
The Sensitivity of I27 is 18.78
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 96.61
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 34.8102
The Specificity of I27 is 86.18
The Specificity of I34 is 24.89
The Specificity of I35 is 7.37
The Specificity of I36 is 20.80
-----------------------------------
The average Youden Index is 8.9356
The Youden Index of I27 is 4.96
The Youden Index of I34 is 9.85
The Youden Index of I35 is 3.98
The Youden Index of I36 is 16.95
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 10.120291709899902, acc1 is 11.5234375, acc5 is 26.46484375, cma_loss is 9.854272842407227, uma_loss is 0.266018807888031
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.83s/it]
loss is 10.184986114501953, acc1 is 11.279296875, acc5 is 26.66015625, cma_loss is 9.948028564453125, uma_loss is 0.23695772886276245
loss is 10.073589324951172, acc1 is 12.20703125, acc5 is 28.759765625, cma_loss is 9.807535171508789, uma_loss is 0.26605403423309326
loss is 10.089935302734375, acc1 is 10.7421875, acc5 is 27.44140625, cma_loss is 9.84424877166748, uma_loss is 0.24568690359592438
loss is 10.169634819030762, acc1 is 10.986328125, acc5 is 26.5625, cma_loss is 9.919058799743652, uma_loss is 0.2505756616592407
loss is 10.039806365966797, acc1 is 13.18359375, acc5 is 27.099609375, cma_loss is 9.793366432189941, uma_loss is 0.24644024670124054
loss is 9.969588279724121, acc1 is 12.40234375, acc5 is 28.466796875, cma_loss is 9.722757339477539, uma_loss is 0.2468312680721283
loss is 9.893433570861816, acc1 is 13.18359375, acc5 is 29.98046875, cma_loss is 9.647698402404785, uma_loss is 0.24573513865470886
loss is 9.997652053833008, acc1 is 11.767578125, acc5 is 28.173828125, cma_loss is 9.749971389770508, uma_loss is 0.24768061935901642
loss is 10.210379600524902, acc1 is 12.109375, acc5 is 27.05078125, cma_loss is 9.965959548950195, uma_loss is 0.2444196194410324
loss is 10.176553726196289, acc1 is 11.572265625, acc5 is 26.611328125, cma_loss is 9.939017295837402, uma_loss is 0.2375359982252121
loss is 10.033895492553711, acc1 is 11.962890625, acc5 is 27.34375, cma_loss is 9.792997360229492, uma_loss is 0.2408979833126068
loss is 10.044371604919434, acc1 is 10.83984375, acc5 is 27.490234375, cma_loss is 9.793859481811523, uma_loss is 0.2505124509334564
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 130.96it/s]
42 epoch loss is 1.2476582663399833,                                    acc1 is 11.827674278846153, acc5 is 27.54657451923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 153.70it/s]
-----------------------------------
The average AUROC is 51.3618
The AUROC of I313 is 77.50
The AUROC of I314 is 25.23
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 76.4388
The Specificity of I313 is 56.48
The Specificity of I314 is 96.40
-----------------------------------
The average Youden Index is 34.7722
The Youden Index of I313 is 56.48
The Youden Index of I314 is 13.07
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.96it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 43/51 [14:05<02:33, 19.16s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.8555
The AUROC of I27 is 53.27
The AUROC of I34 is 51.43
The AUROC of I35 is 46.96
The AUROC of I36 is 39.76
-----------------------------------
The average Sensitivity is 87.5054
The Sensitivity of I27 is 78.68
The Sensitivity of I34 is 76.99
The Sensitivity of I35 is 94.35
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 22.6851
The Specificity of I27 is 30.76
The Specificity of I34 is 33.57
The Specificity of I35 is 11.95
The Specificity of I36 is 14.45
-----------------------------------
The average Youden Index is 10.1905
The Youden Index of I27 is 9.44
The Youden Index of I34 is 10.56
The Youden Index of I35 is 6.31
The Youden Index of I36 is 14.45
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.993597030639648, acc1 is 12.5, acc5 is 28.515625, cma_loss is 9.756525039672852, uma_loss is 0.23707208037376404
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.70s/it]
loss is 10.042618751525879, acc1 is 10.986328125, acc5 is 27.34375, cma_loss is 9.792242050170898, uma_loss is 0.25037628412246704
loss is 9.919258117675781, acc1 is 11.962890625, acc5 is 28.22265625, cma_loss is 9.67923355102539, uma_loss is 0.24002481997013092
loss is 10.128768920898438, acc1 is 9.86328125, acc5 is 26.220703125, cma_loss is 9.86950397491455, uma_loss is 0.2592649459838867
loss is 10.038894653320312, acc1 is 10.888671875, acc5 is 28.61328125, cma_loss is 9.810864448547363, uma_loss is 0.22803041338920593
loss is 9.892416954040527, acc1 is 11.767578125, acc5 is 29.58984375, cma_loss is 9.668380737304688, uma_loss is 0.22403575479984283
loss is 9.961920738220215, acc1 is 11.669921875, acc5 is 28.22265625, cma_loss is 9.711679458618164, uma_loss is 0.2502415180206299
loss is 9.816887855529785, acc1 is 13.4765625, acc5 is 29.8828125, cma_loss is 9.566368103027344, uma_loss is 0.2505199909210205
loss is 9.813279151916504, acc1 is 12.59765625, acc5 is 28.3203125, cma_loss is 9.56332015991211, uma_loss is 0.24995934963226318
loss is 9.909390449523926, acc1 is 12.841796875, acc5 is 29.345703125, cma_loss is 9.63847541809082, uma_loss is 0.2709154486656189
loss is 10.038437843322754, acc1 is 11.962890625, acc5 is 27.44140625, cma_loss is 9.799286842346191, uma_loss is 0.2391512095928192
loss is 9.934197425842285, acc1 is 12.20703125, acc5 is 28.22265625, cma_loss is 9.673404693603516, uma_loss is 0.26079317927360535
loss is 9.662002563476562, acc1 is 14.697265625, acc5 is 32.51953125, cma_loss is 9.410579681396484, uma_loss is 0.2514230012893677
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 100.24it/s]
43 epoch loss is 1.23001590910412,                                    acc1 is 12.109375, acc5 is 28.650841346153847
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 150.50it/s]
-----------------------------------
The average AUROC is 32.3364
The AUROC of I313 is 54.24
The AUROC of I314 is 10.44
-----------------------------------
The average Sensitivity is 72.2222
The Sensitivity of I313 is 44.44
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 37.2819
The Specificity of I313 is 73.43
The Specificity of I314 is 1.13
-----------------------------------
The average Youden Index is 9.5041
The Youden Index of I313 is 17.88
The Youden Index of I314 is 1.13
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.35it/s]
 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                            | 44/51 [14:24<02:15, 19.32s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.8334
The AUROC of I27 is 45.65
The AUROC of I34 is 50.74
The AUROC of I35 is 49.79
The AUROC of I36 is 45.14
-----------------------------------
The average Sensitivity is 89.4090
The Sensitivity of I27 is 96.95
The Sensitivity of I34 is 88.50
The Sensitivity of I35 is 87.57
The Sensitivity of I36 is 84.62
-----------------------------------
The average Specificity is 16.8368
The Specificity of I27 is 6.26
The Specificity of I34 is 20.80
The Specificity of I35 is 18.95
The Specificity of I36 is 21.34
-----------------------------------
The average Youden Index is 6.2458
The Youden Index of I27 is 3.21
The Youden Index of I34 is 9.30
The Youden Index of I35 is 6.52
The Youden Index of I36 is 5.95
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.437067031860352, acc1 is 15.087890625, acc5 is 32.51953125, cma_loss is 9.201519012451172, uma_loss is 0.23554810881614685
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.81s/it]
loss is 9.347756385803223, acc1 is 14.111328125, acc5 is 34.130859375, cma_loss is 9.109583854675293, uma_loss is 0.23817218840122223
loss is 9.641816139221191, acc1 is 14.111328125, acc5 is 32.6171875, cma_loss is 9.3794584274292, uma_loss is 0.26235777139663696
loss is 9.490044593811035, acc1 is 13.4765625, acc5 is 33.349609375, cma_loss is 9.254056930541992, uma_loss is 0.23598763346672058
loss is 9.443521499633789, acc1 is 13.818359375, acc5 is 31.787109375, cma_loss is 9.206033706665039, uma_loss is 0.23748788237571716
loss is 9.722338676452637, acc1 is 12.939453125, acc5 is 29.345703125, cma_loss is 9.491292953491211, uma_loss is 0.23104536533355713
loss is 9.70024299621582, acc1 is 13.134765625, acc5 is 30.810546875, cma_loss is 9.450817108154297, uma_loss is 0.24942578375339508
loss is 9.563990592956543, acc1 is 15.0390625, acc5 is 32.71484375, cma_loss is 9.325593948364258, uma_loss is 0.23839661478996277
loss is 9.499412536621094, acc1 is 15.380859375, acc5 is 32.51953125, cma_loss is 9.241586685180664, uma_loss is 0.2578255534172058
loss is 9.639305114746094, acc1 is 15.185546875, acc5 is 31.4453125, cma_loss is 9.391828536987305, uma_loss is 0.2474765181541443
loss is 9.68560791015625, acc1 is 13.818359375, acc5 is 29.78515625, cma_loss is 9.434432983398438, uma_loss is 0.2511746883392334
loss is 9.77028751373291, acc1 is 12.6953125, acc5 is 29.345703125, cma_loss is 9.510866165161133, uma_loss is 0.25942155718803406
loss is 9.727829933166504, acc1 is 13.330078125, acc5 is 32.12890625, cma_loss is 9.471238136291504, uma_loss is 0.25659215450286865
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 110.68it/s]
44 epoch loss is 1.1873259135654994,                                    acc1 is 14.009915865384615, acc5 is 31.73076923076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 156.99it/s]
-----------------------------------
The average AUROC is 40.3183
The AUROC of I313 is 74.84
The AUROC of I314 is 5.80
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 23.9310
The Specificity of I313 is 47.00
The Specificity of I314 is 0.87
-----------------------------------
The average Youden Index is 23.9310
The Youden Index of I313 is 47.00
The Youden Index of I314 is 0.87
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.91it/s]
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 45/51 [14:43<01:55, 19.20s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.0462
The AUROC of I27 is 58.65
The AUROC of I34 is 53.57
The AUROC of I35 is 53.87
The AUROC of I36 is 62.09
-----------------------------------
The average Sensitivity is 71.2583
The Sensitivity of I27 is 56.35
The Sensitivity of I34 is 73.45
The Sensitivity of I35 is 70.62
The Sensitivity of I36 is 84.62
-----------------------------------
The average Specificity is 44.9074
The Specificity of I27 is 60.99
The Specificity of I34 is 37.52
The Specificity of I35 is 39.32
The Specificity of I36 is 41.80
-----------------------------------
The average Youden Index is 16.1658
The Youden Index of I27 is 17.34
The Youden Index of I34 is 10.97
The Youden Index of I35 is 9.94
The Youden Index of I36 is 26.41
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.536959648132324, acc1 is 13.671875, acc5 is 31.4453125, cma_loss is 9.277181625366211, uma_loss is 0.2597782015800476
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.76s/it]
loss is 9.308513641357422, acc1 is 14.501953125, acc5 is 34.033203125, cma_loss is 9.05428695678711, uma_loss is 0.2542268931865692
loss is 9.257766723632812, acc1 is 15.087890625, acc5 is 34.228515625, cma_loss is 9.029375076293945, uma_loss is 0.2283918261528015
loss is 9.077958106994629, acc1 is 16.015625, acc5 is 35.546875, cma_loss is 8.831716537475586, uma_loss is 0.24624201655387878
loss is 9.183148384094238, acc1 is 15.13671875, acc5 is 33.984375, cma_loss is 8.94752025604248, uma_loss is 0.23562775552272797
loss is 9.318422317504883, acc1 is 15.087890625, acc5 is 34.033203125, cma_loss is 9.059921264648438, uma_loss is 0.25850069522857666
loss is 9.594820022583008, acc1 is 13.232421875, acc5 is 30.517578125, cma_loss is 9.356367111206055, uma_loss is 0.23845329880714417
loss is 9.113006591796875, acc1 is 15.771484375, acc5 is 35.25390625, cma_loss is 8.871006965637207, uma_loss is 0.24199999868869781
loss is 9.084269523620605, acc1 is 15.966796875, acc5 is 37.3046875, cma_loss is 8.836116790771484, uma_loss is 0.2481527179479599
loss is 9.165494918823242, acc1 is 16.6015625, acc5 is 36.5234375, cma_loss is 8.913044929504395, uma_loss is 0.2524504065513611
loss is 9.255082130432129, acc1 is 15.33203125, acc5 is 33.69140625, cma_loss is 9.00943374633789, uma_loss is 0.24564850330352783
loss is 9.339143753051758, acc1 is 14.6484375, acc5 is 33.0078125, cma_loss is 9.087738037109375, uma_loss is 0.25140583515167236
loss is 9.293400764465332, acc1 is 15.185546875, acc5 is 34.5703125, cma_loss is 9.05256175994873, uma_loss is 0.2408389300107956
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 106.92it/s]
45 epoch loss is 1.1478855859665644,                                    acc1 is 15.09540264423077, acc5 is 34.16466346153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 150.55it/s]
-----------------------------------
The average AUROC is 45.6476
The AUROC of I313 is 79.87
The AUROC of I314 is 11.43
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 39.6501
The Specificity of I313 is 76.57
The Specificity of I314 is 2.73
-----------------------------------
The average Youden Index is 34.0946
The Youden Index of I313 is 65.46
The Youden Index of I314 is 2.73
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 46/51 [15:02<01:35, 19.08s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 52.9725
The AUROC of I27 is 59.53
The AUROC of I34 is 50.89
The AUROC of I35 is 54.47
The AUROC of I36 is 46.99
-----------------------------------
The average Sensitivity is 76.2222
The Sensitivity of I27 is 50.76
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 70.06
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 39.7182
The Specificity of I27 is 67.79
The Specificity of I34 is 28.19
The Specificity of I35 is 42.03
The Specificity of I36 is 20.86
-----------------------------------
The average Youden Index is 15.9404
The Youden Index of I27 is 18.55
The Youden Index of I34 is 12.26
The Youden Index of I35 is 12.09
The Youden Index of I36 is 20.86
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 9.279627799987793, acc1 is 14.794921875, acc5 is 32.71484375, cma_loss is 9.046140670776367, uma_loss is 0.23348692059516907
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.77s/it]
loss is 9.593713760375977, acc1 is 13.623046875, acc5 is 31.8359375, cma_loss is 9.345769882202148, uma_loss is 0.24794377386569977
loss is 9.375304222106934, acc1 is 13.623046875, acc5 is 32.958984375, cma_loss is 9.137360572814941, uma_loss is 0.23794344067573547
loss is 9.085084915161133, acc1 is 14.55078125, acc5 is 36.328125, cma_loss is 8.856499671936035, uma_loss is 0.2285856157541275
loss is 9.079774856567383, acc1 is 16.162109375, acc5 is 36.474609375, cma_loss is 8.82749080657959, uma_loss is 0.2522839903831482
loss is 9.14449405670166, acc1 is 15.283203125, acc5 is 34.08203125, cma_loss is 8.882925033569336, uma_loss is 0.26156914234161377
loss is 9.126293182373047, acc1 is 15.869140625, acc5 is 36.083984375, cma_loss is 8.87293815612793, uma_loss is 0.2533554434776306
loss is 9.083541870117188, acc1 is 17.28515625, acc5 is 37.646484375, cma_loss is 8.815476417541504, uma_loss is 0.26806533336639404
loss is 8.915640830993652, acc1 is 17.1875, acc5 is 37.890625, cma_loss is 8.657530784606934, uma_loss is 0.25811031460762024
loss is 8.918128967285156, acc1 is 17.28515625, acc5 is 37.890625, cma_loss is 8.681894302368164, uma_loss is 0.23623493313789368
loss is 8.935531616210938, acc1 is 17.67578125, acc5 is 36.03515625, cma_loss is 8.694791793823242, uma_loss is 0.2407400906085968
loss is 8.961185455322266, acc1 is 16.50390625, acc5 is 35.888671875, cma_loss is 8.699828147888184, uma_loss is 0.26135727763175964
loss is 8.815057754516602, acc1 is 17.626953125, acc5 is 39.990234375, cma_loss is 8.577764511108398, uma_loss is 0.23729296028614044
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 125.85it/s]
46 epoch loss is 1.1267940884544736,                                    acc1 is 15.95928485576923, acc5 is 35.83233173076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 153.22it/s]
-----------------------------------
The average AUROC is 26.5341
The AUROC of I313 is 38.84
The AUROC of I314 is 14.22
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 4.8380
The Specificity of I313 is 7.88
The Specificity of I314 is 1.80
-----------------------------------
The average Youden Index is 4.8380
The Youden Index of I313 is 7.88
The Youden Index of I314 is 1.80
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.64it/s]
 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 47/51 [15:22<01:17, 19.35s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.3484
The AUROC of I27 is 42.59
The AUROC of I34 is 51.51
The AUROC of I35 is 42.12
The AUROC of I36 is 57.18
-----------------------------------
The average Sensitivity is 71.4995
The Sensitivity of I27 is 4.57
The Sensitivity of I34 is 85.84
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 37.5878
The Specificity of I27 is 97.48
The Specificity of I34 is 23.24
The Specificity of I35 is 3.83
The Specificity of I36 is 25.79
-----------------------------------
The average Youden Index is 9.0874
The Youden Index of I27 is 2.05
The Youden Index of I34 is 9.08
The Youden Index of I35 is 3.27
The Youden Index of I36 is 21.95
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 8.985285758972168, acc1 is 15.72265625, acc5 is 36.42578125, cma_loss is 8.754735946655273, uma_loss is 0.2305496782064438
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.81s/it]
loss is 9.276825904846191, acc1 is 13.232421875, acc5 is 32.763671875, cma_loss is 9.030006408691406, uma_loss is 0.24681925773620605
loss is 8.985003471374512, acc1 is 16.845703125, acc5 is 37.01171875, cma_loss is 8.759284973144531, uma_loss is 0.225718691945076
loss is 8.618940353393555, acc1 is 17.96875, acc5 is 39.6484375, cma_loss is 8.377605438232422, uma_loss is 0.24133528769016266
loss is 8.573556900024414, acc1 is 18.359375, acc5 is 40.380859375, cma_loss is 8.350618362426758, uma_loss is 0.22293901443481445
loss is 8.606560707092285, acc1 is 18.26171875, acc5 is 40.13671875, cma_loss is 8.370521545410156, uma_loss is 0.23603934049606323
loss is 8.675374984741211, acc1 is 18.45703125, acc5 is 38.57421875, cma_loss is 8.440767288208008, uma_loss is 0.23460769653320312
loss is 8.476667404174805, acc1 is 18.603515625, acc5 is 41.015625, cma_loss is 8.226150512695312, uma_loss is 0.25051701068878174
loss is 8.460976600646973, acc1 is 19.23828125, acc5 is 41.259765625, cma_loss is 8.22658920288086, uma_loss is 0.23438751697540283
loss is 8.673772811889648, acc1 is 19.43359375, acc5 is 39.35546875, cma_loss is 8.438090324401855, uma_loss is 0.23568202555179596
loss is 8.768600463867188, acc1 is 17.822265625, acc5 is 38.671875, cma_loss is 8.537527084350586, uma_loss is 0.23107320070266724
loss is 8.583050727844238, acc1 is 18.212890625, acc5 is 40.283203125, cma_loss is 8.372415542602539, uma_loss is 0.21063515543937683
loss is 8.433526039123535, acc1 is 18.84765625, acc5 is 42.48046875, cma_loss is 8.187592506408691, uma_loss is 0.24593348801136017
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 106.14it/s]
47 epoch loss is 1.0773156393141974,                                    acc1 is 17.769681490384617, acc5 is 39.07752403846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 158.17it/s]
-----------------------------------
The average AUROC is 34.1248
The AUROC of I313 is 47.60
The AUROC of I314 is 20.65
-----------------------------------
The average Sensitivity is 58.3333
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 53.3421
The Specificity of I313 is 11.01
The Specificity of I314 is 95.67
-----------------------------------
The average Youden Index is 11.6755
The Youden Index of I313 is 11.01
The Youden Index of I314 is 12.34
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.57it/s]
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 48/51 [15:42<00:58, 19.38s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.7553
The AUROC of I27 is 53.95
The AUROC of I34 is 51.51
The AUROC of I35 is 52.16
The AUROC of I36 is 45.41
-----------------------------------
The average Sensitivity is 81.0552
The Sensitivity of I27 is 75.63
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 68.36
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 30.6142
The Specificity of I27 is 35.34
The Specificity of I34 is 25.97
The Specificity of I35 is 41.43
The Specificity of I36 is 19.72
-----------------------------------
The average Youden Index is 11.6694
The Youden Index of I27 is 10.98
The Youden Index of I34 is 10.04
The Youden Index of I35 is 9.79
The Youden Index of I36 is 15.87
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 8.458094596862793, acc1 is 19.091796875, acc5 is 41.162109375, cma_loss is 8.233560562133789, uma_loss is 0.2245338261127472
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.84s/it]
loss is 8.450450897216797, acc1 is 19.580078125, acc5 is 42.138671875, cma_loss is 8.215875625610352, uma_loss is 0.2345750331878662
loss is 8.280588150024414, acc1 is 20.1171875, acc5 is 42.529296875, cma_loss is 8.054984092712402, uma_loss is 0.22560416162014008
loss is 8.162742614746094, acc1 is 21.533203125, acc5 is 45.5078125, cma_loss is 7.936488628387451, uma_loss is 0.2262539565563202
loss is 7.959410667419434, acc1 is 22.412109375, acc5 is 47.0703125, cma_loss is 7.738542556762695, uma_loss is 0.22086799144744873
loss is 7.92657470703125, acc1 is 21.044921875, acc5 is 45.60546875, cma_loss is 7.694476127624512, uma_loss is 0.23209866881370544
loss is 8.089223861694336, acc1 is 22.998046875, acc5 is 44.43359375, cma_loss is 7.863901138305664, uma_loss is 0.22532284259796143
loss is 8.089613914489746, acc1 is 21.630859375, acc5 is 44.3359375, cma_loss is 7.869186878204346, uma_loss is 0.22042696177959442
loss is 7.782665729522705, acc1 is 23.046875, acc5 is 48.583984375, cma_loss is 7.551551818847656, uma_loss is 0.23111405968666077
loss is 7.960371017456055, acc1 is 22.94921875, acc5 is 45.458984375, cma_loss is 7.735959053039551, uma_loss is 0.22441218793392181
loss is 8.290413856506348, acc1 is 20.60546875, acc5 is 41.748046875, cma_loss is 8.054815292358398, uma_loss is 0.23559880256652832
loss is 8.223223686218262, acc1 is 21.435546875, acc5 is 43.84765625, cma_loss is 7.994016647338867, uma_loss is 0.22920744121074677
loss is 8.148852348327637, acc1 is 20.654296875, acc5 is 46.19140625, cma_loss is 7.905554294586182, uma_loss is 0.24329836666584015
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 92.43it/s]
48 epoch loss is 1.0078307242620559,                                    acc1 is 21.315354567307693, acc5 is 44.50871394230769
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 160.66it/s]
-----------------------------------
The average AUROC is 43.6334
The AUROC of I313 is 66.19
The AUROC of I314 is 21.07
-----------------------------------
The average Sensitivity is 47.2222
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 16.67
-----------------------------------
The average Specificity is 80.4834
The Specificity of I313 is 70.36
The Specificity of I314 is 90.61
-----------------------------------
The average Youden Index is 27.7056
The Youden Index of I313 is 48.14
The Youden Index of I314 is 7.27
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.69it/s]
 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 49/51 [16:01<00:38, 19.46s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 50.7810
The AUROC of I27 is 39.63
The AUROC of I34 is 52.71
The AUROC of I35 is 47.39
The AUROC of I36 is 63.39
-----------------------------------
The average Sensitivity is 89.9858
The Sensitivity of I27 is 99.49
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 80.23
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 21.5117
The Specificity of I27 is 1.45
The Specificity of I34 is 26.90
The Specificity of I35 is 24.81
The Specificity of I36 is 32.88
-----------------------------------
The average Youden Index is 11.4974
The Youden Index of I27 is 0.94
The Youden Index of I34 is 10.97
The Youden Index of I35 is 5.04
The Youden Index of I36 is 29.04
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 7.909890174865723, acc1 is 21.58203125, acc5 is 46.240234375, cma_loss is 7.689130783081055, uma_loss is 0.22075918316841125
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.73s/it]
loss is 8.069648742675781, acc1 is 22.265625, acc5 is 45.556640625, cma_loss is 7.804938316345215, uma_loss is 0.26471060514450073
loss is 7.883070468902588, acc1 is 21.6796875, acc5 is 46.09375, cma_loss is 7.661652088165283, uma_loss is 0.22141851484775543
loss is 7.973814964294434, acc1 is 22.0703125, acc5 is 46.484375, cma_loss is 7.739728927612305, uma_loss is 0.23408615589141846
loss is 7.841680526733398, acc1 is 22.900390625, acc5 is 48.33984375, cma_loss is 7.632439613342285, uma_loss is 0.20924077928066254
loss is 7.983953475952148, acc1 is 21.09375, acc5 is 45.8984375, cma_loss is 7.764005661010742, uma_loss is 0.21994805335998535
loss is 7.9824090003967285, acc1 is 21.09375, acc5 is 44.3359375, cma_loss is 7.762475967407227, uma_loss is 0.21993322670459747
loss is 8.00517463684082, acc1 is 20.99609375, acc5 is 45.556640625, cma_loss is 7.775420188903809, uma_loss is 0.2297542840242386
loss is 7.557059288024902, acc1 is 24.51171875, acc5 is 50.341796875, cma_loss is 7.3293914794921875, uma_loss is 0.2276679426431656
loss is 7.9223313331604, acc1 is 22.900390625, acc5 is 46.484375, cma_loss is 7.711078643798828, uma_loss is 0.21125268936157227
loss is 7.880370616912842, acc1 is 22.412109375, acc5 is 47.0703125, cma_loss is 7.650750637054443, uma_loss is 0.22961989045143127
loss is 7.853114604949951, acc1 is 21.875, acc5 is 48.046875, cma_loss is 7.627817630767822, uma_loss is 0.22529718279838562
loss is 7.95013952255249, acc1 is 21.533203125, acc5 is 45.703125, cma_loss is 7.731723308563232, uma_loss is 0.21841640770435333
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 99.63it/s]
49 epoch loss is 0.9791681652977353,                                    acc1 is 22.0703125, acc5 is 46.62710336538461
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 154.44it/s]
-----------------------------------
The average AUROC is 30.3069
The AUROC of I313 is 47.48
The AUROC of I314 is 13.14
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 48.9310
The Specificity of I313 is 96.93
The Specificity of I314 is 0.93
-----------------------------------
The average Youden Index is 10.0421
The Youden Index of I313 is 19.15
The Youden Index of I314 is 0.93
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.95it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 50/51 [16:20<00:19, 19.41s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 60.2362
The AUROC of I27 is 57.40
The AUROC of I34 is 52.70
The AUROC of I35 is 59.34
The AUROC of I36 is 71.51
-----------------------------------
The average Sensitivity is 75.5138
The Sensitivity of I27 is 55.84
The Sensitivity of I34 is 84.07
The Sensitivity of I35 is 62.15
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 44.8632
The Specificity of I27 is 59.39
The Specificity of I34 is 26.11
The Specificity of I35 is 54.59
The Specificity of I36 is 39.37
-----------------------------------
The average Youden Index is 20.3771
The Youden Index of I27 is 15.23
The Youden Index of I34 is 10.18
The Youden Index of I35 is 16.73
The Youden Index of I36 is 39.37
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 7.903538227081299, acc1 is 24.4140625, acc5 is 46.826171875, cma_loss is 7.677733898162842, uma_loss is 0.22580412030220032
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.82s/it]
loss is 7.964191436767578, acc1 is 22.705078125, acc5 is 46.630859375, cma_loss is 7.728659629821777, uma_loss is 0.23553162813186646
loss is 8.173335075378418, acc1 is 19.62890625, acc5 is 45.703125, cma_loss is 7.941780090332031, uma_loss is 0.23155531287193298
loss is 7.620938777923584, acc1 is 23.974609375, acc5 is 51.5625, cma_loss is 7.395001411437988, uma_loss is 0.22593729197978973
loss is 7.7549543380737305, acc1 is 22.412109375, acc5 is 47.900390625, cma_loss is 7.5245819091796875, uma_loss is 0.2303723245859146
loss is 7.587082386016846, acc1 is 23.583984375, acc5 is 50.48828125, cma_loss is 7.369579315185547, uma_loss is 0.21750319004058838
loss is 7.741392135620117, acc1 is 22.119140625, acc5 is 48.4375, cma_loss is 7.50801944732666, uma_loss is 0.23337268829345703
loss is 7.568051338195801, acc1 is 24.90234375, acc5 is 49.169921875, cma_loss is 7.364815711975098, uma_loss is 0.20323577523231506
loss is 7.483788967132568, acc1 is 25.87890625, acc5 is 51.220703125, cma_loss is 7.247930526733398, uma_loss is 0.2358582466840744
loss is 7.658957004547119, acc1 is 23.095703125, acc5 is 48.486328125, cma_loss is 7.439674377441406, uma_loss is 0.2192825824022293
loss is 7.704166412353516, acc1 is 23.779296875, acc5 is 48.14453125, cma_loss is 7.475846290588379, uma_loss is 0.22832036018371582
loss is 7.586984157562256, acc1 is 25.0, acc5 is 48.681640625, cma_loss is 7.3566741943359375, uma_loss is 0.23031005263328552
loss is 7.758048057556152, acc1 is 24.4140625, acc5 is 48.779296875, cma_loss is 7.539338111877441, uma_loss is 0.21871016919612885
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 129.59it/s]
50 epoch loss is 0.9571945553734189,                                    acc1 is 23.531400240384617, acc5 is 48.61778846153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 121.35it/s]
-----------------------------------
The average AUROC is 30.1086
The AUROC of I313 is 34.25
The AUROC of I314 is 25.97
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 7.0749
The Specificity of I313 is 12.95
The Specificity of I314 is 1.20
-----------------------------------
The average Youden Index is 7.0749
The Youden Index of I313 is 12.95
The Youden Index of I314 is 1.20
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [16:41<00:00, 19.64s/it]
-----------------------------------
The average AUROC is 53.2380
The AUROC of I27 is 45.06
The AUROC of I34 is 54.76
The AUROC of I35 is 57.05
The AUROC of I36 is 56.08
-----------------------------------
The average Sensitivity is 54.5500
The Sensitivity of I27 is 4.57
The Sensitivity of I34 is 69.91
The Sensitivity of I35 is 51.41
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 61.0013
The Specificity of I27 is 96.87
The Specificity of I34 is 43.26
The Specificity of I35 is 65.19
The Specificity of I36 is 38.69
-----------------------------------
The average Youden Index is 15.5513
The Youden Index of I27 is 1.44
The Youden Index of I34 is 13.17
The Youden Index of I35 is 16.60
The Youden Index of I36 is 31.00
***********************************
