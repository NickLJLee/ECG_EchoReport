directory "../checkpoints/" existing for save checkpoint!
#########################################
Be patient..., checking checkpoint now...
Start training from 0 epoch
#########################################
training start!
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:91: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
  0%|                                                                                                                                                                                                                                                                                                                                            | 0/51 [00:00<?, ?it/s]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 27.88440704345703, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.926029205322266, uma_loss is 13.958377838134766
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:08<00:00,  1.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.14s/it]
loss is 28.0657958984375, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.490882873535156, uma_loss is 13.574913024902344
loss is 26.359786987304688, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 14.190582275390625, uma_loss is 12.169204711914062
loss is 25.55535888671875, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 14.853923797607422, uma_loss is 10.701435089111328
loss is 23.332775115966797, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.905097961425781, uma_loss is 9.427677154541016
loss is 22.326547622680664, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.902244567871094, uma_loss is 8.42430305480957
loss is 21.948945999145508, acc1 is 0.1953125, acc5 is 0.537109375, cma_loss is 13.94317626953125, uma_loss is 8.005769729614258
loss is 21.55533790588379, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.917137145996094, uma_loss is 7.638200759887695
loss is 21.162330627441406, acc1 is 0.048828125, acc5 is 0.634765625, cma_loss is 13.884937286376953, uma_loss is 7.2773942947387695
loss is 20.845312118530273, acc1 is 0.1953125, acc5 is 0.5859375, cma_loss is 13.872684478759766, uma_loss is 6.972627639770508
loss is 20.370683670043945, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.871883392333984, uma_loss is 6.498800277709961
loss is 19.924320220947266, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.871421813964844, uma_loss is 6.052899360656738
loss is 19.708480834960938, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.87466049194336, uma_loss is 5.833819389343262
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 138.27it/s]
0 epoch loss is 2.848000789823986,                                    acc1 is 0.11268028846153846, acc5 is 0.5558894230769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 164.83it/s]
-----------------------------------
The average AUROC is 68.7657
The AUROC of I313 is 56.03
The AUROC of I314 is 81.50
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 55.0041
The Specificity of I313 is 40.79
The Specificity of I314 is 69.22
-----------------------------------
The average Youden Index is 49.4486
The Youden Index of I313 is 29.68
The Youden Index of I314 is 69.22
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.56it/s]
  2%|██████▎                                                                                                                                                                                                                                                                                                                             | 1/51 [00:28<23:53, 28.67s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 36.6531
The AUROC of I34 is 43.58
The AUROC of I35 is 45.07
The AUROC of I36 is 21.30
-----------------------------------
The average Sensitivity is 64.3868
The Sensitivity of I34 is 18.58
The Sensitivity of I35 is 74.58
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 37.8456
The Specificity of I34 is 87.09
The Specificity of I35 is 25.64
The Specificity of I36 is 0.81
-----------------------------------
The average Youden Index is 2.2324
The Youden Index of I34 is 5.67
The Youden Index of I35 is 0.22
The Youden Index of I36 is 0.81
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 19.44595718383789, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.875797271728516, uma_loss is 5.570158958435059
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.63s/it]
loss is 19.08778190612793, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.878372192382812, uma_loss is 5.209409713745117
loss is 18.89639663696289, acc1 is 0.09765625, acc5 is 0.48828125, cma_loss is 13.875621795654297, uma_loss is 5.020774841308594
loss is 18.78502082824707, acc1 is 0.146484375, acc5 is 0.68359375, cma_loss is 13.870040893554688, uma_loss is 4.914979934692383
loss is 18.74640464782715, acc1 is 0.048828125, acc5 is 0.439453125, cma_loss is 13.867816925048828, uma_loss is 4.87858772277832
loss is 18.540376663208008, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.867694854736328, uma_loss is 4.672682285308838
loss is 18.46184539794922, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.8616943359375, uma_loss is 4.600152015686035
loss is 18.26231575012207, acc1 is 0.048828125, acc5 is 0.48828125, cma_loss is 13.860820770263672, uma_loss is 4.401495456695557
loss is 18.050121307373047, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.86214828491211, uma_loss is 4.187972545623779
loss is 17.844820022583008, acc1 is 0.146484375, acc5 is 0.439453125, cma_loss is 13.871101379394531, uma_loss is 3.9737186431884766
loss is 17.779338836669922, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.875930786132812, uma_loss is 3.903407096862793
loss is 17.690471649169922, acc1 is 0.146484375, acc5 is 0.390625, cma_loss is 13.87343978881836, uma_loss is 3.817030906677246
loss is 17.52834701538086, acc1 is 0.146484375, acc5 is 0.390625, cma_loss is 13.862804412841797, uma_loss is 3.6655430793762207
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 78.77it/s]
1 epoch loss is 2.2773256937662762,                                    acc1 is 0.11268028846153846, acc5 is 0.49954927884615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 138.80it/s]
-----------------------------------
The average AUROC is 46.1439
The AUROC of I313 is 22.85
The AUROC of I314 is 69.44
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 32.1486
The Specificity of I313 is 3.34
The Specificity of I314 is 60.96
-----------------------------------
The average Youden Index is 23.8152
The Youden Index of I313 is 3.34
The Youden Index of I314 is 44.29
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.03it/s]
  4%|████████████▋                                                                                                                                                                                                                                                                                                                       | 2/51 [00:50<20:15, 24.81s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 47.1177
The AUROC of I34 is 53.04
The AUROC of I35 is 52.18
The AUROC of I36 is 36.13
-----------------------------------
The average Sensitivity is 77.5569
The Sensitivity of I34 is 72.57
The Sensitivity of I35 is 67.80
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 31.1265
The Specificity of I34 is 37.52
The Specificity of I35 is 40.60
The Specificity of I36 is 15.26
-----------------------------------
The average Youden Index is 8.6834
The Youden Index of I34 is 10.08
The Youden Index of I35 is 8.40
The Youden Index of I36 is 7.57
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 17.355182647705078, acc1 is 0.09765625, acc5 is 0.439453125, cma_loss is 13.859188079833984, uma_loss is 3.4959945678710938
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.15s/it]
loss is 17.2304744720459, acc1 is 0.09765625, acc5 is 0.341796875, cma_loss is 13.864452362060547, uma_loss is 3.3660221099853516
loss is 17.175004959106445, acc1 is 0.146484375, acc5 is 0.68359375, cma_loss is 13.860286712646484, uma_loss is 3.31471848487854
loss is 17.062026977539062, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.854358673095703, uma_loss is 3.207669258117676
loss is 17.041580200195312, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.856521606445312, uma_loss is 3.1850578784942627
loss is 16.97515869140625, acc1 is 0.09765625, acc5 is 0.29296875, cma_loss is 13.856807708740234, uma_loss is 3.118351936340332
loss is 16.928491592407227, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.858451843261719, uma_loss is 3.070040225982666
loss is 16.91447639465332, acc1 is 0.0, acc5 is 0.5859375, cma_loss is 13.857048034667969, uma_loss is 3.0574278831481934
loss is 16.894542694091797, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.860485076904297, uma_loss is 3.0340585708618164
loss is 16.83308219909668, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.857528686523438, uma_loss is 2.975553512573242
loss is 16.804168701171875, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.858600616455078, uma_loss is 2.9455690383911133
loss is 16.802806854248047, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.853763580322266, uma_loss is 2.949042797088623
loss is 16.782934188842773, acc1 is 0.146484375, acc5 is 0.5859375, cma_loss is 13.850364685058594, uma_loss is 2.9325690269470215
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 74.05it/s]
2 epoch loss is 2.10285648164295,                                    acc1 is 0.09014423076923077, acc5 is 0.5295973557692307
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 78.76it/s]
-----------------------------------
The average AUROC is 79.4693
The AUROC of I313 is 75.94
The AUROC of I314 is 83.00
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 68.8854
The Specificity of I313 is 64.69
The Specificity of I314 is 73.08
-----------------------------------
The average Youden Index is 63.3299
The Youden Index of I313 is 53.58
The Youden Index of I314 is 73.08
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.45it/s]
  6%|███████████████████                                                                                                                                                                                                                                                                                                                 | 3/51 [01:17<20:26, 25.56s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 44.8981
The AUROC of I34 is 48.52
The AUROC of I35 is 44.77
The AUROC of I36 is 41.40
-----------------------------------
The average Sensitivity is 88.5909
The Sensitivity of I34 is 77.88
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 18.1319
The Specificity of I34 is 30.63
The Specificity of I35 is 1.95
The Specificity of I36 is 21.81
-----------------------------------
The average Youden Index is 6.7228
The Youden Index of I34 is 8.51
The Youden Index of I35 is 1.39
The Youden Index of I36 is 10.27
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.724666595458984, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.850643157958984, uma_loss is 2.874022960662842
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.75s/it]
loss is 16.728309631347656, acc1 is 0.29296875, acc5 is 0.78125, cma_loss is 13.858890533447266, uma_loss is 2.869418144226074
loss is 16.66873550415039, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.855487823486328, uma_loss is 2.813246726989746
loss is 16.613624572753906, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.849872589111328, uma_loss is 2.7637529373168945
loss is 16.477521896362305, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.85540771484375, uma_loss is 2.6221134662628174
loss is 16.42294692993164, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.849933624267578, uma_loss is 2.5730133056640625
loss is 16.34843635559082, acc1 is 0.048828125, acc5 is 0.634765625, cma_loss is 13.857337951660156, uma_loss is 2.491098403930664
loss is 16.20817756652832, acc1 is 0.0, acc5 is 0.48828125, cma_loss is 13.854690551757812, uma_loss is 2.3534862995147705
loss is 16.20585823059082, acc1 is 0.048828125, acc5 is 0.390625, cma_loss is 13.854354858398438, uma_loss is 2.3515028953552246
loss is 16.251901626586914, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.852546691894531, uma_loss is 2.39935564994812
loss is 16.187171936035156, acc1 is 0.09765625, acc5 is 0.341796875, cma_loss is 13.85336685180664, uma_loss is 2.3338046073913574
loss is 16.17191505432129, acc1 is 0.1953125, acc5 is 0.439453125, cma_loss is 13.847198486328125, uma_loss is 2.324716329574585
loss is 16.121780395507812, acc1 is 0.048828125, acc5 is 0.341796875, cma_loss is 13.83697509765625, uma_loss is 2.2848052978515625
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 77.22it/s]
3 epoch loss is 2.0298194885253906,                                    acc1 is 0.11643629807692307, acc5 is 0.5746694711538461
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 110.41it/s]
-----------------------------------
The average AUROC is 71.0278
The AUROC of I313 is 54.75
The AUROC of I314 is 87.31
-----------------------------------
The average Sensitivity is 88.8889
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 61.3067
The Specificity of I313 is 47.60
The Specificity of I314 is 75.02
-----------------------------------
The average Youden Index is 50.1956
The Youden Index of I313 is 25.37
The Youden Index of I314 is 75.02
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.90it/s]
  8%|█████████████████████████▍                                                                                                                                                                                                                                                                                                          | 4/51 [01:39<19:07, 24.41s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 40.8177
The AUROC of I34 is 46.99
The AUROC of I35 is 44.62
The AUROC of I36 is 30.84
-----------------------------------
The average Sensitivity is 97.3951
The Sensitivity of I34 is 95.58
The Sensitivity of I35 is 96.61
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 5.3336
The Specificity of I34 is 6.74
The Specificity of I35 is 6.69
The Specificity of I36 is 2.57
-----------------------------------
The average Youden Index is 2.7287
The Youden Index of I34 is 2.32
The Youden Index of I35 is 3.30
The Youden Index of I36 is 2.57
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 16.06586456298828, acc1 is 0.048828125, acc5 is 0.732421875, cma_loss is 13.838813781738281, uma_loss is 2.227050542831421
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  2.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  2.00s/it]
loss is 16.039234161376953, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.845447540283203, uma_loss is 2.19378662109375
loss is 16.025358200073242, acc1 is 0.146484375, acc5 is 0.48828125, cma_loss is 13.840587615966797, uma_loss is 2.1847710609436035
loss is 16.006589889526367, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.815410614013672, uma_loss is 2.1911797523498535
loss is 15.971919059753418, acc1 is 0.146484375, acc5 is 0.537109375, cma_loss is 13.839714050292969, uma_loss is 2.13220477104187
loss is 15.86501693725586, acc1 is 0.09765625, acc5 is 0.830078125, cma_loss is 13.827632904052734, uma_loss is 2.037383794784546
loss is 15.841842651367188, acc1 is 0.1953125, acc5 is 0.78125, cma_loss is 13.820781707763672, uma_loss is 2.0210609436035156
loss is 15.782870292663574, acc1 is 0.048828125, acc5 is 0.68359375, cma_loss is 13.826290130615234, uma_loss is 1.9565798044204712
loss is 15.706567764282227, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.811126708984375, uma_loss is 1.8954410552978516
loss is 15.675776481628418, acc1 is 0.048828125, acc5 is 0.537109375, cma_loss is 13.821537017822266, uma_loss is 1.8542392253875732
loss is 15.705096244812012, acc1 is 0.048828125, acc5 is 0.244140625, cma_loss is 13.825393676757812, uma_loss is 1.8797023296356201
loss is 15.645846366882324, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.802989959716797, uma_loss is 1.8428566455841064
loss is 15.678279876708984, acc1 is 0.244140625, acc5 is 0.68359375, cma_loss is 13.803627014160156, uma_loss is 1.87465238571167
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 67.37it/s]
4 epoch loss is 1.9620024998982748,                                    acc1 is 0.11643629807692307, acc5 is 0.6272536057692307
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.23it/s]
/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/zeroshot_val.py:189: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
-----------------------------------
The average AUROC is 32.4566
The AUROC of I313 is 43.01
The AUROC of I314 is 21.91
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 12.4419
The Specificity of I313 is 16.82
The Specificity of I314 is 8.06
-----------------------------------
The average Youden Index is 12.4419
The Youden Index of I313 is 16.82
The Youden Index of I314 is 8.06
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 70.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.12it/s]
 10%|███████████████████████████████▊                                                                                                                                                                                                                                                                                                    | 5/51 [02:01<17:53, 23.33s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 57.6223
The AUROC of I34 is 49.69
The AUROC of I35 is 57.35
The AUROC of I36 is 65.83
-----------------------------------
The average Sensitivity is 60.0628
The Sensitivity of I34 is 53.98
The Sensitivity of I35 is 33.90
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 58.2730
The Specificity of I34 is 54.88
The Specificity of I35 is 79.02
The Specificity of I36 is 40.92
-----------------------------------
The average Youden Index is 18.3357
The Youden Index of I34 is 8.86
The Youden Index of I35 is 12.92
The Youden Index of I36 is 33.23
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.57848834991455, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.794403076171875, uma_loss is 1.7840853929519653
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.01s/it]
loss is 15.637269020080566, acc1 is 0.146484375, acc5 is 0.29296875, cma_loss is 13.8187255859375, uma_loss is 1.818543553352356
loss is 15.569153785705566, acc1 is 0.048828125, acc5 is 0.634765625, cma_loss is 13.814353942871094, uma_loss is 1.754799723625183
loss is 15.502264022827148, acc1 is 0.1953125, acc5 is 1.025390625, cma_loss is 13.747756958007812, uma_loss is 1.754507064819336
loss is 15.573318481445312, acc1 is 0.146484375, acc5 is 0.87890625, cma_loss is 13.801948547363281, uma_loss is 1.7713701725006104
loss is 15.565193176269531, acc1 is 0.09765625, acc5 is 0.5859375, cma_loss is 13.785690307617188, uma_loss is 1.7795026302337646
loss is 15.50740909576416, acc1 is 0.1953125, acc5 is 0.634765625, cma_loss is 13.783912658691406, uma_loss is 1.7234961986541748
loss is 15.513282775878906, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.753807067871094, uma_loss is 1.7594757080078125
loss is 15.470019340515137, acc1 is 0.244140625, acc5 is 0.927734375, cma_loss is 13.750003814697266, uma_loss is 1.7200157642364502
loss is 15.438076972961426, acc1 is 0.146484375, acc5 is 0.732421875, cma_loss is 13.73715591430664, uma_loss is 1.7009207010269165
loss is 15.456158638000488, acc1 is 0.048828125, acc5 is 0.5859375, cma_loss is 13.764427185058594, uma_loss is 1.6917316913604736
loss is 15.349679946899414, acc1 is 0.1953125, acc5 is 0.68359375, cma_loss is 13.710445404052734, uma_loss is 1.639235019683838
loss is 15.344721794128418, acc1 is 0.1953125, acc5 is 0.9765625, cma_loss is 13.726329803466797, uma_loss is 1.6183923482894897
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 78.26it/s]
5 epoch loss is 1.9190955752418155,                                    acc1 is 0.1502403846153846, acc5 is 0.7361778846153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 162.86it/s]
-----------------------------------
The average AUROC is 54.9199
The AUROC of I313 is 62.04
The AUROC of I314 is 47.80
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 27.2158
The Specificity of I313 is 33.98
The Specificity of I314 is 20.45
-----------------------------------
The average Youden Index is 27.2158
The Youden Index of I313 is 33.98
The Youden Index of I314 is 20.45
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.31it/s]
 12%|██████████████████████████████████████                                                                                                                                                                                                                                                                                              | 6/51 [02:21<16:48, 22.42s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 55.9996
The AUROC of I34 is 56.73
The AUROC of I35 is 54.34
The AUROC of I36 is 56.93
-----------------------------------
The average Sensitivity is 65.9660
The Sensitivity of I34 is 53.98
The Sensitivity of I35 is 78.53
The Sensitivity of I36 is 65.38
-----------------------------------
The average Specificity is 48.3891
The Specificity of I34 is 61.12
The Specificity of I35 is 30.30
The Specificity of I36 is 53.75
-----------------------------------
The average Youden Index is 14.3551
The Youden Index of I34 is 15.10
The Youden Index of I35 is 8.83
The Youden Index of I36 is 19.13
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 15.292724609375, acc1 is 0.244140625, acc5 is 0.927734375, cma_loss is 13.703311920166016, uma_loss is 1.5894129276275635
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.87s/it]
loss is 15.241049766540527, acc1 is 0.146484375, acc5 is 0.78125, cma_loss is 13.724609375, uma_loss is 1.5164403915405273
loss is 15.329760551452637, acc1 is 0.0, acc5 is 0.48828125, cma_loss is 13.787193298339844, uma_loss is 1.542567491531372
loss is 15.194894790649414, acc1 is 0.146484375, acc5 is 0.634765625, cma_loss is 13.752979278564453, uma_loss is 1.44191575050354
loss is 15.150693893432617, acc1 is 0.146484375, acc5 is 0.9765625, cma_loss is 13.706424713134766, uma_loss is 1.4442695379257202
loss is 15.146526336669922, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.760581970214844, uma_loss is 1.3859440088272095
loss is 15.078514099121094, acc1 is 0.09765625, acc5 is 1.025390625, cma_loss is 13.701053619384766, uma_loss is 1.3774601221084595
loss is 15.047478675842285, acc1 is 0.29296875, acc5 is 1.07421875, cma_loss is 13.691082000732422, uma_loss is 1.3563966751098633
loss is 15.03316879272461, acc1 is 0.09765625, acc5 is 0.68359375, cma_loss is 13.697799682617188, uma_loss is 1.33536958694458
loss is 14.987253189086914, acc1 is 0.09765625, acc5 is 0.537109375, cma_loss is 13.686458587646484, uma_loss is 1.300795078277588
loss is 14.935169219970703, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.662952423095703, uma_loss is 1.2722171545028687
loss is 14.878561973571777, acc1 is 0.1953125, acc5 is 0.68359375, cma_loss is 13.663599014282227, uma_loss is 1.2149630784988403
loss is 14.88761043548584, acc1 is 0.09765625, acc5 is 0.830078125, cma_loss is 13.658279418945312, uma_loss is 1.2293307781219482
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 70.42it/s]
6 epoch loss is 1.868603869846889,                                    acc1 is 0.1427283653846154, acc5 is 0.7850060096153846
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 156.99it/s]
-----------------------------------
The average AUROC is 73.1094
The AUROC of I313 is 69.20
The AUROC of I314 is 77.02
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 60.5167
The Specificity of I313 is 57.01
The Specificity of I314 is 64.02
-----------------------------------
The average Youden Index is 54.9611
The Youden Index of I313 is 45.90
The Youden Index of I314 is 64.02
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.91it/s]
 14%|████████████████████████████████████████████▍                                                                                                                                                                                                                                                                                       | 7/51 [02:43<16:20, 22.29s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 46.8277
The AUROC of I34 is 50.77
The AUROC of I35 is 51.73
The AUROC of I36 is 37.98
-----------------------------------
The average Sensitivity is 88.9292
The Sensitivity of I34 is 88.50
The Sensitivity of I35 is 89.83
The Sensitivity of I36 is 88.46
-----------------------------------
The average Specificity is 21.3681
The Specificity of I34 is 22.24
The Specificity of I35 is 21.88
The Specificity of I36 is 19.99
-----------------------------------
The average Youden Index is 10.2973
The Youden Index of I34 is 10.73
The Youden Index of I35 is 11.71
The Youden Index of I36 is 8.45
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.807502746582031, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.665241241455078, uma_loss is 1.1422613859176636
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.90s/it]
loss is 14.781172752380371, acc1 is 0.048828125, acc5 is 0.87890625, cma_loss is 13.633350372314453, uma_loss is 1.1478222608566284
loss is 14.878595352172852, acc1 is 0.244140625, acc5 is 1.025390625, cma_loss is 13.68499755859375, uma_loss is 1.1935980319976807
loss is 14.7089262008667, acc1 is 0.048828125, acc5 is 0.830078125, cma_loss is 13.608512878417969, uma_loss is 1.1004135608673096
loss is 14.790532112121582, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.659576416015625, uma_loss is 1.1309555768966675
loss is 14.76287841796875, acc1 is 0.1953125, acc5 is 0.87890625, cma_loss is 13.665515899658203, uma_loss is 1.0973620414733887
loss is 14.690489768981934, acc1 is 0.09765625, acc5 is 0.78125, cma_loss is 13.639183044433594, uma_loss is 1.0513067245483398
loss is 14.691499710083008, acc1 is 0.29296875, acc5 is 1.416015625, cma_loss is 13.632946014404297, uma_loss is 1.0585532188415527
loss is 14.642693519592285, acc1 is 0.1953125, acc5 is 0.830078125, cma_loss is 13.660369873046875, uma_loss is 0.982323408126831
loss is 14.605720520019531, acc1 is 0.29296875, acc5 is 1.318359375, cma_loss is 13.623554229736328, uma_loss is 0.9821665287017822
loss is 14.562983512878418, acc1 is 0.1953125, acc5 is 1.171875, cma_loss is 13.579902648925781, uma_loss is 0.9830806255340576
loss is 14.560522079467773, acc1 is 0.09765625, acc5 is 0.732421875, cma_loss is 13.580677032470703, uma_loss is 0.9798449873924255
loss is 14.543817520141602, acc1 is 0.146484375, acc5 is 0.830078125, cma_loss is 13.593578338623047, uma_loss is 0.9502388834953308
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 62.03it/s]
7 epoch loss is 1.8193079448881604,                                    acc1 is 0.16902043269230768, acc5 is 0.9690504807692307
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 124.38it/s]
-----------------------------------
The average AUROC is 44.1484
The AUROC of I313 is 59.36
The AUROC of I314 is 28.94
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 22.8897
The Specificity of I313 is 38.25
The Specificity of I314 is 7.53
-----------------------------------
The average Youden Index is 22.8897
The Youden Index of I313 is 38.25
The Youden Index of I314 is 7.53
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.93it/s]
 16%|██████████████████████████████████████████████████▊                                                                                                                                                                                                                                                                                 | 8/51 [03:04<15:39, 21.85s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.3957
The AUROC of I34 is 51.51
The AUROC of I35 is 53.09
The AUROC of I36 is 40.58
-----------------------------------
The average Sensitivity is 79.6177
The Sensitivity of I34 is 90.27
The Sensitivity of I35 is 48.59
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 31.8268
The Specificity of I34 is 16.79
The Specificity of I35 is 62.56
The Specificity of I36 is 16.14
-----------------------------------
The average Youden Index is 11.4445
The Youden Index of I34 is 7.05
The Youden Index of I35 is 11.14
The Youden Index of I36 is 16.14
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.537572860717773, acc1 is 0.29296875, acc5 is 0.9765625, cma_loss is 13.625377655029297, uma_loss is 0.9121952056884766
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.47it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.11s/it]
loss is 14.499899864196777, acc1 is 0.1953125, acc5 is 1.025390625, cma_loss is 13.55898666381836, uma_loss is 0.9409133791923523
loss is 14.531842231750488, acc1 is 0.29296875, acc5 is 1.07421875, cma_loss is 13.61636734008789, uma_loss is 0.9154748916625977
loss is 14.456929206848145, acc1 is 0.1953125, acc5 is 1.07421875, cma_loss is 13.550941467285156, uma_loss is 0.9059877991676331
loss is 14.464277267456055, acc1 is 0.1953125, acc5 is 1.025390625, cma_loss is 13.57095718383789, uma_loss is 0.8933203220367432
loss is 14.469197273254395, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.589954376220703, uma_loss is 0.8792431950569153
loss is 14.393980979919434, acc1 is 0.048828125, acc5 is 1.07421875, cma_loss is 13.546966552734375, uma_loss is 0.8470146656036377
loss is 14.443293571472168, acc1 is 0.244140625, acc5 is 1.46484375, cma_loss is 13.55575942993164, uma_loss is 0.8875338435173035
loss is 14.367626190185547, acc1 is 0.341796875, acc5 is 1.123046875, cma_loss is 13.547416687011719, uma_loss is 0.8202099204063416
loss is 14.356759071350098, acc1 is 0.146484375, acc5 is 1.513671875, cma_loss is 13.54638671875, uma_loss is 0.810371994972229
loss is 14.298635482788086, acc1 is 0.244140625, acc5 is 1.5625, cma_loss is 13.518104553222656, uma_loss is 0.7805310487747192
loss is 14.332476615905762, acc1 is 0.146484375, acc5 is 1.26953125, cma_loss is 13.516521453857422, uma_loss is 0.8159549236297607
loss is 14.320560455322266, acc1 is 0.341796875, acc5 is 0.927734375, cma_loss is 13.554447174072266, uma_loss is 0.76611328125
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 95.27it/s]
8 epoch loss is 1.7854576292492095,                                    acc1 is 0.22536057692307693, acc5 is 1.171875
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 147.21it/s]
-----------------------------------
The average AUROC is 30.3358
The AUROC of I313 is 39.32
The AUROC of I314 is 21.35
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 13.7450
The Specificity of I313 is 20.83
The Specificity of I314 is 6.66
-----------------------------------
The average Youden Index is 13.7450
The Youden Index of I313 is 20.83
The Youden Index of I314 is 6.66
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.18it/s]
 18%|█████████████████████████████████████████████████████████▏                                                                                                                                                                                                                                                                          | 9/51 [03:25<15:07, 21.61s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.7441
The AUROC of I34 is 49.80
The AUROC of I35 is 42.73
The AUROC of I36 is 38.70
-----------------------------------
The average Sensitivity is 92.3554
The Sensitivity of I34 is 78.76
The Sensitivity of I35 is 98.31
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 15.7739
The Specificity of I34 is 29.41
The Specificity of I35 is 4.14
The Specificity of I36 is 13.77
-----------------------------------
The average Youden Index is 8.1292
The Youden Index of I34 is 8.17
The Youden Index of I35 is 2.44
The Youden Index of I36 is 13.77
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.341493606567383, acc1 is 0.341796875, acc5 is 1.123046875, cma_loss is 13.557689666748047, uma_loss is 0.7838035225868225
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.20s/it]
loss is 14.299060821533203, acc1 is 0.146484375, acc5 is 1.318359375, cma_loss is 13.507499694824219, uma_loss is 0.7915613055229187
loss is 14.331021308898926, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.54636001586914, uma_loss is 0.7846614122390747
loss is 14.299458503723145, acc1 is 0.244140625, acc5 is 1.3671875, cma_loss is 13.509422302246094, uma_loss is 0.7900363802909851
loss is 14.26895809173584, acc1 is 0.244140625, acc5 is 1.123046875, cma_loss is 13.508514404296875, uma_loss is 0.760443925857544
loss is 14.283883094787598, acc1 is 0.341796875, acc5 is 1.46484375, cma_loss is 13.53531265258789, uma_loss is 0.7485702037811279
loss is 14.229063987731934, acc1 is 0.341796875, acc5 is 1.171875, cma_loss is 13.47677230834961, uma_loss is 0.7522918581962585
loss is 14.212268829345703, acc1 is 0.390625, acc5 is 1.416015625, cma_loss is 13.473854064941406, uma_loss is 0.7384150624275208
loss is 14.29521656036377, acc1 is 0.29296875, acc5 is 1.07421875, cma_loss is 13.5423583984375, uma_loss is 0.7528584599494934
loss is 14.253711700439453, acc1 is 0.1953125, acc5 is 1.513671875, cma_loss is 13.512989044189453, uma_loss is 0.7407224178314209
loss is 14.161248207092285, acc1 is 0.244140625, acc5 is 1.66015625, cma_loss is 13.421066284179688, uma_loss is 0.7401818633079529
loss is 14.184050559997559, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.450870513916016, uma_loss is 0.7331802248954773
loss is 14.194816589355469, acc1 is 0.29296875, acc5 is 1.220703125, cma_loss is 13.470108032226562, uma_loss is 0.7247089743614197
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 67.41it/s]
9 epoch loss is 1.765278589157831,                                    acc1 is 0.2854567307692308, acc5 is 1.3146033653846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 101.96it/s]
-----------------------------------
The average AUROC is 31.8196
The AUROC of I313 is 44.54
The AUROC of I314 is 19.10
-----------------------------------
The average Sensitivity is 94.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 19.2205
The Specificity of I313 is 33.31
The Specificity of I314 is 5.13
-----------------------------------
The average Youden Index is 13.6649
The Youden Index of I313 is 22.20
The Youden Index of I314 is 5.13
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.78it/s]
 20%|███████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                                   | 10/51 [03:48<14:51, 21.75s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.8884
The AUROC of I34 is 50.54
The AUROC of I35 is 42.85
The AUROC of I36 is 38.27
-----------------------------------
The average Sensitivity is 96.2719
The Sensitivity of I34 is 89.38
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 11.7612
The Specificity of I34 is 18.79
The Specificity of I35 is 2.78
The Specificity of I36 is 13.71
-----------------------------------
The average Youden Index is 8.0331
The Youden Index of I34 is 8.18
The Youden Index of I35 is 2.22
The Youden Index of I36 is 13.71
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.175453186035156, acc1 is 0.390625, acc5 is 1.26953125, cma_loss is 13.48507308959961, uma_loss is 0.6903802752494812
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.12s/it]
loss is 14.1162748336792, acc1 is 0.390625, acc5 is 1.806640625, cma_loss is 13.425281524658203, uma_loss is 0.6909929513931274
loss is 14.156734466552734, acc1 is 0.537109375, acc5 is 1.5625, cma_loss is 13.462173461914062, uma_loss is 0.6945606470108032
loss is 14.074651718139648, acc1 is 0.634765625, acc5 is 2.099609375, cma_loss is 13.375900268554688, uma_loss is 0.6987519264221191
loss is 14.109872817993164, acc1 is 0.341796875, acc5 is 1.416015625, cma_loss is 13.433086395263672, uma_loss is 0.6767863631248474
loss is 14.127937316894531, acc1 is 0.146484375, acc5 is 1.318359375, cma_loss is 13.466466903686523, uma_loss is 0.661470353603363
loss is 14.060830116271973, acc1 is 0.29296875, acc5 is 1.26953125, cma_loss is 13.407917022705078, uma_loss is 0.6529128551483154
loss is 14.10738754272461, acc1 is 0.634765625, acc5 is 1.66015625, cma_loss is 13.435184478759766, uma_loss is 0.672203540802002
loss is 14.088155746459961, acc1 is 0.244140625, acc5 is 1.3671875, cma_loss is 13.458534240722656, uma_loss is 0.6296212673187256
loss is 14.060470581054688, acc1 is 0.48828125, acc5 is 1.85546875, cma_loss is 13.413497924804688, uma_loss is 0.64697265625
loss is 13.990060806274414, acc1 is 0.146484375, acc5 is 1.708984375, cma_loss is 13.363410949707031, uma_loss is 0.6266498565673828
loss is 14.048879623413086, acc1 is 0.244140625, acc5 is 1.708984375, cma_loss is 13.420974731445312, uma_loss is 0.6279044151306152
loss is 14.106382369995117, acc1 is 0.1953125, acc5 is 1.46484375, cma_loss is 13.511951446533203, uma_loss is 0.5944312810897827
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 117.52it/s]
10 epoch loss is 1.7449818202427456,                                    acc1 is 0.3605769230769231, acc5 is 1.5775240384615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 160.36it/s]
-----------------------------------
The average AUROC is 72.7595
The AUROC of I313 is 78.39
The AUROC of I314 is 67.13
-----------------------------------
The average Sensitivity is 100.0000
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 47.1922
The Specificity of I313 is 57.01
The Specificity of I314 is 37.38
-----------------------------------
The average Youden Index is 47.1922
The Youden Index of I313 is 57.01
The Youden Index of I314 is 37.38
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.11it/s]
 22%|█████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                                             | 11/51 [04:10<14:34, 21.85s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.6885
The AUROC of I34 is 51.07
The AUROC of I35 is 43.18
The AUROC of I36 is 36.82
-----------------------------------
The average Sensitivity is 96.2719
The Sensitivity of I34 is 89.38
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 11.3976
The Specificity of I34 is 18.22
The Specificity of I35 is 3.01
The Specificity of I36 is 12.96
-----------------------------------
The average Youden Index is 7.6694
The Youden Index of I34 is 7.60
The Youden Index of I35 is 2.44
The Youden Index of I36 is 12.96
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 14.133478164672852, acc1 is 0.1953125, acc5 is 1.3671875, cma_loss is 13.549583435058594, uma_loss is 0.5838950276374817
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.28s/it]
loss is 14.040693283081055, acc1 is 0.1953125, acc5 is 1.708984375, cma_loss is 13.44327163696289, uma_loss is 0.5974214673042297
loss is 14.158151626586914, acc1 is 0.29296875, acc5 is 1.46484375, cma_loss is 13.549049377441406, uma_loss is 0.6091025471687317
loss is 14.007159233093262, acc1 is 0.48828125, acc5 is 2.099609375, cma_loss is 13.405838012695312, uma_loss is 0.6013214588165283
loss is 14.007024765014648, acc1 is 0.29296875, acc5 is 1.953125, cma_loss is 13.410999298095703, uma_loss is 0.5960256457328796
loss is 14.052984237670898, acc1 is 0.439453125, acc5 is 1.171875, cma_loss is 13.425079345703125, uma_loss is 0.6279049515724182
loss is 13.993799209594727, acc1 is 0.29296875, acc5 is 1.416015625, cma_loss is 13.388387680053711, uma_loss is 0.605411171913147
loss is 13.965662002563477, acc1 is 0.537109375, acc5 is 1.611328125, cma_loss is 13.361255645751953, uma_loss is 0.6044062972068787
loss is 13.988009452819824, acc1 is 0.439453125, acc5 is 1.5625, cma_loss is 13.37600326538086, uma_loss is 0.6120057702064514
loss is 13.940051078796387, acc1 is 0.29296875, acc5 is 1.5625, cma_loss is 13.348640441894531, uma_loss is 0.5914106369018555
loss is 13.92133903503418, acc1 is 0.390625, acc5 is 1.611328125, cma_loss is 13.333122253417969, uma_loss is 0.5882169008255005
loss is 13.897422790527344, acc1 is 0.390625, acc5 is 1.7578125, cma_loss is 13.319293975830078, uma_loss is 0.5781287550926208
loss is 13.90270709991455, acc1 is 0.439453125, acc5 is 1.85546875, cma_loss is 13.308738708496094, uma_loss is 0.5939688086509705
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 77.31it/s]
11 epoch loss is 1.7334141140892392,                                    acc1 is 0.3605769230769231, acc5 is 1.6263521634615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 91.90it/s]
-----------------------------------
The average AUROC is 69.2080
The AUROC of I313 is 74.54
The AUROC of I314 is 63.88
-----------------------------------
The average Sensitivity is 69.4444
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 50.00
-----------------------------------
The average Specificity is 74.6159
The Specificity of I313 is 65.69
The Specificity of I314 is 83.54
-----------------------------------
The average Youden Index is 44.0604
The Youden Index of I313 is 54.58
The Youden Index of I314 is 33.54
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.35it/s]
 24%|████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                                       | 12/51 [04:32<14:17, 22.00s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.4047
The AUROC of I34 is 51.31
The AUROC of I35 is 42.73
The AUROC of I36 is 36.17
-----------------------------------
The average Sensitivity is 95.8952
The Sensitivity of I34 is 89.38
The Sensitivity of I35 is 98.31
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 11.7152
The Specificity of I34 is 19.37
The Specificity of I35 is 3.08
The Specificity of I36 is 12.69
-----------------------------------
The average Youden Index is 7.6104
The Youden Index of I34 is 8.75
The Youden Index of I35 is 1.39
The Youden Index of I36 is 12.69
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.899361610412598, acc1 is 0.634765625, acc5 is 1.904296875, cma_loss is 13.33023452758789, uma_loss is 0.5691273212432861
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.25s/it]
loss is 13.858013153076172, acc1 is 0.5859375, acc5 is 2.001953125, cma_loss is 13.28729248046875, uma_loss is 0.5707210302352905
loss is 13.900168418884277, acc1 is 0.29296875, acc5 is 1.904296875, cma_loss is 13.326900482177734, uma_loss is 0.5732683539390564
loss is 13.883322715759277, acc1 is 0.390625, acc5 is 2.197265625, cma_loss is 13.294780731201172, uma_loss is 0.5885419249534607
loss is 13.85816478729248, acc1 is 0.390625, acc5 is 1.66015625, cma_loss is 13.298385620117188, uma_loss is 0.5597792267799377
loss is 13.889636039733887, acc1 is 0.390625, acc5 is 1.7578125, cma_loss is 13.343036651611328, uma_loss is 0.5465995073318481
loss is 13.852025032043457, acc1 is 0.1953125, acc5 is 2.099609375, cma_loss is 13.30031967163086, uma_loss is 0.5517057776451111
loss is 13.85479736328125, acc1 is 0.537109375, acc5 is 2.34375, cma_loss is 13.301841735839844, uma_loss is 0.5529557466506958
loss is 13.881403923034668, acc1 is 0.390625, acc5 is 2.05078125, cma_loss is 13.318687438964844, uma_loss is 0.5627160668373108
loss is 13.874086380004883, acc1 is 0.390625, acc5 is 1.3671875, cma_loss is 13.335433959960938, uma_loss is 0.5386525392532349
loss is 13.806135177612305, acc1 is 0.439453125, acc5 is 2.294921875, cma_loss is 13.26361083984375, uma_loss is 0.5425243973731995
loss is 13.877373695373535, acc1 is 0.244140625, acc5 is 1.7578125, cma_loss is 13.317481994628906, uma_loss is 0.5598919987678528
loss is 13.82232666015625, acc1 is 0.341796875, acc5 is 1.708984375, cma_loss is 13.291358947753906, uma_loss is 0.5309677720069885
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 169.69it/s]
12 epoch loss is 1.7167315710158575,                                    acc1 is 0.40189302884615385, acc5 is 1.9268329326923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 87.02it/s]
-----------------------------------
The average AUROC is 74.4135
The AUROC of I313 is 79.82
The AUROC of I314 is 69.01
-----------------------------------
The average Sensitivity is 91.6667
The Sensitivity of I313 is 100.00
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 66.8481
The Specificity of I313 is 59.35
The Specificity of I314 is 74.35
-----------------------------------
The average Youden Index is 58.5148
The Youden Index of I313 is 59.35
The Youden Index of I314 is 57.68
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.24it/s]
 25%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                                                | 13/51 [04:54<13:58, 22.06s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 42.8272
The AUROC of I34 is 51.26
The AUROC of I35 is 41.82
The AUROC of I36 is 35.40
-----------------------------------
The average Sensitivity is 91.1029
The Sensitivity of I34 is 84.96
The Sensitivity of I35 is 96.05
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 15.6816
The Specificity of I34 is 24.39
The Specificity of I35 is 5.64
The Specificity of I36 is 17.02
-----------------------------------
The average Youden Index is 6.7845
The Youden Index of I34 is 9.35
The Youden Index of I35 is 1.68
The Youden Index of I36 is 9.32
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.80764102935791, acc1 is 0.537109375, acc5 is 2.294921875, cma_loss is 13.282196044921875, uma_loss is 0.5254446268081665
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.18s/it]
loss is 13.803064346313477, acc1 is 0.439453125, acc5 is 1.66015625, cma_loss is 13.26407241821289, uma_loss is 0.5389919877052307
loss is 13.816566467285156, acc1 is 0.537109375, acc5 is 2.1484375, cma_loss is 13.286750793457031, uma_loss is 0.5298159122467041
loss is 13.790777206420898, acc1 is 0.537109375, acc5 is 2.5390625, cma_loss is 13.243019104003906, uma_loss is 0.5477581024169922
loss is 13.795509338378906, acc1 is 0.634765625, acc5 is 2.5390625, cma_loss is 13.265361785888672, uma_loss is 0.5301471948623657
loss is 13.849527359008789, acc1 is 0.1953125, acc5 is 1.5625, cma_loss is 13.317403793334961, uma_loss is 0.5321236848831177
loss is 13.737387657165527, acc1 is 0.68359375, acc5 is 1.904296875, cma_loss is 13.19699478149414, uma_loss is 0.5403932929039001
loss is 13.706130027770996, acc1 is 0.341796875, acc5 is 2.24609375, cma_loss is 13.168350219726562, uma_loss is 0.5377795696258545
loss is 13.839362144470215, acc1 is 0.390625, acc5 is 2.001953125, cma_loss is 13.307506561279297, uma_loss is 0.5318559408187866
loss is 13.817376136779785, acc1 is 0.634765625, acc5 is 2.294921875, cma_loss is 13.285104751586914, uma_loss is 0.5322709679603577
loss is 13.765384674072266, acc1 is 0.341796875, acc5 is 2.001953125, cma_loss is 13.246875762939453, uma_loss is 0.518509030342102
loss is 13.74061393737793, acc1 is 0.48828125, acc5 is 2.24609375, cma_loss is 13.21286392211914, uma_loss is 0.5277495980262756
loss is 13.732277870178223, acc1 is 0.439453125, acc5 is 2.24609375, cma_loss is 13.22726821899414, uma_loss is 0.505009651184082
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 81.04it/s]
13 epoch loss is 1.7066820780436198,                                    acc1 is 0.47701322115384615, acc5 is 2.129657451923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 111.61it/s]
-----------------------------------
The average AUROC is 57.1363
The AUROC of I313 is 59.60
The AUROC of I314 is 54.67
-----------------------------------
The average Sensitivity is 50.0000
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 33.33
-----------------------------------
The average Specificity is 75.4102
The Specificity of I313 is 60.48
The Specificity of I314 is 90.34
-----------------------------------
The average Youden Index is 25.4102
The Youden Index of I313 is 27.15
The Youden Index of I314 is 23.67
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.83it/s]
 27%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                                          | 14/51 [05:16<13:29, 21.88s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 41.4832
The AUROC of I34 is 50.10
The AUROC of I35 is 41.99
The AUROC of I36 is 32.36
-----------------------------------
The average Sensitivity is 94.1911
The Sensitivity of I34 is 90.27
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 10.4453
The Specificity of I34 is 17.58
The Specificity of I35 is 0.53
The Specificity of I36 is 13.23
-----------------------------------
The average Youden Index is 4.6364
The Youden Index of I34 is 7.84
The Youden Index of I35 is 0.53
The Youden Index of I36 is 5.54
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.694609642028809, acc1 is 0.68359375, acc5 is 3.076171875, cma_loss is 13.182758331298828, uma_loss is 0.5118516683578491
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.23s/it]
loss is 13.808053970336914, acc1 is 0.390625, acc5 is 1.611328125, cma_loss is 13.263059616088867, uma_loss is 0.5449944734573364
loss is 13.899561882019043, acc1 is 0.244140625, acc5 is 2.63671875, cma_loss is 13.373027801513672, uma_loss is 0.5265337824821472
loss is 13.763581275939941, acc1 is 0.830078125, acc5 is 2.783203125, cma_loss is 13.256109237670898, uma_loss is 0.5074720978736877
loss is 13.70525074005127, acc1 is 0.5859375, acc5 is 2.880859375, cma_loss is 13.199851989746094, uma_loss is 0.5053985118865967
loss is 13.808258056640625, acc1 is 0.537109375, acc5 is 1.904296875, cma_loss is 13.305778503417969, uma_loss is 0.502479076385498
loss is 13.795638084411621, acc1 is 0.390625, acc5 is 1.66015625, cma_loss is 13.27096939086914, uma_loss is 0.5246684551239014
loss is 13.678688049316406, acc1 is 0.537109375, acc5 is 2.685546875, cma_loss is 13.13557243347168, uma_loss is 0.5431151986122131
loss is 13.750226974487305, acc1 is 0.390625, acc5 is 1.904296875, cma_loss is 13.244583129882812, uma_loss is 0.5056436657905579
loss is 13.828595161437988, acc1 is 0.390625, acc5 is 2.099609375, cma_loss is 13.308364868164062, uma_loss is 0.5202303528785706
loss is 13.698728561401367, acc1 is 0.5859375, acc5 is 2.880859375, cma_loss is 13.20437240600586, uma_loss is 0.49435606598854065
loss is 13.679807662963867, acc1 is 0.48828125, acc5 is 2.34375, cma_loss is 13.186038970947266, uma_loss is 0.4937688708305359
loss is 13.692941665649414, acc1 is 0.68359375, acc5 is 2.5390625, cma_loss is 13.193899154663086, uma_loss is 0.49904292821884155
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 76.91it/s]
14 epoch loss is 1.7028946831112817,                                    acc1 is 0.5183293269230769, acc5 is 2.385066105769231
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 97.28it/s]
-----------------------------------
The average AUROC is 59.7469
The AUROC of I313 is 68.22
The AUROC of I314 is 51.28
-----------------------------------
The average Sensitivity is 75.0000
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 54.9692
The Specificity of I313 is 72.50
The Specificity of I314 is 37.44
-----------------------------------
The average Youden Index is 29.9692
The Youden Index of I313 is 39.16
The Youden Index of I314 is 20.78
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.10it/s]
 29%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                                    | 15/51 [05:38<13:09, 21.93s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 41.9446
The AUROC of I34 is 51.38
The AUROC of I35 is 41.33
The AUROC of I36 is 33.13
-----------------------------------
The average Sensitivity is 89.7301
The Sensitivity of I34 is 76.99
The Sensitivity of I35 is 96.05
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 15.9820
The Specificity of I34 is 29.99
The Specificity of I35 is 6.62
The Specificity of I36 is 11.34
-----------------------------------
The average Youden Index is 5.7120
The Youden Index of I34 is 6.98
The Youden Index of I35 is 2.66
The Youden Index of I36 is 7.50
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.732285499572754, acc1 is 0.439453125, acc5 is 2.392578125, cma_loss is 13.241352081298828, uma_loss is 0.4909338057041168
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.85s/it]
loss is 13.605016708374023, acc1 is 0.87890625, acc5 is 3.125, cma_loss is 13.111629486083984, uma_loss is 0.49338725209236145
loss is 13.762065887451172, acc1 is 0.341796875, acc5 is 2.197265625, cma_loss is 13.274396896362305, uma_loss is 0.4876687526702881
loss is 13.653022766113281, acc1 is 0.732421875, acc5 is 3.125, cma_loss is 13.171630859375, uma_loss is 0.4813915491104126
loss is 13.627252578735352, acc1 is 0.5859375, acc5 is 2.63671875, cma_loss is 13.158832550048828, uma_loss is 0.4684200882911682
loss is 13.705134391784668, acc1 is 0.732421875, acc5 is 2.44140625, cma_loss is 13.233453750610352, uma_loss is 0.4716804623603821
loss is 13.639569282531738, acc1 is 0.537109375, acc5 is 2.587890625, cma_loss is 13.15212631225586, uma_loss is 0.4874432384967804
loss is 13.593523979187012, acc1 is 0.634765625, acc5 is 2.587890625, cma_loss is 13.111400604248047, uma_loss is 0.4821237027645111
loss is 13.675230026245117, acc1 is 0.439453125, acc5 is 1.806640625, cma_loss is 13.204341888427734, uma_loss is 0.4708877503871918
loss is 13.61853313446045, acc1 is 0.87890625, acc5 is 2.392578125, cma_loss is 13.14586067199707, uma_loss is 0.47267234325408936
loss is 13.551615715026855, acc1 is 0.87890625, acc5 is 3.271484375, cma_loss is 13.077903747558594, uma_loss is 0.4737117886543274
loss is 13.595117568969727, acc1 is 0.87890625, acc5 is 3.02734375, cma_loss is 13.135334014892578, uma_loss is 0.4597839415073395
loss is 13.572299003601074, acc1 is 0.830078125, acc5 is 3.076171875, cma_loss is 13.126922607421875, uma_loss is 0.44537636637687683
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 149.31it/s]
15 epoch loss is 1.6888634908766973,                                    acc1 is 0.6760817307692307, acc5 is 2.666766826923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 177.71it/s]
-----------------------------------
The average AUROC is 62.2903
The AUROC of I313 is 70.67
The AUROC of I314 is 53.91
-----------------------------------
The average Sensitivity is 75.0000
The Sensitivity of I313 is 66.67
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 56.8376
The Specificity of I313 is 75.50
The Specificity of I314 is 38.17
-----------------------------------
The average Youden Index is 31.8376
The Youden Index of I313 is 42.17
The Youden Index of I314 is 21.51
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.10it/s]
 31%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                                             | 16/51 [05:57<12:22, 21.22s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 41.4988
The AUROC of I34 is 50.68
The AUROC of I35 is 41.77
The AUROC of I36 is 32.04
-----------------------------------
The average Sensitivity is 72.8864
The Sensitivity of I34 is 20.35
The Sensitivity of I35 is 98.31
The Sensitivity of I36 is 100.00
-----------------------------------
The average Specificity is 30.4422
The Specificity of I34 is 87.23
The Specificity of I35 is 3.08
The Specificity of I36 is 1.01
-----------------------------------
The average Youden Index is 3.3285
The Youden Index of I34 is 7.58
The Youden Index of I35 is 1.39
The Youden Index of I36 is 1.01
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.533980369567871, acc1 is 0.9765625, acc5 is 3.515625, cma_loss is 13.095584869384766, uma_loss is 0.4383954405784607
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.96s/it]
loss is 13.527166366577148, acc1 is 0.5859375, acc5 is 2.734375, cma_loss is 13.079700469970703, uma_loss is 0.4474661946296692
loss is 13.616927146911621, acc1 is 0.732421875, acc5 is 2.880859375, cma_loss is 13.157188415527344, uma_loss is 0.4597384035587311
loss is 13.58236026763916, acc1 is 0.634765625, acc5 is 3.076171875, cma_loss is 13.139163970947266, uma_loss is 0.4431963264942169
loss is 13.746655464172363, acc1 is 0.537109375, acc5 is 2.734375, cma_loss is 13.307596206665039, uma_loss is 0.43905895948410034
loss is 13.67250919342041, acc1 is 0.830078125, acc5 is 2.5390625, cma_loss is 13.246063232421875, uma_loss is 0.42644599080085754
loss is 13.707143783569336, acc1 is 0.537109375, acc5 is 2.24609375, cma_loss is 13.273944854736328, uma_loss is 0.4331988990306854
loss is 13.548582077026367, acc1 is 0.68359375, acc5 is 3.076171875, cma_loss is 13.105022430419922, uma_loss is 0.44355979561805725
loss is 13.702256202697754, acc1 is 0.732421875, acc5 is 2.197265625, cma_loss is 13.258380889892578, uma_loss is 0.44387537240982056
loss is 13.508188247680664, acc1 is 0.830078125, acc5 is 2.83203125, cma_loss is 13.051198959350586, uma_loss is 0.4569893181324005
loss is 13.545653343200684, acc1 is 1.123046875, acc5 is 3.173828125, cma_loss is 13.10612678527832, uma_loss is 0.43952617049217224
loss is 13.604368209838867, acc1 is 0.78125, acc5 is 2.9296875, cma_loss is 13.13945198059082, uma_loss is 0.46491649746894836
loss is 13.501769065856934, acc1 is 0.732421875, acc5 is 2.83203125, cma_loss is 13.061330795288086, uma_loss is 0.44043830037117004
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 109.63it/s]
16 epoch loss is 1.6837862832205637,                                    acc1 is 0.7474459134615384, acc5 is 2.8282752403846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 118.78it/s]
-----------------------------------
The average AUROC is 34.6294
The AUROC of I313 is 54.35
The AUROC of I314 is 14.91
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 55.56
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 40.4805
The Specificity of I313 is 74.17
The Specificity of I314 is 6.80
-----------------------------------
The average Youden Index is 18.2583
The Youden Index of I313 is 29.72
The Youden Index of I314 is 6.80
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.20it/s]
 33%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                                       | 17/51 [06:19<12:07, 21.38s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.0659
The AUROC of I34 is 50.77
The AUROC of I35 is 41.71
The AUROC of I36 is 36.71
-----------------------------------
The average Sensitivity is 94.2932
The Sensitivity of I34 is 86.73
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 9.8972
The Specificity of I34 is 21.38
The Specificity of I35 is 0.75
The Specificity of I36 is 7.56
-----------------------------------
The average Youden Index is 4.1904
The Youden Index of I34 is 8.10
The Youden Index of I35 is 0.75
The Youden Index of I36 is 3.72
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.522347450256348, acc1 is 0.78125, acc5 is 2.880859375, cma_loss is 13.085596084594727, uma_loss is 0.43675166368484497
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.99s/it]
loss is 13.511767387390137, acc1 is 0.634765625, acc5 is 2.880859375, cma_loss is 13.035770416259766, uma_loss is 0.4759971797466278
loss is 13.570569038391113, acc1 is 0.68359375, acc5 is 2.490234375, cma_loss is 13.119319915771484, uma_loss is 0.45124948024749756
loss is 13.413707733154297, acc1 is 0.87890625, acc5 is 3.662109375, cma_loss is 12.966211318969727, uma_loss is 0.447496235370636
loss is 13.474050521850586, acc1 is 1.07421875, acc5 is 2.880859375, cma_loss is 13.030950546264648, uma_loss is 0.4430999457836151
loss is 13.54928207397461, acc1 is 0.78125, acc5 is 3.173828125, cma_loss is 13.114503860473633, uma_loss is 0.43477845191955566
loss is 13.532219886779785, acc1 is 0.732421875, acc5 is 3.076171875, cma_loss is 13.086633682250977, uma_loss is 0.4455863833427429
loss is 13.494627952575684, acc1 is 0.78125, acc5 is 3.076171875, cma_loss is 13.048778533935547, uma_loss is 0.4458494186401367
loss is 13.536111831665039, acc1 is 0.68359375, acc5 is 3.125, cma_loss is 13.105268478393555, uma_loss is 0.43084317445755005
loss is 13.434683799743652, acc1 is 0.87890625, acc5 is 3.564453125, cma_loss is 12.986282348632812, uma_loss is 0.4484011232852936
loss is 13.431361198425293, acc1 is 0.87890625, acc5 is 3.61328125, cma_loss is 13.005796432495117, uma_loss is 0.4255647361278534
loss is 13.559161186218262, acc1 is 0.87890625, acc5 is 2.978515625, cma_loss is 13.110801696777344, uma_loss is 0.44835904240608215
loss is 13.449897766113281, acc1 is 0.830078125, acc5 is 2.9296875, cma_loss is 13.03982925415039, uma_loss is 0.4100683331489563
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 142.81it/s]
17 epoch loss is 1.671236074538458,                                    acc1 is 0.8075420673076923, acc5 is 3.1024639423076925
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 141.78it/s]
-----------------------------------
The average AUROC is 65.1455
The AUROC of I313 is 75.98
The AUROC of I314 is 54.31
-----------------------------------
The average Sensitivity is 77.7778
The Sensitivity of I313 is 88.89
The Sensitivity of I314 is 66.67
-----------------------------------
The average Specificity is 56.4876
The Specificity of I313 is 58.61
The Specificity of I314 is 54.36
-----------------------------------
The average Youden Index is 34.2654
The Youden Index of I313 is 47.50
The Youden Index of I314 is 21.03
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.74it/s]
 35%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                                 | 18/51 [06:40<11:38, 21.17s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.3228
The AUROC of I34 is 52.06
The AUROC of I35 is 42.69
The AUROC of I36 is 41.22
-----------------------------------
The average Sensitivity is 94.3998
The Sensitivity of I34 is 87.61
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 14.6288
The Specificity of I34 is 22.24
The Specificity of I35 is 1.73
The Specificity of I36 is 19.92
-----------------------------------
The average Youden Index is 9.0287
The Youden Index of I34 is 9.85
The Youden Index of I35 is 1.16
The Youden Index of I36 is 16.07
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.402012825012207, acc1 is 1.220703125, acc5 is 4.4921875, cma_loss is 12.977184295654297, uma_loss is 0.42482849955558777
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.29s/it]
loss is 13.433420181274414, acc1 is 0.927734375, acc5 is 3.759765625, cma_loss is 13.015302658081055, uma_loss is 0.41811782121658325
loss is 13.492015838623047, acc1 is 0.68359375, acc5 is 3.22265625, cma_loss is 13.061910629272461, uma_loss is 0.43010565638542175
loss is 13.395044326782227, acc1 is 0.5859375, acc5 is 3.173828125, cma_loss is 12.987005233764648, uma_loss is 0.40803948044776917
loss is 13.356553077697754, acc1 is 1.220703125, acc5 is 3.271484375, cma_loss is 12.945993423461914, uma_loss is 0.4105595648288727
loss is 13.481311798095703, acc1 is 0.732421875, acc5 is 3.41796875, cma_loss is 13.067206382751465, uma_loss is 0.41410574316978455
loss is 13.420957565307617, acc1 is 1.26953125, acc5 is 3.41796875, cma_loss is 13.016860961914062, uma_loss is 0.40409690141677856
loss is 13.397032737731934, acc1 is 0.927734375, acc5 is 3.515625, cma_loss is 12.98045539855957, uma_loss is 0.4165777862071991
loss is 13.436423301696777, acc1 is 0.9765625, acc5 is 2.83203125, cma_loss is 13.034721374511719, uma_loss is 0.40170222520828247
loss is 13.337442398071289, acc1 is 1.220703125, acc5 is 3.515625, cma_loss is 12.936725616455078, uma_loss is 0.4007165729999542
loss is 13.276313781738281, acc1 is 1.123046875, acc5 is 3.955078125, cma_loss is 12.884256362915039, uma_loss is 0.39205700159072876
loss is 13.437824249267578, acc1 is 0.87890625, acc5 is 4.345703125, cma_loss is 13.01961898803711, uma_loss is 0.41820481419563293
loss is 13.367133140563965, acc1 is 0.9765625, acc5 is 3.662109375, cma_loss is 12.966697692871094, uma_loss is 0.4004358649253845
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 89.40it/s]
18 epoch loss is 1.6593665259225028,                                    acc1 is 0.9803185096153846, acc5 is 3.583233173076923
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 168.78it/s]
-----------------------------------
The average AUROC is 35.3299
The AUROC of I313 is 49.74
The AUROC of I314 is 20.92
-----------------------------------
The average Sensitivity is 61.1111
The Sensitivity of I313 is 22.22
The Sensitivity of I314 is 100.00
-----------------------------------
The average Specificity is 52.5607
The Specificity of I313 is 95.73
The Specificity of I314 is 9.39
-----------------------------------
The average Youden Index is 13.6718
The Youden Index of I313 is 17.95
The Youden Index of I314 is 9.39
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.25it/s]
 37%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                          | 19/51 [07:02<11:30, 21.57s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 43.7316
The AUROC of I34 is 51.04
The AUROC of I35 is 42.02
The AUROC of I36 is 38.13
-----------------------------------
The average Sensitivity is 92.9249
The Sensitivity of I34 is 83.19
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 13.6850
The Specificity of I34 is 24.25
The Specificity of I35 is 1.28
The Specificity of I36 is 15.53
-----------------------------------
The average Youden Index is 6.6099
The Youden Index of I34 is 7.43
The Youden Index of I35 is 0.71
The Youden Index of I36 is 11.68
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.339483261108398, acc1 is 1.123046875, acc5 is 3.90625, cma_loss is 12.946949005126953, uma_loss is 0.39253419637680054
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.85s/it]
loss is 13.29439640045166, acc1 is 0.830078125, acc5 is 3.3203125, cma_loss is 12.894903182983398, uma_loss is 0.399493008852005
loss is 13.356821060180664, acc1 is 1.025390625, acc5 is 3.173828125, cma_loss is 12.947772979736328, uma_loss is 0.4090482294559479
loss is 13.226719856262207, acc1 is 1.07421875, acc5 is 4.248046875, cma_loss is 12.815972328186035, uma_loss is 0.41074731945991516
loss is 13.29469108581543, acc1 is 1.171875, acc5 is 4.931640625, cma_loss is 12.901076316833496, uma_loss is 0.39361438155174255
loss is 13.431659698486328, acc1 is 1.416015625, acc5 is 3.564453125, cma_loss is 13.031759262084961, uma_loss is 0.3999008536338806
loss is 13.384537696838379, acc1 is 0.9765625, acc5 is 3.515625, cma_loss is 12.998025894165039, uma_loss is 0.38651198148727417
loss is 13.340252876281738, acc1 is 1.123046875, acc5 is 3.564453125, cma_loss is 12.951292037963867, uma_loss is 0.3889603912830353
loss is 13.335159301757812, acc1 is 0.78125, acc5 is 3.564453125, cma_loss is 12.962512969970703, uma_loss is 0.3726460933685303
loss is 13.273488998413086, acc1 is 1.07421875, acc5 is 3.369140625, cma_loss is 12.887109756469727, uma_loss is 0.38637953996658325
loss is 13.28770923614502, acc1 is 1.025390625, acc5 is 3.41796875, cma_loss is 12.910114288330078, uma_loss is 0.37759512662887573
loss is 13.489970207214355, acc1 is 0.5859375, acc5 is 3.90625, cma_loss is 13.10153579711914, uma_loss is 0.3884342312812805
loss is 13.483209609985352, acc1 is 0.5859375, acc5 is 3.515625, cma_loss is 13.094032287597656, uma_loss is 0.3891770839691162
start validation
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 69.41it/s]
19 epoch loss is 1.6527438027518135,                                    acc1 is 0.9840745192307693, acc5 is 3.692157451923077
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 100.20it/s]
-----------------------------------
The average AUROC is 62.4995
The AUROC of I313 is 57.85
The AUROC of I314 is 67.14
-----------------------------------
The average Sensitivity is 63.8889
The Sensitivity of I313 is 44.44
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 74.3660
The Specificity of I313 is 82.24
The Specificity of I314 is 66.49
-----------------------------------
The average Youden Index is 38.2549
The Youden Index of I313 is 26.69
The Youden Index of I314 is 49.82
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.26it/s]
 39%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                                    | 20/51 [07:23<11:04, 21.43s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.2861
The AUROC of I34 is 51.85
The AUROC of I35 is 40.63
The AUROC of I36 is 43.38
-----------------------------------
The average Sensitivity is 94.1048
The Sensitivity of I34 is 86.73
The Sensitivity of I35 is 99.44
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 14.5346
The Specificity of I34 is 22.31
The Specificity of I35 is 0.90
The Specificity of I36 is 20.39
-----------------------------------
The average Youden Index is 8.6394
The Youden Index of I34 is 9.04
The Youden Index of I35 is 0.34
The Youden Index of I36 is 16.55
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.274611473083496, acc1 is 0.9765625, acc5 is 3.515625, cma_loss is 12.906084060668945, uma_loss is 0.3685275912284851
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.91s/it]
loss is 13.362853050231934, acc1 is 1.025390625, acc5 is 3.857421875, cma_loss is 12.985057830810547, uma_loss is 0.37779518961906433
loss is 13.30256175994873, acc1 is 1.171875, acc5 is 4.1015625, cma_loss is 12.912471771240234, uma_loss is 0.3900901675224304
loss is 13.248581886291504, acc1 is 0.830078125, acc5 is 4.4921875, cma_loss is 12.85046100616455, uma_loss is 0.3981204628944397
loss is 13.349647521972656, acc1 is 1.171875, acc5 is 4.19921875, cma_loss is 12.958112716674805, uma_loss is 0.39153504371643066
loss is 13.35730266571045, acc1 is 0.927734375, acc5 is 3.61328125, cma_loss is 12.964459419250488, uma_loss is 0.39284321665763855
loss is 13.313546180725098, acc1 is 0.9765625, acc5 is 3.515625, cma_loss is 12.924295425415039, uma_loss is 0.3892504572868347
loss is 13.310574531555176, acc1 is 0.9765625, acc5 is 3.955078125, cma_loss is 12.909564971923828, uma_loss is 0.40100979804992676
loss is 13.335084915161133, acc1 is 1.318359375, acc5 is 3.80859375, cma_loss is 12.936470031738281, uma_loss is 0.39861467480659485
loss is 13.174468040466309, acc1 is 1.171875, acc5 is 4.638671875, cma_loss is 12.770401000976562, uma_loss is 0.4040672481060028
loss is 13.111098289489746, acc1 is 1.220703125, acc5 is 4.19921875, cma_loss is 12.71554946899414, uma_loss is 0.39554837346076965
loss is 13.24712085723877, acc1 is 1.318359375, acc5 is 4.638671875, cma_loss is 12.866399765014648, uma_loss is 0.38072139024734497
loss is 13.284293174743652, acc1 is 1.46484375, acc5 is 4.19921875, cma_loss is 12.888167381286621, uma_loss is 0.3961259722709656
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 140.83it/s]
20 epoch loss is 1.6444928033011301,                                    acc1 is 1.1192908653846154, acc5 is 4.056490384615385
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 161.68it/s]
-----------------------------------
The average AUROC is 52.1904
The AUROC of I313 is 47.44
The AUROC of I314 is 56.94
-----------------------------------
The average Sensitivity is 41.6667
The Sensitivity of I313 is 33.33
The Sensitivity of I314 is 50.00
-----------------------------------
The average Specificity is 83.4676
The Specificity of I313 is 89.92
The Specificity of I314 is 77.02
-----------------------------------
The average Youden Index is 25.1343
The Youden Index of I313 is 23.25
The Youden Index of I314 is 27.02
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.66it/s]
 41%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                              | 21/51 [07:45<10:48, 21.62s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 45.6031
The AUROC of I34 is 51.66
The AUROC of I35 is 40.51
The AUROC of I36 is 44.63
-----------------------------------
The average Sensitivity is 70.0227
The Sensitivity of I34 is 15.04
The Sensitivity of I35 is 98.87
The Sensitivity of I36 is 96.15
-----------------------------------
The average Specificity is 38.7608
The Specificity of I34 is 92.83
The Specificity of I35 is 1.58
The Specificity of I36 is 21.88
-----------------------------------
The average Youden Index is 8.7835
The Youden Index of I34 is 7.87
The Youden Index of I35 is 0.45
The Youden Index of I36 is 18.03
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.203489303588867, acc1 is 1.318359375, acc5 is 4.6875, cma_loss is 12.833309173583984, uma_loss is 0.3701798617839813
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.97s/it]
loss is 13.283832550048828, acc1 is 0.927734375, acc5 is 4.296875, cma_loss is 12.90300178527832, uma_loss is 0.3808308243751526
loss is 13.260660171508789, acc1 is 1.318359375, acc5 is 5.224609375, cma_loss is 12.876346588134766, uma_loss is 0.3843134641647339
loss is 13.203818321228027, acc1 is 1.26953125, acc5 is 4.833984375, cma_loss is 12.805900573730469, uma_loss is 0.3979179561138153
loss is 13.20319652557373, acc1 is 1.26953125, acc5 is 4.4921875, cma_loss is 12.823720932006836, uma_loss is 0.3794752359390259
loss is 13.286791801452637, acc1 is 1.5625, acc5 is 4.150390625, cma_loss is 12.91743278503418, uma_loss is 0.3693588078022003
loss is 13.36008358001709, acc1 is 1.171875, acc5 is 4.443359375, cma_loss is 12.998472213745117, uma_loss is 0.3616116940975189
loss is 13.26881217956543, acc1 is 0.87890625, acc5 is 3.759765625, cma_loss is 12.88198184967041, uma_loss is 0.38683047890663147
loss is 13.207979202270508, acc1 is 1.26953125, acc5 is 4.736328125, cma_loss is 12.853019714355469, uma_loss is 0.3549592196941376
loss is 13.191305160522461, acc1 is 1.7578125, acc5 is 4.58984375, cma_loss is 12.805967330932617, uma_loss is 0.38533735275268555
loss is 13.018800735473633, acc1 is 1.5625, acc5 is 5.078125, cma_loss is 12.63504695892334, uma_loss is 0.3837536573410034
loss is 13.284167289733887, acc1 is 1.416015625, acc5 is 4.248046875, cma_loss is 12.899767875671387, uma_loss is 0.3843996226787567
loss is 13.202865600585938, acc1 is 1.171875, acc5 is 4.638671875, cma_loss is 12.819141387939453, uma_loss is 0.3837244212627411
start validation
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 118.60it/s]
21 epoch loss is 1.6378647849673316,                                    acc1 is 1.2995793269230769, acc5 is 4.552283653846154
***********************************
zeroshot classification set is I313_I314
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 80.21it/s]
-----------------------------------
The average AUROC is 70.3209
The AUROC of I313 is 84.45
The AUROC of I314 is 56.20
-----------------------------------
The average Sensitivity is 80.5556
The Sensitivity of I313 is 77.78
The Sensitivity of I314 is 83.33
-----------------------------------
The average Specificity is 63.9445
The Specificity of I313 is 87.12
The Specificity of I314 is 40.77
-----------------------------------
The average Youden Index is 44.5000
The Youden Index of I313 is 64.89
The Youden Index of I314 is 24.11
***********************************
***********************************
zeroshot classification set is I_num_2
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.64it/s]
 43%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                       | 22/51 [08:06<10:17, 21.30s/it]/data1/1shared/lijun/ecg/ECG-EchoReport/pretrain/../utils/utils_trainer.py:117: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
-----------------------------------
The average AUROC is 48.1910
The AUROC of I34 is 52.37
The AUROC of I35 is 41.04
The AUROC of I36 is 51.16
-----------------------------------
The average Sensitivity is 91.2412
The Sensitivity of I34 is 81.42
The Sensitivity of I35 is 100.00
The Sensitivity of I36 is 92.31
-----------------------------------
The average Specificity is 17.4582
The Specificity of I34 is 27.83
The Specificity of I35 is 0.30
The Specificity of I36 is 24.24
-----------------------------------
The average Youden Index is 8.6994
The Youden Index of I34 is 9.25
The Youden Index of I35 is 0.30
The Youden Index of I36 is 16.55
***********************************
  with autocast():                                                                                                                                                                                                                                                                                                                               | 0/13 [00:00<?, ?it/s]
loss is 13.163804054260254, acc1 is 1.5625, acc5 is 4.78515625, cma_loss is 12.786962509155273, uma_loss is 0.3768419325351715

 38%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                                                       | 5/13 [00:02<00:03,  2.30it/s]
loss is 13.251822471618652, acc1 is 1.123046875, acc5 is 4.541015625, cma_loss is 12.856942176818848, uma_loss is 0.39488014578819275
loss is 13.177481651306152, acc1 is 1.708984375, acc5 is 4.8828125, cma_loss is 12.7939453125, uma_loss is 0.38353633880615234
loss is 13.14148998260498, acc1 is 1.26953125, acc5 is 5.029296875, cma_loss is 12.75682258605957, uma_loss is 0.38466739654541016
loss is 13.050193786621094, acc1 is 1.3671875, acc5 is 5.2734375, cma_loss is 12.67208480834961, uma_loss is 0.3781093955039978
